{"ast":null,"code":"import _classCallCheck from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/inherits\";/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */import React from'react';import withStyles from'@material-ui/core/styles/withStyles';import Slider from'@material-ui/lab/Slider';import{PLAYER_PROGRESS_TIMEOUT_MS}from'../../../Constants';import PlayerStore from'../../../Stores/PlayerStore';import'./VoiceNoteSlider.css';var styles={slider:{maxWidth:216},track:{transition:'width 0ms linear 0ms, height 0ms linear 0ms, transform 0ms linear 0ms'},thumbWrapper:{transition:'transform 0ms linear 0ms'},thumb:{transition:'transform 0ms linear 0ms, box-shadow 0ms linear 0ms'}};var VoiceNoteSlider=/*#__PURE__*/function(_React$Component){_inherits(VoiceNoteSlider,_React$Component);function VoiceNoteSlider(props){var _this;_classCallCheck(this,VoiceNoteSlider);_this=_possibleConstructorReturn(this,_getPrototypeOf(VoiceNoteSlider).call(this,props));_this.reset=function(){var duration=_this.props.duration;var value=_this.state.value;if(value===1){_this.setState({active:false,currentTime:0});setTimeout(function(){var currentTime=_this.state.currentTime;if(!currentTime){_this.setState({value:_this.getValue(0,duration,false)});}},PLAYER_PROGRESS_TIMEOUT_MS);}else{_this.setState({active:false,currentTime:0,value:_this.getValue(0,duration,false)});}};_this.onClientUpdateMediaEnd=function(update){var _this$props=_this.props,chatId=_this$props.chatId,messageId=_this$props.messageId;if(chatId===update.chatId&&messageId===update.messageId){_this.reset();}};_this.onClientUpdateMediaTime=function(update){var _this$props2=_this.props,chatId=_this$props2.chatId,messageId=_this$props2.messageId,duration=_this$props2.duration;var active=_this.state.active;if(chatId===update.chatId&&messageId===update.messageId){_this.setState({currentTime:update.currentTime,duration:update.duration||duration,value:_this.getValue(update.currentTime,update.duration||duration,active)});}};_this.onClientUpdateMediaActive=function(update){var _this$props3=_this.props,chatId=_this$props3.chatId,messageId=_this$props3.messageId,duration=_this$props3.duration;var _this$state=_this.state,active=_this$state.active,currentTime=_this$state.currentTime;if(chatId===update.chatId&&messageId===update.messageId){_this.setState({active:true,currentTime:active?currentTime:0,value:_this.getValue(active?currentTime:0,duration,true)});}else if(active){_this.reset();}};_this.getValue=function(currentTime,duration,active){return active?currentTime/duration:0;};var message=PlayerStore.message,time=PlayerStore.time;var _this$props4=_this.props,_chatId=_this$props4.chatId,_messageId=_this$props4.messageId,_duration=_this$props4.duration;var _active=message&&message.chat_id===_chatId&&message.id===_messageId;var _currentTime=_active&&time?time.currentTime:0;var audioDuration=_active&&time&&time.duration?time.duration:_duration;_this.state={active:_active,currentTime:_currentTime,duration:audioDuration,value:_this.getValue(_currentTime,audioDuration,_active)};return _this;}_createClass(VoiceNoteSlider,[{key:\"shouldComponentUpdate\",value:function shouldComponentUpdate(nextProps,nextState){var _this$state2=this.state,active=_this$state2.active,value=_this$state2.value;if(nextState.value!==value){return true;}if(nextState.active!==active){return true;}return false;}},{key:\"componentDidMount\",value:function componentDidMount(){PlayerStore.on('clientUpdateMediaActive',this.onClientUpdateMediaActive);PlayerStore.on('clientUpdateMediaTime',this.onClientUpdateMediaTime);PlayerStore.on('clientUpdateMediaEnd',this.onClientUpdateMediaEnd);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){PlayerStore.removeListener('clientUpdateMediaActive',this.onClientUpdateMediaActive);PlayerStore.removeListener('clientUpdateMediaTime',this.onClientUpdateMediaTime);PlayerStore.removeListener('clientUpdateMediaEnd',this.onClientUpdateMediaEnd);}},{key:\"render\",value:function render(){var classes=this.props.classes;var value=this.state.value;return React.createElement(\"div\",{className:\"voice-note-slider\"},React.createElement(Slider,{className:classes.slider,classes:{track:classes.track,thumbWrapper:classes.thumbWrapper,thumb:classes.thumb},min:0,max:1,value:value}));}}]);return VoiceNoteSlider;}(React.Component);export default withStyles(styles)(VoiceNoteSlider);","map":{"version":3,"sources":["/Users/yosuahalim/Documents/Projects/telegram-app/src/Components/Message/Media/VoiceNoteSlider.js"],"names":["React","withStyles","Slider","PLAYER_PROGRESS_TIMEOUT_MS","PlayerStore","styles","slider","maxWidth","track","transition","thumbWrapper","thumb","VoiceNoteSlider","props","reset","duration","value","state","setState","active","currentTime","setTimeout","getValue","onClientUpdateMediaEnd","update","chatId","messageId","onClientUpdateMediaTime","onClientUpdateMediaActive","message","time","chat_id","id","audioDuration","nextProps","nextState","on","removeListener","classes","Component"],"mappings":"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","sourcesContent":["/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport withStyles from '@material-ui/core/styles/withStyles';\nimport Slider from '@material-ui/lab/Slider';\nimport { PLAYER_PROGRESS_TIMEOUT_MS } from '../../../Constants';\nimport PlayerStore from '../../../Stores/PlayerStore';\nimport './VoiceNoteSlider.css';\n\nconst styles = {\n    slider: {\n        maxWidth: 216\n    },\n    track: {\n        transition: 'width 0ms linear 0ms, height 0ms linear 0ms, transform 0ms linear 0ms'\n    },\n    thumbWrapper: {\n        transition: 'transform 0ms linear 0ms'\n    },\n    thumb: {\n        transition: 'transform 0ms linear 0ms, box-shadow 0ms linear 0ms'\n    }\n};\n\nclass VoiceNoteSlider extends React.Component {\n    constructor(props) {\n        super(props);\n\n        const { message, time } = PlayerStore;\n        const { chatId, messageId, duration } = this.props;\n\n        const active = message && message.chat_id === chatId && message.id === messageId;\n        const currentTime = active && time ? time.currentTime : 0;\n        const audioDuration = active && time && time.duration ? time.duration : duration;\n\n        this.state = {\n            active: active,\n            currentTime: currentTime,\n            duration: audioDuration,\n            value: this.getValue(currentTime, audioDuration, active)\n        };\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        const { active, value } = this.state;\n\n        if (nextState.value !== value) {\n            return true;\n        }\n\n        if (nextState.active !== active) {\n            return true;\n        }\n\n        return false;\n    }\n\n    componentDidMount() {\n        PlayerStore.on('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.on('clientUpdateMediaTime', this.onClientUpdateMediaTime);\n        PlayerStore.on('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n    }\n\n    componentWillUnmount() {\n        PlayerStore.removeListener('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.removeListener('clientUpdateMediaTime', this.onClientUpdateMediaTime);\n        PlayerStore.removeListener('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n    }\n\n    reset = () => {\n        const { duration } = this.props;\n        const { value } = this.state;\n\n        if (value === 1) {\n            this.setState({\n                active: false,\n                currentTime: 0\n            });\n\n            setTimeout(() => {\n                const { currentTime } = this.state;\n                if (!currentTime) {\n                    this.setState({\n                        value: this.getValue(0, duration, false)\n                    });\n                }\n            }, PLAYER_PROGRESS_TIMEOUT_MS);\n        } else {\n            this.setState({\n                active: false,\n                currentTime: 0,\n                value: this.getValue(0, duration, false)\n            });\n        }\n    };\n\n    onClientUpdateMediaEnd = update => {\n        const { chatId, messageId } = this.props;\n\n        if (chatId === update.chatId && messageId === update.messageId) {\n            this.reset();\n        }\n    };\n\n    onClientUpdateMediaTime = update => {\n        const { chatId, messageId, duration } = this.props;\n        const { active } = this.state;\n\n        if (chatId === update.chatId && messageId === update.messageId) {\n            this.setState({\n                currentTime: update.currentTime,\n                duration: update.duration || duration,\n                value: this.getValue(update.currentTime, update.duration || duration, active)\n            });\n        }\n    };\n\n    onClientUpdateMediaActive = update => {\n        const { chatId, messageId, duration } = this.props;\n        const { active, currentTime } = this.state;\n\n        if (chatId === update.chatId && messageId === update.messageId) {\n            this.setState({\n                active: true,\n                currentTime: active ? currentTime : 0,\n                value: this.getValue(active ? currentTime : 0, duration, true)\n            });\n        } else if (active) {\n            this.reset();\n        }\n    };\n\n    getValue = (currentTime, duration, active) => {\n        return active ? currentTime / duration : 0;\n    };\n\n    render() {\n        const { classes } = this.props;\n        const { value } = this.state;\n\n        return (\n            <div className='voice-note-slider'>\n                <Slider\n                    className={classes.slider}\n                    classes={{\n                        track: classes.track,\n                        thumbWrapper: classes.thumbWrapper,\n                        thumb: classes.thumb\n                    }}\n                    min={0}\n                    max={1}\n                    value={value}\n                />\n            </div>\n        );\n    }\n}\n\nVoiceNoteSlider.propTypes = {\n    chatId: PropTypes.number.isRequired,\n    messageId: PropTypes.number.isRequired,\n    duration: PropTypes.number.isRequired\n};\n\nexport default withStyles(styles)(VoiceNoteSlider);\n"]},"metadata":{},"sourceType":"module"}