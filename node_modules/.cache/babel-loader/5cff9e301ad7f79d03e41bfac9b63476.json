{"ast":null,"code":"import _regeneratorRuntime from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */import{getPhotoSize,getPhotoThumbnailSize,getSize}from'./Common';import{getChatUserId}from'./Chat';import{getProfilePhoto}from'./User';import{getLocationId}from'./Message';import{FILE_PRIORITY,IV_LOCATION_HEIGHT,IV_LOCATION_WIDTH,IV_PHOTO_SIZE,LOCATION_HEIGHT,LOCATION_SCALE,LOCATION_WIDTH,LOCATION_ZOOM,PHOTO_BIG_SIZE,PHOTO_SIZE,PRELOAD_ANIMATION_SIZE,PRELOAD_AUDIO_SIZE,PRELOAD_DOCUMENT_SIZE,PRELOAD_STICKER_SIZE,PRELOAD_VIDEO_SIZE,PRELOAD_VIDEONOTE_SIZE,PRELOAD_VOICENOTE_SIZE,THUMBNAIL_PRIORITY}from'../Constants';import ChatStore from'../Stores/ChatStore';import FileStore from'../Stores/FileStore';import MessageStore from'../Stores/MessageStore';import UserStore from'../Stores/UserStore';import TdLibController from'../Controllers/TdLibController';function getSizeString(size){if(!size)return\"0 B\";if(size<1024){return\"\".concat(size,\" B\");}if(size<1024*1024){return\"\".concat((size/1024).toFixed(1),\" KB\");}if(size<1024*1024*1024){return\"\".concat((size/1024/1024).toFixed(1),\" MB\");}return\"\".concat((size/1024/1024/1024).toFixed(1),\" GB\");}function getFileSize(file){if(!file)return null;var size=file.size;if(!size)return null;return getSizeString(size);}function getBigPhoto(photo){if(!photo)return null;return photo.big;}function saveData(data,filename,mime){var blob=new Blob([data],{type:mime||'application/octet-stream'});if(typeof window.navigator.msSaveBlob!=='undefined'){// IE workaround for \"HTML7007: One or more blob URLs were\n// revoked by closing the blob for which they were created.\n// These URLs will no longer resolve as the data backing\n// the URL has been freed.\"\nwindow.navigator.msSaveBlob(blob,filename);}else{var blobURL=window.URL.createObjectURL(blob);var tempLink=document.createElement('a');tempLink.style.display='none';tempLink.href=blobURL;tempLink.setAttribute('download',filename);// Safari thinks _blank anchor are pop ups. We only want to set _blank\n// target if the browser does not support the HTML5 download attribute.\n// This allows you to download files in desktop safari if pop up blocking\n// is enabled.\nif(typeof tempLink.download==='undefined'){tempLink.setAttribute('target','_blank');}document.body.appendChild(tempLink);tempLink.click();document.body.removeChild(tempLink);window.URL.revokeObjectURL(blobURL);}}function saveBlob(blob,filename){if(typeof window.navigator.msSaveBlob!=='undefined'){// IE workaround for \"HTML7007: One or more blob URLs were\n// revoked by closing the blob for which they were created.\n// These URLs will no longer resolve as the data backing\n// the URL has been freed.\"\nwindow.navigator.msSaveBlob(blob,filename);}else{var blobURL=window.URL.createObjectURL(blob);var tempLink=document.createElement('a');tempLink.style.display='none';tempLink.href=blobURL;tempLink.setAttribute('download',filename);// Safari thinks _blank anchor are pop ups. We only want to set _blank\n// target if the browser does not support the HTML5 download attribute.\n// This allows you to download files in desktop safari if pop up blocking\n// is enabled.\nif(typeof tempLink.download==='undefined'){tempLink.setAttribute('target','_blank');}document.body.appendChild(tempLink);tempLink.click();document.body.removeChild(tempLink);window.URL.revokeObjectURL(blobURL);}}function loadReplies(_x,_x2,_x3){return _loadReplies.apply(this,arguments);}function _loadReplies(){_loadReplies=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(store,chatId,messageIds){var result,i;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(chatId){_context.next=2;break;}return _context.abrupt(\"return\");case 2:if(messageIds){_context.next=4;break;}return _context.abrupt(\"return\");case 4:if(messageIds.length){_context.next=6;break;}return _context.abrupt(\"return\");case 6:_context.next=8;return TdLibController.send({'@type':'getMessages',chat_id:chatId,message_ids:messageIds});case 8:result=_context.sent;result.messages=result.messages.map(function(message,i){return message||{'@type':'deletedMessage',chat_id:chatId,id:messageIds[i],content:null};});MessageStore.setItems(result.messages);for(i=messageIds.length-1;i>=0;i--){MessageStore.emit('getMessageResult',MessageStore.get(chatId,messageIds[i]));}store=FileStore.getStore();loadReplyContents(store,result.messages);case 14:case\"end\":return _context.stop();}}},_callee);}));return _loadReplies.apply(this,arguments);}function loadReplyContents(store,messages){for(var i=messages.length-1;i>=0;i--){var message=messages[i];if(!message){continue;}var content=message.content;if(content){switch(content['@type']){case'messageAnimation':{var animation=content.animation;loadAnimationThumbnailContent(store,animation,message);break;}case'messageAudio':{var audio=content.audio;loadAudioThumbnailContent(store,audio,message);break;}case'messageChatChangePhoto':{var photo=content.photo;loadPhotoContent(store,photo,message);break;}case'messageDocument':{var _document=content.document;loadDocumentThumbnailContent(store,_document,message);break;}case'messageGame':{var game=content.game;loadGameThumbnailContent(store,game,message);break;}case'messagePhoto':{var _photo=content.photo;loadPhotoContent(store,_photo,message);break;}case'messageSticker':{var sticker=content.sticker;loadStickerThumbnailContent(store,sticker,message);break;}case'messageText':{var web_page=content.web_page;if(!web_page)break;var _animation=web_page.animation,_audio=web_page.audio,_document2=web_page.document,_photo2=web_page.photo,_sticker=web_page.sticker,video=web_page.video,video_note=web_page.video_note;if(_photo2){loadPhotoContent(store,_photo2,message);break;}if(_animation){loadAnimationThumbnailContent(store,_animation,message);break;}if(_audio){loadAudioThumbnailContent(store,_audio,message);break;}if(_document2){loadDocumentThumbnailContent(store,_document2,message);break;}if(_sticker){loadStickerThumbnailContent(store,_sticker,message);break;}if(video){loadVideoThumbnailContent(store,video,message);break;}if(video_note){loadVideoNoteThumbnailContent(store,video_note,message);break;}break;}case'messageVideo':{var _video=content.video;loadVideoThumbnailContent(store,_video,message);break;}case'messageVideoNote':{var _video_note=content.video_note;loadVideoNoteThumbnailContent(store,_video_note,message);break;}}}}}function loadAudioContent(store,audio,message){var useFileSize=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;if(!audio)return;var file=audio.audio;if(!file)return;file=FileStore.get(file.id)||file;var _file=file,id=_file.id,size=_file.size;var blob=FileStore.getBlob(id);if(blob)return;var chatId=message?message.chat_id:0;var messageId=message?message.id:0;FileStore.getLocalFile(store,file,null,function(){return FileStore.updateAudioBlob(chatId,messageId,id);},function(){if(!useFileSize||size&&size<PRELOAD_AUDIO_SIZE){FileStore.getRemoteFile(id,FILE_PRIORITY,message||audio);}});}function loadAudioThumbnailContent(store,audio,message){if(!audio)return false;var photoSize=audio.album_cover_thumbnail;if(!photoSize)return false;var file=photoSize.photo;if(!file)return false;file=FileStore.get(file.id)||file;var _file2=file,id=_file2.id;var blob=FileStore.getBlob(file.id);if(blob)return true;var chatId=message?message.chat_id:0;var messageId=message?message.id:0;FileStore.getLocalFile(store,file,null,function(){return FileStore.updateAudioThumbnailBlob(chatId,messageId,id);},function(){return FileStore.getRemoteFile(id,THUMBNAIL_PRIORITY,message||audio);});return true;}function loadAnimationContent(store,animation,message){var useFileSize=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;if(!animation)return;var file=animation.animation;if(!file)return;file=FileStore.get(file.id)||file;var _file3=file,id=_file3.id,size=_file3.size;var blob=FileStore.getBlob(id);if(blob)return;var chatId=message?message.chat_id:0;var messageId=message?message.id:0;FileStore.getLocalFile(store,file,null,function(){return FileStore.updateAnimationBlob(chatId,messageId,id);},function(){if(!useFileSize||size&&size<PRELOAD_ANIMATION_SIZE){FileStore.getRemoteFile(id,FILE_PRIORITY,message||animation);}});}function loadAnimationThumbnailContent(store,animation,message){if(!animation)return false;var photoSize=animation.thumbnail;if(!photoSize)return false;var file=photoSize.photo;if(!file)return false;file=FileStore.get(file.id)||file;var _file4=file,id=_file4.id;var blob=FileStore.getBlob(file.id);if(blob)return true;var chatId=message?message.chat_id:0;var messageId=message?message.id:0;FileStore.getLocalFile(store,file,null,function(){return FileStore.updateAnimationThumbnailBlob(chatId,messageId,id);},function(){return FileStore.getRemoteFile(id,THUMBNAIL_PRIORITY,message||animation);});return true;}function loadContactContent(store,contact,message){if(!contact)return;if(!message)return;var user_id=contact.user_id;var user=UserStore.get(user_id);if(!user)return;loadUserContent(store,user);}function loadDocumentContent(store,document,message){var useFileSize=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;if(!document)return;var file=document.document;if(!file)return;file=FileStore.get(file.id)||file;var _file5=file,id=_file5.id,size=_file5.size;var blob=FileStore.getBlob(id);if(blob)return;var chatId=message?message.chat_id:0;var messageId=message?message.id:0;FileStore.getLocalFile(store,file,null,function(){return FileStore.updateDocumentBlob(chatId,messageId,id);},function(){if(!useFileSize||size&&size<PRELOAD_DOCUMENT_SIZE){FileStore.getRemoteFile(id,FILE_PRIORITY,message||document);}});}function loadDocumentThumbnailContent(store,document,message){if(!document)return false;var photoSize=document.thumbnail;if(!photoSize)return false;var file=photoSize.photo;if(!file)return false;file=FileStore.get(file.id)||file;var _file6=file,id=_file6.id;var blob=FileStore.getBlob(file.id);if(blob)return true;var chatId=message?message.chat_id:0;var messageId=message?message.id:0;FileStore.getLocalFile(store,file,null,function(){return FileStore.updateDocumentThumbnailBlob(chatId,messageId,id);},function(){return FileStore.getRemoteFile(id,THUMBNAIL_PRIORITY,message||document);});return true;}function loadGameContent(store,game,message){var useFileSize=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;if(!game)return;var animation=game.animation;loadAnimationContent(store,animation,message,useFileSize);}function loadGameThumbnailContent(store,game,message){if(!game)return false;var photo=game.photo,animation=game.animation;if(loadAnimationThumbnailContent(store,animation,message)){return true;}loadPhotoContent(store,photo,message);return true;}function loadPageBlockMapContent(_x4,_x5,_x6){return _loadPageBlockMapContent.apply(this,arguments);}function _loadPageBlockMapContent(){_loadPageBlockMapContent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(store,pageBlockMap,message){var location,locationId,file,_file23,id,blob,chatId,messageId;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(pageBlockMap){_context2.next=2;break;}return _context2.abrupt(\"return\");case 2:location=pageBlockMap.location;locationId=getLocationId(location,IV_LOCATION_WIDTH,IV_LOCATION_HEIGHT);if(locationId){_context2.next=6;break;}return _context2.abrupt(\"return\");case 6:file=FileStore.getLocationFile(locationId);if(file){_context2.next=13;break;}_context2.next=10;return TdLibController.send({'@type':'getMapThumbnailFile',location:location,width:IV_LOCATION_WIDTH,height:IV_LOCATION_HEIGHT,zoom:LOCATION_ZOOM,scale:LOCATION_SCALE,chat_id:message?message.chat_id:0});case 10:file=_context2.sent;FileStore.setLocationFile(locationId,file);store=FileStore.getStore();case 13:file=FileStore.get(file.id)||file;_file23=file,id=_file23.id;blob=FileStore.getBlob(file.id);if(!blob){_context2.next=18;break;}return _context2.abrupt(\"return\");case 18:chatId=message?message.chat_id:0;messageId=message?message.id:0;FileStore.getLocalFile(store,file,null,function(){return FileStore.updateLocationBlob(chatId,messageId,id);},function(){return FileStore.getRemoteFile(id,FILE_PRIORITY,message||pageBlockMap);});case 21:case\"end\":return _context2.stop();}}},_callee2);}));return _loadPageBlockMapContent.apply(this,arguments);}function loadLocationContent(_x7,_x8,_x9){return _loadLocationContent.apply(this,arguments);}function _loadLocationContent(){_loadLocationContent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(store,location,message){var locationId,file,_file24,id,blob,chatId,messageId;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(location){_context3.next=2;break;}return _context3.abrupt(\"return\");case 2:locationId=getLocationId(location);if(locationId){_context3.next=5;break;}return _context3.abrupt(\"return\");case 5:file=FileStore.getLocationFile(locationId);if(file){_context3.next=12;break;}_context3.next=9;return TdLibController.send({'@type':'getMapThumbnailFile',location:location,width:LOCATION_WIDTH,height:LOCATION_HEIGHT,zoom:LOCATION_ZOOM,scale:LOCATION_SCALE,chat_id:message?message.chat_id:0});case 9:file=_context3.sent;FileStore.setLocationFile(locationId,file);store=FileStore.getStore();case 12:file=FileStore.get(file.id)||file;_file24=file,id=_file24.id;blob=FileStore.getBlob(file.id);if(!blob){_context3.next=17;break;}return _context3.abrupt(\"return\");case 17:chatId=message?message.chat_id:0;messageId=message?message.id:0;FileStore.getLocalFile(store,file,null,function(){return FileStore.updateLocationBlob(chatId,messageId,id);},function(){return FileStore.getRemoteFile(id,FILE_PRIORITY,message||location);});case 20:case\"end\":return _context3.stop();}}},_callee3);}));return _loadLocationContent.apply(this,arguments);}function loadBigPhotoContent(store,photo,message){if(!photo)return;var sizes=photo.sizes;if(!sizes)return;var photoSize=getSize(sizes,PHOTO_BIG_SIZE);if(!photoSize)return;var file=photoSize.photo;if(!file)return;file=FileStore.get(file.id)||file;var _file7=file,id=_file7.id;var blob=FileStore.getBlob(id);if(blob)return;var chatId=message?message.chat_id:0;var messageId=message?message.id:0;FileStore.getLocalFile(store,file,null,function(){return FileStore.updatePhotoBlob(chatId,messageId,id);},function(){return FileStore.getRemoteFile(id,FILE_PRIORITY,message||photo);});}function loadPhotoContent(store,photo,message){var displaySize=arguments.length>3&&arguments[3]!==undefined?arguments[3]:PHOTO_SIZE;if(!photo)return;var sizes=photo.sizes;if(!sizes)return;var photoSize=getPhotoSize(sizes,displaySize);if(!photoSize)return;var file=photoSize.photo;if(!file)return;file=FileStore.get(file.id)||file;var _file8=file,id=_file8.id;var blob=FileStore.getBlob(id);if(blob)return;var chatId=message?message.chat_id:0;var messageId=message?message.id:0;FileStore.getLocalFile(store,file,null,function(){return FileStore.updatePhotoBlob(chatId,messageId,id);},function(){return FileStore.getRemoteFile(id,FILE_PRIORITY,message||photo);});}function loadPhotoThumbnailContent(store,photo,message){if(!photo)return false;if(!message)return false;var photoSize=getPhotoThumbnailSize(photo.sizes);if(!photoSize)return false;var file=photoSize.photo;if(!file)return false;file=FileStore.get(file.id)||file;var _file9=file,id=_file9.id;var blob=FileStore.getBlob(id);if(blob)return true;FileStore.getLocalFile(store,file,null,function(){return FileStore.updatePhotoBlob(message.chat_id,message.id,id);},function(){return FileStore.getRemoteFile(id,THUMBNAIL_PRIORITY,message);});return true;}function loadStickerContent(store,sticker,message){var useFileSize=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;if(!sticker)return;var file=sticker.sticker;if(!file)return;file=FileStore.get(file.id)||file;var _file10=file,id=_file10.id,size=_file10.size;var blob=FileStore.getBlob(id);if(blob)return;var chatId=message?message.chat_id:0;var messageId=message?message.id:0;FileStore.getLocalFile(store,file,null,function(){return FileStore.updateStickerBlob(chatId,messageId,id);},function(){if(!useFileSize||size&&size<PRELOAD_STICKER_SIZE){FileStore.getRemoteFile(id,FILE_PRIORITY,message||sticker);}});}function loadStickerThumbnailContent(store,sticker,message){if(!sticker)return false;var photoSize=sticker.thumbnail;if(!photoSize)return false;var file=photoSize.photo;if(!file)return false;file=FileStore.get(file.id)||file;var _file11=file,id=_file11.id;var blob=FileStore.getBlob(id);if(blob)return true;var chatId=message?message.chat_id:0;var messageId=message?message.id:0;FileStore.getLocalFile(store,file,null,function(){return FileStore.updateStickerThumbnailBlob(chatId,messageId,id);},function(){return FileStore.getRemoteFile(id,THUMBNAIL_PRIORITY,message||sticker);});return true;}function loadVideoContent(store,video,message){var useFileSize=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;if(!video)return;var file=video.video;if(!file)return;file=FileStore.get(file.id)||file;var _file12=file,id=_file12.id,size=_file12.size;var blob=FileStore.getBlob(id);if(blob)return;var chatId=message?message.chat_id:0;var messageId=message?message.id:0;FileStore.getLocalFile(store,file,null,function(){return FileStore.updateVideoBlob(chatId,messageId,id);},function(){if(!useFileSize||size&&size<PRELOAD_VIDEO_SIZE){FileStore.getRemoteFile(id,FILE_PRIORITY,message||video);}});}function loadVideoThumbnailContent(store,video,message){if(!video)return false;var photoSize=video.thumbnail;if(!photoSize)return false;var file=photoSize.photo;if(!file)return false;file=FileStore.get(file.id)||file;var _file13=file,id=_file13.id;var blob=FileStore.getBlob(id);if(blob)return true;var chatId=message?message.chat_id:0;var messageId=message?message.id:0;FileStore.getLocalFile(store,file,null,function(){return FileStore.updateVideoThumbnailBlob(chatId,messageId,id);},function(){return FileStore.getRemoteFile(id,THUMBNAIL_PRIORITY,message||video);});return true;}function loadVideoNoteContent(store,videoNote,message){var useFileSize=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;if(!videoNote)return;var file=videoNote.video;if(!file)return;file=FileStore.get(file.id)||file;var _file14=file,id=_file14.id,size=_file14.size;var blob=FileStore.getBlob(id);if(blob)return;var chatId=message?message.chat_id:0;var messageId=message?message.id:0;FileStore.getLocalFile(store,file,null,function(){return FileStore.updateVideoNoteBlob(chatId,messageId,id);},function(){if(!useFileSize||size&&size<PRELOAD_VIDEONOTE_SIZE){FileStore.getRemoteFile(id,FILE_PRIORITY,message||videoNote);}});}function loadVideoNoteThumbnailContent(store,videoNote,message){if(!videoNote)return false;var photoSize=videoNote.thumbnail;if(!photoSize)return false;var file=photoSize.photo;if(!file)return false;file=FileStore.get(file.id)||file;var _file15=file,id=_file15.id;var blob=FileStore.getBlob(id);if(blob)return true;var chatId=message?message.chat_id:0;var messageId=message?message.id:0;FileStore.getLocalFile(store,file,null,function(){return FileStore.updateVideoNoteThumbnailBlob(chatId,messageId,id);},function(){return FileStore.getRemoteFile(id,THUMBNAIL_PRIORITY,message||videoNote);});return true;}function loadVoiceNoteContent(store,voiceNote,message){var useFileSize=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;if(!voiceNote)return;var file=voiceNote.voice;if(!file)return;file=FileStore.get(file.id)||file;var _file16=file,id=_file16.id,size=_file16.size;var blob=FileStore.getBlob(id);if(blob)return;var chatId=message?message.chat_id:0;var messageId=message?message.id:0;FileStore.getLocalFile(store,file,null,function(){return FileStore.updateVoiceNoteBlob(chatId,messageId,id);},function(){if(!useFileSize||size&&size<PRELOAD_VOICENOTE_SIZE){FileStore.getRemoteFile(id,FILE_PRIORITY,message||voiceNote);}});}function loadMessageContents(store,messages){var users=new Map();var chatId=0;var replies=new Map();for(var i=messages.length-1;i>=0;i--){var message=messages[i];if(!message){continue;}var chat_id=message.chat_id,content=message.content,sender_user_id=message.sender_user_id,reply_to_message_id=message.reply_to_message_id;if(sender_user_id){users.set(sender_user_id,sender_user_id);}if(reply_to_message_id){chatId=chat_id;replies.set(reply_to_message_id,reply_to_message_id);}if(content){switch(content['@type']){case'messageAnimation':{var animation=content.animation;loadAnimationContent(store,animation,message);loadAnimationThumbnailContent(store,animation,message);break;}case'messageAudio':{var audio=content.audio;loadAudioContent(store,audio,message);loadAudioThumbnailContent(store,audio,message);break;}case'messageChatChangePhoto':{var photo=content.photo;loadPhotoContent(store,photo,message);break;}case'messageContact':{var contact=content.contact;loadContactContent(store,contact,message);break;}case'messageDocument':{var _document3=content.document;loadDocumentContent(store,_document3,message);loadDocumentThumbnailContent(store,_document3,message);break;}case'messageGame':{var game=content.game;loadGameContent(store,game,message);loadGameThumbnailContent(store,game,message);break;}case'messageLocation':{var location=content.location;loadLocationContent(store,location,message);break;}case'messageText':{var web_page=content.web_page;if(!web_page){break;}var _animation2=web_page.animation,_audio2=web_page.audio,_document4=web_page.document,_photo3=web_page.photo,sticker=web_page.sticker,video=web_page.video,video_note=web_page.video_note,voice_note=web_page.voice_note;var loadPhoto=true;if(_animation2){loadAnimationContent(store,_animation2,message);loadPhoto=!loadAnimationThumbnailContent(store,_animation2,message);}if(_audio2){loadAudioContent(store,_audio2,message);loadPhoto=!loadAudioThumbnailContent(store,_audio2,message);}if(_document4){loadDocumentContent(store,_document4,message);loadPhoto=!loadDocumentThumbnailContent(store,_document4,message);}if(sticker){loadStickerContent(store,sticker,message);loadPhoto=!loadStickerThumbnailContent(store,sticker,message);}if(video){// loadVideoContent(store, video, message); // start loading only on video click event\nloadPhoto=!loadVideoThumbnailContent(store,video,message);}if(video_note){loadVideoNoteContent(store,video_note,message);loadPhoto=!loadVideoNoteThumbnailContent(store,video_note,message);}if(voice_note){loadVoiceNoteContent(store,voice_note,message);}if(loadPhoto){loadBigPhotoContent(store,_photo3,message);loadPhotoContent(store,_photo3,message);loadPhotoThumbnailContent(store,_photo3,message);}break;}case'messagePhoto':{var _photo4=content.photo;loadBigPhotoContent(store,_photo4,message);loadPhotoContent(store,_photo4,message);loadPhotoThumbnailContent(store,_photo4,message);break;}case'messageSticker':{var _sticker2=content.sticker;loadStickerContent(store,_sticker2,message);loadStickerThumbnailContent(store,_sticker2,message);break;}case'messageVenue':{var venue=content.venue;var _location=venue.location;loadLocationContent(store,_location,message);break;}case'messageVideo':{var _video2=content.video;// loadVideoContent(store, video, message); // start loading only on video click event\nloadVideoThumbnailContent(store,_video2,message);break;}case'messageVideoNote':{var _video_note2=content.video_note;loadVideoNoteContent(store,_video_note2,message);loadVideoNoteThumbnailContent(store,_video_note2,message);break;}case'messageVoiceNote':{var _voice_note=content.voice_note;loadVoiceNoteContent(store,_voice_note,message);break;}default:{break;}}}}loadUsersContent(store,_toConsumableArray(users.keys()));loadReplies(store,chatId,_toConsumableArray(replies.keys()));}export function saveMedia(media,message){if(!media)return;switch(media['@type']){case'animation':{saveAnimation(media,message);break;}case'document':{saveDocument(media,message);break;}case'photo':{savePhoto(media,message);break;}case'video':{saveVideo(media,message);break;}}}function saveAnimation(animation,message){var chatId=message?message.chat_id:0;var messageId=message?message.id:0;if(!animation)return;var file=animation.animation,file_name=animation.file_name;if(!file)return;var fileId=file.id;saveOrDownload(file,file_name||fileId,message||animation,function(){return FileStore.updateAnimationBlob(chatId,messageId,fileId);});}function saveDocument(document,message){var chatId=message?message.chat_id:0;var messageId=message?message.id:0;if(!document)return;var file=document.document,file_name=document.file_name;if(!file)return;var fileId=file.id;saveOrDownload(file,file_name||fileId,message||document,function(){return FileStore.updateDocumentBlob(chatId,messageId,fileId);});}function saveVideo(video,message){var chatId=message?message.chat_id:0;var messageId=message?message.id:0;if(!video)return;var file=video.video,file_name=video.file_name;if(!file)return;var fileId=file.id;saveOrDownload(file,file_name||fileId,message||video,function(){return FileStore.updateVideoBlob(chatId,messageId,fileId);});}function savePhoto(photo,message){var chatId=message?message.chat_id:0;var messageId=message?message.id:0;if(!photo)return;var photoSize=getSize(photo.sizes,PHOTO_BIG_SIZE);if(!photoSize)return;var file=photoSize.photo;if(!file)return;var fileId=file.id;saveOrDownload(file,fileId+'.jpg',message||photo,function(){return FileStore.updatePhotoBlob(chatId,messageId,fileId);});}function saveOrDownload(file,fileName,obj,callback){if(!file)return;if(!fileName)return;if(file.arr){saveData(file.arr,fileName);return;}var blob=FileStore.getBlob(file.id)||file.blob;if(blob){saveBlob(blob,fileName);return;}download(file,obj,function(){if(callback)callback();blob=FileStore.getBlob(file.id)||file.blob;if(blob){saveBlob(blob,fileName);}});}function download(file,obj,callback){if(!file)return;var id=file.id,local=file.local;var blob=FileStore.getBlob(id);if(blob){return;}if(local.is_downloading_completed){var store=FileStore.getStore();FileStore.getLocalFile(store,file,null,callback,function(){if(local.can_be_downloaded){FileStore.getRemoteFile(file.id,FILE_PRIORITY,obj);}});return;}if(local.can_be_downloaded){FileStore.getRemoteFile(id,FILE_PRIORITY,obj);}}function getViewerThumbnail(media){if(!media)return[0,0,null];switch(media['@type']){case'animation':{var thumbnail=media.thumbnail;if(thumbnail){return[thumbnail.width,thumbnail.height,thumbnail.photo];}break;}case'document':{var _thumbnail=media.thumbnail;if(_thumbnail){return[_thumbnail.width,_thumbnail.height,_thumbnail.photo];}break;}case'photo':{return getViewerFile(media,PHOTO_SIZE);}case'video':{var _thumbnail2=media.thumbnail;if(_thumbnail2){return[_thumbnail2.width,_thumbnail2.height,_thumbnail2.photo];}break;}default:{return[0,0,null];}}return[0,0,null];}function getMediaPreviewFile(chatId,messageId){var message=MessageStore.get(chatId,messageId);if(!message)return[0,0,null];var content=message.content;if(!content)return[0,0,null];switch(content['@type']){case'messageAnimation':{var animation=content.animation;if(animation&&animation.thumbnail){return[animation.thumbnail.width,animation.thumbnail.height,animation.thumbnail.photo];}break;}case'messageChatChangePhoto':{return getMediaFile(chatId,messageId,PHOTO_SIZE);}case'messageDocument':{var _document5=content.document;if(_document5){return[50,50,_document5.document];}break;}case'messagePhoto':{return getMediaFile(chatId,messageId,PHOTO_SIZE);}case'messageText':{var web_page=content.web_page;if(web_page){var _animation3=web_page.animation,_document6=web_page.document,video=web_page.video,photo=web_page.photo;if(_animation3&&_animation3.thumbnail){return[_animation3.thumbnail.width,_animation3.thumbnail.height,_animation3.thumbnail.photo];}if(_document6){return[50,50,_document6.document];}if(video&&video.thumbnail){return[video.thumbnail.width,video.thumbnail.height,video.thumbnail.photo];}if(photo){return getMediaFile(chatId,messageId,PHOTO_SIZE);}}break;}case'messageVideo':{var _video3=content.video;if(_video3.thumbnail){return[_video3.thumbnail.width,_video3.thumbnail.height,_video3.thumbnail.photo];}break;}default:{return[0,0,null];}}return[0,0,null];}function getViewerFile(media,size){if(!size)return[0,0,null];switch(media['@type']){case'animation':{return[media.width,media.height,media.animation];}case'photo':{var photoSize=getSize(media.sizes,size);if(photoSize){return[photoSize.width,photoSize.height,photoSize.photo];}break;}case'document':{return[50,50,document.document];}case'video':{return[media.width,media.height,media.video];}default:{}}return[0,0,null];}function getMediaFile(chatId,messageId,size){if(!size)return[0,0,null];var message=MessageStore.get(chatId,messageId);if(!message)return[0,0,null];var content=message.content;if(!content)return[0,0,null];switch(content['@type']){case'messageAnimation':{var animation=content.animation;if(animation){return[animation.width,animation.height,animation.animation];}break;}case'messageChatChangePhoto':{var photo=content.photo;if(photo){var photoSize=getSize(photo.sizes,size);if(photoSize){return[photoSize.width,photoSize.height,photoSize.photo];}}break;}case'messageDocument':{var _document7=content.document;if(_document7){return[50,50,_document7.document];}break;}case'messagePhoto':{var _photo5=content.photo;if(_photo5){var _photoSize=getSize(_photo5.sizes,size);if(_photoSize){return[_photoSize.width,_photoSize.height,_photoSize.photo];}}break;}case'messageText':{var web_page=content.web_page;if(web_page){var _animation4=web_page.animation,_document8=web_page.document,_photo6=web_page.photo,video=web_page.video;if(_animation4){return[_animation4.width,_animation4.height,_animation4.animation];}if(_document8){return[50,50,_document8.document];}if(_photo6){var _photoSize2=getSize(_photo6.sizes,size);if(_photoSize2){return[_photoSize2.width,_photoSize2.height,_photoSize2.photo];}break;}if(video){return[video.width,video.height,video.video];}}break;}case'messageVideo':{var _video4=content.video;if(_video4){return[_video4.width,_video4.height,_video4.video];}break;}default:{}}return[0,0,null];}function cancelLoadMediaViewerContent(messages){if(!messages)return;if(!messages.length)return;for(var i=0;i<messages.length;i++){var message=messages[i];var content=message.content;if(content){switch(content['@type']){case'messagePhoto':{var photo=content.photo;if(!photo)break;// preview\n/*let [previewId, previewPid, previewIdbKey] = getPhotoPreviewFile(message);\n                    if (previewPid) {\n                        let preview = this.getPreviewPhotoSize(message.content.photo.sizes);\n                        if (!preview.blob){\n                            FileStore.getLocalFile(store, preview, null,\n                                () => MessageStore.updateMessagePhoto(message.id),\n                                () => { if (loadRemote)  FileStore.getRemoteFile(previewId, 2, message); },\n                                'load_contents_preview_',\n                                message.id);\n\n                        }\n                    }*/var photoSize=getSize(photo.sizes,PHOTO_BIG_SIZE);if(!photoSize)break;var file=photoSize.photo;var blob=file.blob||FileStore.getBlob(file.id);if(blob)return;FileStore.cancelGetRemoteFile(file.id);break;}case'messageVideo':{var video=content.video;if(!video)break;if(video.thumbnail){var _file18=video.thumbnail.photo;var _blob2=_file18.blob||FileStore.getBlob(_file18.id);if(_blob2)break;FileStore.cancelGetRemoteFile(_file18.id);}var _file17=video.video;if(!_file17)break;var _blob=_file17.blob||FileStore.getBlob(_file17.id);if(_blob)break;FileStore.cancelGetRemoteFile(_file17.id);break;}case'messageText':{var web_page=message.content.web_page;if(web_page){var _video5=web_page.video;if(_video5){if(_video5.thumbnail){var _file20=_video5.thumbnail.photo;var _blob4=_file20.blob||FileStore.getBlob(_file20.id);if(_blob4)break;FileStore.cancelGetRemoteFile(_file20.id);}var _file19=_video5.video;if(!_file19)break;var _blob3=_file19.blob||FileStore.getBlob(_file19.id);if(_blob3)break;FileStore.cancelGetRemoteFile(_file19.id);}}break;}}}}}function loadMediaViewerContent(messages){var useSizeLimit=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!messages)return;if(!messages.length)return;var store=FileStore.getStore();for(var i=0;i<messages.length;i++){var message=messages[i];var content=message.content;if(content){switch(content['@type']){case'messageAnimation':{var animation=content.animation;loadAnimationContent(store,animation,message,useSizeLimit);loadAnimationThumbnailContent(store,animation,message);break;}case'messageChatChangePhoto':{var photo=content.photo;loadBigPhotoContent(store,photo,message);break;}case'messageDocument':{var _document9=content.document;loadDocumentContent(store,_document9,message,useSizeLimit);break;}case'messagePhoto':{var _photo7=content.photo;loadBigPhotoContent(store,_photo7,message);break;}case'messageText':{var web_page=message.content.web_page;if(!web_page){break;}var _animation5=web_page.animation,_document10=web_page.document,_photo8=web_page.photo,video=web_page.video;var loadPhoto=true;if(_animation5){loadAnimationContent(store,_animation5,message,useSizeLimit);loadPhoto=!loadAnimationThumbnailContent(store,_animation5,message);}if(_document10){loadDocumentContent(store,_document10,message,useSizeLimit);loadPhoto=false;}if(video){loadVideoContent(store,video,message,useSizeLimit);loadPhoto=!loadVideoThumbnailContent(store,video,message);}if(loadPhoto){loadBigPhotoContent(store,_photo8,message);}break;}case'messageVideo':{var _video6=content.video;loadVideoThumbnailContent(store,_video6,message);loadVideoContent(store,_video6,message,useSizeLimit);break;}}}}}function cancelPreloadMediaViewerContent(index,history){if(!history.length)return;var messages=[];if(index>0){messages.push(history[index-1]);}if(index<history.length-1){messages.push(history[index+1]);}cancelLoadMediaViewerContent([history[index]]);cancelLoadMediaViewerContent(messages);}function preloadMediaViewerContent(index,history){if(!history.length)return;var messages=[];if(index>0){messages.push(history[index-1]);}if(index<history.length-1){messages.push(history[index+1]);}loadMediaViewerContent([history[index]],false);loadMediaViewerContent(messages,true);}function loadUserFileContent(store,file,userId){if(!file)return;var _file21=file,id=_file21.id;file=FileStore.get(id)||file;var user=UserStore.get(userId);if(!user)return;var blob=file.blob||FileStore.getBlob(id);if(blob)return;FileStore.getLocalFile(store,file,null,function(){return FileStore.updateUserPhotoBlob(userId,id);},function(){return FileStore.getRemoteFile(id,THUMBNAIL_PRIORITY,user);});}function loadChatFileContent(store,file,chatId){if(!file)return;var _file22=file,id=_file22.id;file=FileStore.get(id)||file;var chat=ChatStore.get(chatId);if(!chat)return;var blob=file.blob||FileStore.getBlob(id);if(blob)return;FileStore.getLocalFile(store,file,null,function(){return FileStore.updateChatPhotoBlob(chatId,id);},function(){return FileStore.getRemoteFile(id,THUMBNAIL_PRIORITY,chat);});}function loadProfileMediaViewerContent(chatId,photos){if(!photos)return;var store=FileStore.getStore();photos.forEach(function(photo){switch(photo['@type']){case'chatPhoto':{var _photo9=photo,small=_photo9.small,big=_photo9.big;loadChatFileContent(store,small,chatId);loadChatFileContent(store,big,chatId);break;}case'profilePhoto':{var userId=getChatUserId(chatId);var _photo10=photo,_small=_photo10.small,_big=_photo10.big;loadUserFileContent(store,_small,userId);loadUserFileContent(store,_big,userId);break;}case'userProfilePhoto':{photo=getProfilePhoto(photo);if(!photo)break;var _userId=getChatUserId(chatId);var _photo11=photo,_small2=_photo11.small,_big2=_photo11.big;loadUserFileContent(store,_small2,_userId);loadUserFileContent(store,_big2,_userId);break;}}});}function preloadProfileMediaViewerContent(chatId,index,history){if(!history.length)return;var items=[];if(index>0){items.push(history[index-1]);}if(index<history.length-1){items.push(history[index+1]);}if(index>=0&&index<history.length){items.push(history[index]);}loadProfileMediaViewerContent(chatId,items);}function loadUserContent(store,userId){var user=UserStore.get(userId);if(!user)return;var profile_photo=user.profile_photo;if(!profile_photo)return;var file=profile_photo.small;loadUserFileContent(store,file,userId);}function loadUsersContent(store,ids){if(!ids)return;ids.forEach(function(id){return loadUserContent(store,id);});}function loadChatContent(store,chatId){var chat=ChatStore.get(chatId);if(!chat)return;var photo=chat.photo;loadChatPhotoContent(store,photo,chat.id);}function loadChatPhotoContent(store,photo,chatId){if(!photo)return;var file=photo.small;loadChatFileContent(store,file,chatId);}function loadChatsContent(store,ids){if(!ids)return;ids.forEach(function(id){return loadChatContent(store,id);});}function loadDraftContent(store,chatId){var chat=ChatStore.get(chatId);if(!chat)return;var draft_message=chat.draft_message;if(!draft_message)return;var reply_to_message_id=draft_message.reply_to_message_id;if(!reply_to_message_id)return;loadReplies(store,chatId,[reply_to_message_id]);}function loadStickerSetContent(store,stickerSet){console.log('Lottie.loadStickerSetContent');if(!stickerSet)return;var stickers=stickerSet.stickers;loadStickersContent(store,stickers);}function loadStickersContent(store,stickers){if(!stickers)return;stickers.forEach(function(sticker){console.log('Lottie.loadStickerThumbnailContent',sticker.sticker.id);loadStickerThumbnailContent(store,sticker,null);if(sticker.is_animated){console.log('Lottie.loadStickerContent',sticker.sticker.id);loadStickerContent(store,sticker,null);}});}function isGifMimeType(mimeType){return mimeType&&mimeType.toLowerCase()==='image/gif';}function getSrc(file){var blob=getBlob(file);return FileStore.getBlobUrl(blob)||'';}function getBlob(file){return file?FileStore.getBlob(file.id)||file.blob:null;}function getDownloadedSize(file){if(!file)return'0';if(!file.local)return'0';if(!file.local.is_downloading_active)return'0';return getSizeString(file.local.downloaded_size);}function getUploadedSize(file){if(!file)return'0';if(!file.remote)return'0';if(!file.remote.is_uploading_active)return'0';return getSizeString(file.remote.uploaded_size);}function getExtension(fileName){if(!fileName){return'';}var parts=fileName.split('.');if(parts.length===1||parts[0]===''&&parts.length===2){return'';}return parts.pop().toLowerCase();}function loadInstantViewContent(instantView){if(!instantView)return;var page_blocks=instantView.page_blocks;if(!page_blocks)return;var store=FileStore.getStore();page_blocks.forEach(function(pageBlock){return loadPageBlockContent(store,pageBlock);});}function loadPageBlockContent(store,b){if(!b)return;switch(b['@type']){case'pageBlockAnchor':{break;}case'pageBlockAnimation':{var animation=b.animation,caption=b.caption;loadAnimationThumbnailContent(store,animation,null);loadAnimationContent(store,animation,null);loadPageBlockContent(store,caption);break;}case'pageBlockAudio':{var audio=b.audio,_caption=b.caption;loadAudioThumbnailContent(store,audio,null);loadAudioContent(store,audio,null);loadPageBlockContent(store,_caption);break;}case'pageBlockAuthorDate':{var author=b.author;loadRichTextContent(store,author);break;}case'pageBlockBlockQuote':{var text=b.text,credit=b.credit;loadRichTextContent(store,text);loadRichTextContent(store,credit);break;}// actually not a pageBlock child but load content in the same way\ncase'pageBlockCaption':{var _text=b.text,_credit=b.credit;loadRichTextContent(store,_text);loadRichTextContent(store,_credit);break;}case'pageBlockChatLink':{var photo=b.photo;loadChatPhotoContent(store,photo,0);break;}case'pageBlockCollage':{var page_blocks=b.page_blocks,_caption2=b.caption;loadPageBlockContent(store,_caption2);page_blocks.forEach(function(x){return loadPageBlockContent(store,x);});break;}case'pageBlockCover':{var cover=b.cover;loadPageBlockContent(store,cover);break;}case'pageBlockDetails':{var header=b.header,_page_blocks=b.page_blocks;loadPageBlockContent(store,header);_page_blocks.forEach(function(x){return loadPageBlockContent(store,x);});break;}case'pageBlockDivider':{break;}case'pageBlockEmbedded':{var poster_photo=b.poster_photo,_caption3=b.caption;loadPhotoContent(store,poster_photo,null);loadPageBlockContent(store,_caption3);break;}case'pageBlockEmbeddedPost':{var author_photo=b.author_photo,_page_blocks2=b.page_blocks,_caption4=b.caption;loadPhotoContent(store,author_photo,null);_page_blocks2.forEach(function(x){return loadPageBlockContent(store,x);});loadPageBlockContent(store,_caption4);break;}case'pageBlockFooter':{var footer=b.footer;loadRichTextContent(store,footer);break;}case'pageBlockHeader':{var _header=b.header;loadRichTextContent(store,_header);break;}case'pageBlockKicker':{var kicker=b.kicker;loadRichTextContent(store,kicker);break;}case'pageBlockList':{var items=b.items;items.forEach(function(x){return loadPageBlockContent(store,x);});break;}// actually not a pageBlock child but load content in the same way\ncase'pageBlockListItem':{var _page_blocks3=b.page_blocks;_page_blocks3.forEach(function(x){return loadPageBlockContent(store,x);});break;}case'pageBlockMap':{var _caption5=b.caption;loadPageBlockMapContent(store,b,null);loadPageBlockContent(store,_caption5);break;}case'pageBlockParagraph':{var _text2=b.text;loadRichTextContent(store,_text2);break;}case'pageBlockPhoto':{var _photo12=b.photo,_caption6=b.caption;loadPhotoContent(store,_photo12,null,IV_PHOTO_SIZE);loadPageBlockContent(store,_caption6);break;}case'pageBlockPreformatted':{var _text3=b.text;loadRichTextContent(store,_text3);break;}case'pageBlockPullQuote':{var _text4=b.text,_credit2=b.credit;loadRichTextContent(store,_text4);loadRichTextContent(store,_credit2);break;}case'pageBlockRelatedArticles':{var _header2=b.header,articles=b.articles;loadRichTextContent(store,_header2);articles.forEach(function(x){return loadPageBlockContent(store,x);});break;}// actually not a pageBlock child but load content in the same way\ncase'pageBlockRelatedArticle':{var _photo13=b.photo;loadPhotoContent(store,_photo13,null);break;}case'pageBlockSlideshow':{var _page_blocks4=b.page_blocks,_caption7=b.caption;loadPageBlockContent(store,_caption7);_page_blocks4.forEach(function(x){return loadPageBlockContent(store,x);});break;}case'pageBlockSubheader':{var subheader=b.subheader;loadRichTextContent(store,subheader);break;}case'pageBlockSubtitle':{var subtitle=b.subtitle;loadRichTextContent(store,subtitle);break;}case'pageBlockTable':{var _caption8=b.caption,cells=b.cells;loadRichTextContent(store,_caption8);cells.forEach(function(row){return row.forEach(function(x){return loadPageBlockContent(store,x);});});break;}// actually not a pageBlock child but load content in the same way\ncase'pageBlockTableCell':{var _text5=b.text;loadRichTextContent(store,_text5);break;}case'pageBlockTitle':{var title=b.title;loadRichTextContent(store,title);break;}case'pageBlockVideo':{var video=b.video,_caption9=b.caption;loadVideoThumbnailContent(store,video,null);loadVideoContent(store,video,null);loadPageBlockContent(store,_caption9);break;}}}function loadRichTextContent(store,t){if(!t)return;switch(t['@type']){case'richTextAnchor':{var text=t.text;loadRichTextContent(store,text);break;}case'richTextBold':{var _text6=t.text;loadRichTextContent(store,_text6);break;}case'richTextEmailAddress':{var _text7=t.text;loadRichTextContent(store,_text7);break;}case'richTextFixed':{var _text8=t.text;loadRichTextContent(store,_text8);break;}case'richTextIcon':{var _document11=t.document;loadDocumentThumbnailContent(store,_document11,null);loadDocumentContent(store,_document11,null,false);break;}case'richTextItalic':{var _text9=t.text;loadRichTextContent(store,_text9);break;}case'richTextMarked':{var _text10=t.text;loadRichTextContent(store,_text10);break;}case'richTextPhoneNumber':{var _text11=t.text;loadRichTextContent(store,_text11);break;}case'richTextPlain':{var _text12=t.text;loadRichTextContent(store,_text12);break;}case'richTexts':{var texts=t.texts;texts.forEach(function(x){return loadRichTextContent(store,x);});break;}case'richTextStrikethrough':{var _text13=t.text;loadRichTextContent(store,_text13);break;}case'richTextSubscript':{var _text14=t.text;loadRichTextContent(store,_text14);break;}case'richTextSuperscript':{var _text15=t.text;loadRichTextContent(store,_text15);break;}case'richTextUnderline':{var _text16=t.text;loadRichTextContent(store,_text16);break;}case'richTextUrl':{var _text17=t.text;loadRichTextContent(store,_text17);break;}}}function getAnimationData(file){return new Promise(function(resolve){if(!file){resolve(null);return;}var blob=FileStore.getBlob(file.id);if(!blob){resolve(null);return;}var fileReader=new FileReader();fileReader.onload=function(event){return resolve(JSON.parse(event.target.result));};fileReader.onerror=function(){return resolve(null);};fileReader.onabort=function(){return resolve(null);};fileReader.readAsText(blob);});}export{getFileSize,getSizeString,saveData,saveBlob,loadMessageContents,loadMediaViewerContent,preloadMediaViewerContent,cancelLoadMediaViewerContent,cancelPreloadMediaViewerContent,loadProfileMediaViewerContent,preloadProfileMediaViewerContent,loadChatContent,loadChatsContent,loadDraftContent,loadInstantViewContent,loadStickerContent,loadStickersContent,loadStickerSetContent,loadStickerThumbnailContent,loadUserContent,loadUsersContent,saveOrDownload,download,getMediaFile,getMediaPreviewFile,isGifMimeType,getSrc,getBlob,getDownloadedSize,getUploadedSize,getExtension,getViewerFile,getViewerThumbnail,getAnimationData};","map":{"version":3,"sources":["/Users/yosuahalim/Documents/Projects/telegram-app/src/Utils/File.js"],"names":["getPhotoSize","getPhotoThumbnailSize","getSize","getChatUserId","getProfilePhoto","getLocationId","FILE_PRIORITY","IV_LOCATION_HEIGHT","IV_LOCATION_WIDTH","IV_PHOTO_SIZE","LOCATION_HEIGHT","LOCATION_SCALE","LOCATION_WIDTH","LOCATION_ZOOM","PHOTO_BIG_SIZE","PHOTO_SIZE","PRELOAD_ANIMATION_SIZE","PRELOAD_AUDIO_SIZE","PRELOAD_DOCUMENT_SIZE","PRELOAD_STICKER_SIZE","PRELOAD_VIDEO_SIZE","PRELOAD_VIDEONOTE_SIZE","PRELOAD_VOICENOTE_SIZE","THUMBNAIL_PRIORITY","ChatStore","FileStore","MessageStore","UserStore","TdLibController","getSizeString","size","toFixed","getFileSize","file","getBigPhoto","photo","big","saveData","data","filename","mime","blob","Blob","type","window","navigator","msSaveBlob","blobURL","URL","createObjectURL","tempLink","document","createElement","style","display","href","setAttribute","download","body","appendChild","click","removeChild","revokeObjectURL","saveBlob","loadReplies","store","chatId","messageIds","length","send","chat_id","message_ids","result","messages","map","message","i","id","content","setItems","emit","get","getStore","loadReplyContents","animation","loadAnimationThumbnailContent","audio","loadAudioThumbnailContent","loadPhotoContent","loadDocumentThumbnailContent","game","loadGameThumbnailContent","sticker","loadStickerThumbnailContent","web_page","video","video_note","loadVideoThumbnailContent","loadVideoNoteThumbnailContent","loadAudioContent","useFileSize","getBlob","messageId","getLocalFile","updateAudioBlob","getRemoteFile","photoSize","album_cover_thumbnail","updateAudioThumbnailBlob","loadAnimationContent","updateAnimationBlob","thumbnail","updateAnimationThumbnailBlob","loadContactContent","contact","user_id","user","loadUserContent","loadDocumentContent","updateDocumentBlob","updateDocumentThumbnailBlob","loadGameContent","loadPageBlockMapContent","pageBlockMap","location","locationId","getLocationFile","width","height","zoom","scale","setLocationFile","updateLocationBlob","loadLocationContent","loadBigPhotoContent","sizes","updatePhotoBlob","displaySize","loadPhotoThumbnailContent","loadStickerContent","updateStickerBlob","updateStickerThumbnailBlob","loadVideoContent","updateVideoBlob","updateVideoThumbnailBlob","loadVideoNoteContent","videoNote","updateVideoNoteBlob","updateVideoNoteThumbnailBlob","loadVoiceNoteContent","voiceNote","voice","updateVoiceNoteBlob","loadMessageContents","users","Map","replies","sender_user_id","reply_to_message_id","set","voice_note","loadPhoto","venue","loadUsersContent","keys","saveMedia","media","saveAnimation","saveDocument","savePhoto","saveVideo","file_name","fileId","saveOrDownload","fileName","obj","callback","arr","local","is_downloading_completed","can_be_downloaded","getViewerThumbnail","getViewerFile","getMediaPreviewFile","getMediaFile","cancelLoadMediaViewerContent","cancelGetRemoteFile","loadMediaViewerContent","useSizeLimit","cancelPreloadMediaViewerContent","index","history","push","preloadMediaViewerContent","loadUserFileContent","userId","updateUserPhotoBlob","loadChatFileContent","chat","updateChatPhotoBlob","loadProfileMediaViewerContent","photos","forEach","small","preloadProfileMediaViewerContent","items","profile_photo","ids","loadChatContent","loadChatPhotoContent","loadChatsContent","loadDraftContent","draft_message","loadStickerSetContent","stickerSet","console","log","stickers","loadStickersContent","is_animated","isGifMimeType","mimeType","toLowerCase","getSrc","getBlobUrl","getDownloadedSize","is_downloading_active","downloaded_size","getUploadedSize","remote","is_uploading_active","uploaded_size","getExtension","parts","split","pop","loadInstantViewContent","instantView","page_blocks","pageBlock","loadPageBlockContent","b","caption","author","loadRichTextContent","text","credit","x","cover","header","poster_photo","author_photo","footer","kicker","articles","subheader","subtitle","cells","row","title","t","texts","getAnimationData","Promise","resolve","fileReader","FileReader","onload","event","JSON","parse","target","onerror","onabort","readAsText"],"mappings":"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","sourcesContent":["/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { getPhotoSize, getPhotoThumbnailSize, getSize } from './Common';\nimport { getChatUserId } from './Chat';\nimport { getProfilePhoto } from './User';\nimport { getLocationId } from './Message';\nimport {\n    FILE_PRIORITY,\n    IV_LOCATION_HEIGHT,\n    IV_LOCATION_WIDTH,\n    IV_PHOTO_SIZE,\n    LOCATION_HEIGHT,\n    LOCATION_SCALE,\n    LOCATION_WIDTH,\n    LOCATION_ZOOM,\n    PHOTO_BIG_SIZE,\n    PHOTO_SIZE,\n    PRELOAD_ANIMATION_SIZE,\n    PRELOAD_AUDIO_SIZE,\n    PRELOAD_DOCUMENT_SIZE,\n    PRELOAD_STICKER_SIZE,\n    PRELOAD_VIDEO_SIZE,\n    PRELOAD_VIDEONOTE_SIZE,\n    PRELOAD_VOICENOTE_SIZE,\n    THUMBNAIL_PRIORITY\n} from '../Constants';\nimport ChatStore from '../Stores/ChatStore';\nimport FileStore from '../Stores/FileStore';\nimport MessageStore from '../Stores/MessageStore';\nimport UserStore from '../Stores/UserStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nfunction getSizeString(size) {\n    if (!size) return `0 B`;\n\n    if (size < 1024) {\n        return `${size} B`;\n    }\n\n    if (size < 1024 * 1024) {\n        return `${(size / 1024).toFixed(1)} KB`;\n    }\n\n    if (size < 1024 * 1024 * 1024) {\n        return `${(size / 1024 / 1024).toFixed(1)} MB`;\n    }\n\n    return `${(size / 1024 / 1024 / 1024).toFixed(1)} GB`;\n}\n\nfunction getFileSize(file) {\n    if (!file) return null;\n\n    let size = file.size;\n    if (!size) return null;\n\n    return getSizeString(size);\n}\n\nfunction getBigPhoto(photo) {\n    if (!photo) return null;\n\n    return photo.big;\n}\n\nfunction saveData(data, filename, mime) {\n    let blob = new Blob([data], { type: mime || 'application/octet-stream' });\n    if (typeof window.navigator.msSaveBlob !== 'undefined') {\n        // IE workaround for \"HTML7007: One or more blob URLs were\n        // revoked by closing the blob for which they were created.\n        // These URLs will no longer resolve as the data backing\n        // the URL has been freed.\"\n        window.navigator.msSaveBlob(blob, filename);\n    } else {\n        let blobURL = window.URL.createObjectURL(blob);\n        let tempLink = document.createElement('a');\n        tempLink.style.display = 'none';\n        tempLink.href = blobURL;\n        tempLink.setAttribute('download', filename);\n\n        // Safari thinks _blank anchor are pop ups. We only want to set _blank\n        // target if the browser does not support the HTML5 download attribute.\n        // This allows you to download files in desktop safari if pop up blocking\n        // is enabled.\n        if (typeof tempLink.download === 'undefined') {\n            tempLink.setAttribute('target', '_blank');\n        }\n\n        document.body.appendChild(tempLink);\n        tempLink.click();\n        document.body.removeChild(tempLink);\n        window.URL.revokeObjectURL(blobURL);\n    }\n}\n\nfunction saveBlob(blob, filename) {\n    if (typeof window.navigator.msSaveBlob !== 'undefined') {\n        // IE workaround for \"HTML7007: One or more blob URLs were\n        // revoked by closing the blob for which they were created.\n        // These URLs will no longer resolve as the data backing\n        // the URL has been freed.\"\n        window.navigator.msSaveBlob(blob, filename);\n    } else {\n        let blobURL = window.URL.createObjectURL(blob);\n        let tempLink = document.createElement('a');\n        tempLink.style.display = 'none';\n        tempLink.href = blobURL;\n        tempLink.setAttribute('download', filename);\n\n        // Safari thinks _blank anchor are pop ups. We only want to set _blank\n        // target if the browser does not support the HTML5 download attribute.\n        // This allows you to download files in desktop safari if pop up blocking\n        // is enabled.\n        if (typeof tempLink.download === 'undefined') {\n            tempLink.setAttribute('target', '_blank');\n        }\n\n        document.body.appendChild(tempLink);\n        tempLink.click();\n        document.body.removeChild(tempLink);\n        window.URL.revokeObjectURL(blobURL);\n    }\n}\n\nasync function loadReplies(store, chatId, messageIds) {\n    if (!chatId) return;\n    if (!messageIds) return;\n    if (!messageIds.length) return;\n\n    const result = await TdLibController.send({\n        '@type': 'getMessages',\n        chat_id: chatId,\n        message_ids: messageIds\n    });\n\n    result.messages = result.messages.map((message, i) => {\n        return (\n            message || {\n                '@type': 'deletedMessage',\n                chat_id: chatId,\n                id: messageIds[i],\n                content: null\n            }\n        );\n    });\n\n    MessageStore.setItems(result.messages);\n\n    for (let i = messageIds.length - 1; i >= 0; i--) {\n        MessageStore.emit('getMessageResult', MessageStore.get(chatId, messageIds[i]));\n    }\n\n    store = FileStore.getStore();\n\n    loadReplyContents(store, result.messages);\n}\n\nfunction loadReplyContents(store, messages) {\n    for (let i = messages.length - 1; i >= 0; i--) {\n        const message = messages[i];\n        if (!message) {\n            continue;\n        }\n\n        const { content } = message;\n        if (content) {\n            switch (content['@type']) {\n                case 'messageAnimation': {\n                    const { animation } = content;\n\n                    loadAnimationThumbnailContent(store, animation, message);\n                    break;\n                }\n                case 'messageAudio': {\n                    const { audio } = content;\n\n                    loadAudioThumbnailContent(store, audio, message);\n                    break;\n                }\n                case 'messageChatChangePhoto': {\n                    const { photo } = content;\n\n                    loadPhotoContent(store, photo, message);\n                    break;\n                }\n                case 'messageDocument': {\n                    const { document } = content;\n\n                    loadDocumentThumbnailContent(store, document, message);\n                    break;\n                }\n                case 'messageGame': {\n                    const { game } = content;\n\n                    loadGameThumbnailContent(store, game, message);\n                    break;\n                }\n                case 'messagePhoto': {\n                    const { photo } = content;\n\n                    loadPhotoContent(store, photo, message);\n                    break;\n                }\n                case 'messageSticker': {\n                    const { sticker } = content;\n\n                    loadStickerThumbnailContent(store, sticker, message);\n                    break;\n                }\n                case 'messageText': {\n                    const { web_page } = content;\n                    if (!web_page) break;\n\n                    const { animation, audio, document, photo, sticker, video, video_note } = web_page;\n\n                    if (photo) {\n                        loadPhotoContent(store, photo, message);\n                        break;\n                    }\n\n                    if (animation) {\n                        loadAnimationThumbnailContent(store, animation, message);\n                        break;\n                    }\n\n                    if (audio) {\n                        loadAudioThumbnailContent(store, audio, message);\n                        break;\n                    }\n\n                    if (document) {\n                        loadDocumentThumbnailContent(store, document, message);\n                        break;\n                    }\n\n                    if (sticker) {\n                        loadStickerThumbnailContent(store, sticker, message);\n                        break;\n                    }\n\n                    if (video) {\n                        loadVideoThumbnailContent(store, video, message);\n                        break;\n                    }\n\n                    if (video_note) {\n                        loadVideoNoteThumbnailContent(store, video_note, message);\n                        break;\n                    }\n\n                    break;\n                }\n                case 'messageVideo': {\n                    const { video } = content;\n\n                    loadVideoThumbnailContent(store, video, message);\n                    break;\n                }\n                case 'messageVideoNote': {\n                    const { video_note } = content;\n\n                    loadVideoNoteThumbnailContent(store, video_note, message);\n                    break;\n                }\n            }\n        }\n    }\n}\n\nfunction loadAudioContent(store, audio, message, useFileSize = true) {\n    if (!audio) return;\n\n    let { audio: file } = audio;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateAudioBlob(chatId, messageId, id),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_AUDIO_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || audio);\n            }\n        }\n    );\n}\n\nfunction loadAudioThumbnailContent(store, audio, message) {\n    if (!audio) return false;\n\n    const { album_cover_thumbnail: photoSize } = audio;\n    if (!photoSize) return false;\n\n    let { photo: file } = photoSize;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(file.id);\n    if (blob) return true;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateAudioThumbnailBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message || audio)\n    );\n\n    return true;\n}\n\nfunction loadAnimationContent(store, animation, message, useFileSize = true) {\n    if (!animation) return;\n\n    let { animation: file } = animation;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateAnimationBlob(chatId, messageId, id),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_ANIMATION_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || animation);\n            }\n        }\n    );\n}\n\nfunction loadAnimationThumbnailContent(store, animation, message) {\n    if (!animation) return false;\n\n    const { thumbnail: photoSize } = animation;\n    if (!photoSize) return false;\n\n    let { photo: file } = photoSize;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(file.id);\n    if (blob) return true;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateAnimationThumbnailBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message || animation)\n    );\n\n    return true;\n}\n\nfunction loadContactContent(store, contact, message) {\n    if (!contact) return;\n    if (!message) return;\n\n    const { user_id } = contact;\n    const user = UserStore.get(user_id);\n    if (!user) return;\n\n    loadUserContent(store, user);\n}\n\nfunction loadDocumentContent(store, document, message, useFileSize = true) {\n    if (!document) return;\n\n    let { document: file } = document;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateDocumentBlob(chatId, messageId, id),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_DOCUMENT_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || document);\n            }\n        }\n    );\n}\n\nfunction loadDocumentThumbnailContent(store, document, message) {\n    if (!document) return false;\n\n    const { thumbnail: photoSize } = document;\n    if (!photoSize) return false;\n\n    let { photo: file } = photoSize;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(file.id);\n    if (blob) return true;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateDocumentThumbnailBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message || document)\n    );\n\n    return true;\n}\n\nfunction loadGameContent(store, game, message, useFileSize = true) {\n    if (!game) return;\n\n    const { animation } = game;\n\n    loadAnimationContent(store, animation, message, useFileSize);\n}\n\nfunction loadGameThumbnailContent(store, game, message) {\n    if (!game) return false;\n\n    const { photo, animation } = game;\n    if (loadAnimationThumbnailContent(store, animation, message)) {\n        return true;\n    }\n\n    loadPhotoContent(store, photo, message);\n    return true;\n}\n\nasync function loadPageBlockMapContent(store, pageBlockMap, message) {\n    if (!pageBlockMap) return;\n\n    const { location } = pageBlockMap;\n    const locationId = getLocationId(location, IV_LOCATION_WIDTH, IV_LOCATION_HEIGHT);\n    if (!locationId) return;\n\n    let file = FileStore.getLocationFile(locationId);\n    if (!file) {\n        file = await TdLibController.send({\n            '@type': 'getMapThumbnailFile',\n            location,\n            width: IV_LOCATION_WIDTH,\n            height: IV_LOCATION_HEIGHT,\n            zoom: LOCATION_ZOOM,\n            scale: LOCATION_SCALE,\n            chat_id: message ? message.chat_id : 0\n        });\n        FileStore.setLocationFile(locationId, file);\n\n        store = FileStore.getStore();\n    }\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(file.id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateLocationBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, FILE_PRIORITY, message || pageBlockMap)\n    );\n}\n\nasync function loadLocationContent(store, location, message) {\n    if (!location) return;\n\n    const locationId = getLocationId(location);\n    if (!locationId) return;\n\n    let file = FileStore.getLocationFile(locationId);\n    if (!file) {\n        file = await TdLibController.send({\n            '@type': 'getMapThumbnailFile',\n            location,\n            width: LOCATION_WIDTH,\n            height: LOCATION_HEIGHT,\n            zoom: LOCATION_ZOOM,\n            scale: LOCATION_SCALE,\n            chat_id: message ? message.chat_id : 0\n        });\n        FileStore.setLocationFile(locationId, file);\n\n        store = FileStore.getStore();\n    }\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(file.id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateLocationBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, FILE_PRIORITY, message || location)\n    );\n}\n\nfunction loadBigPhotoContent(store, photo, message) {\n    if (!photo) return;\n\n    const { sizes } = photo;\n    if (!sizes) return;\n\n    const photoSize = getSize(sizes, PHOTO_BIG_SIZE);\n    if (!photoSize) return;\n\n    let { photo: file } = photoSize;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updatePhotoBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, FILE_PRIORITY, message || photo)\n    );\n}\n\nfunction loadPhotoContent(store, photo, message, displaySize = PHOTO_SIZE) {\n    if (!photo) return;\n\n    const { sizes } = photo;\n    if (!sizes) return;\n\n    const photoSize = getPhotoSize(sizes, displaySize);\n    if (!photoSize) return;\n\n    let { photo: file } = photoSize;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updatePhotoBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, FILE_PRIORITY, message || photo)\n    );\n}\n\nfunction loadPhotoThumbnailContent(store, photo, message) {\n    if (!photo) return false;\n    if (!message) return false;\n\n    const photoSize = getPhotoThumbnailSize(photo.sizes);\n    if (!photoSize) return false;\n\n    let { photo: file } = photoSize;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return true;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updatePhotoBlob(message.chat_id, message.id, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message)\n    );\n\n    return true;\n}\n\nfunction loadStickerContent(store, sticker, message, useFileSize = true) {\n    if (!sticker) return;\n\n    let { sticker: file } = sticker;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateStickerBlob(chatId, messageId, id),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_STICKER_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || sticker);\n            }\n        }\n    );\n}\n\nfunction loadStickerThumbnailContent(store, sticker, message) {\n    if (!sticker) return false;\n\n    const { thumbnail: photoSize } = sticker;\n    if (!photoSize) return false;\n\n    let { photo: file } = photoSize;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return true;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateStickerThumbnailBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message || sticker)\n    );\n\n    return true;\n}\n\nfunction loadVideoContent(store, video, message, useFileSize = true) {\n    if (!video) return;\n\n    let { video: file } = video;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateVideoBlob(chatId, messageId, id),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_VIDEO_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || video);\n            }\n        }\n    );\n}\n\nfunction loadVideoThumbnailContent(store, video, message) {\n    if (!video) return false;\n\n    const { thumbnail: photoSize } = video;\n    if (!photoSize) return false;\n\n    let { photo: file } = photoSize;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return true;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateVideoThumbnailBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message || video)\n    );\n\n    return true;\n}\n\nfunction loadVideoNoteContent(store, videoNote, message, useFileSize = true) {\n    if (!videoNote) return;\n\n    let { video: file } = videoNote;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateVideoNoteBlob(chatId, messageId, id),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_VIDEONOTE_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || videoNote);\n            }\n        }\n    );\n}\n\nfunction loadVideoNoteThumbnailContent(store, videoNote, message) {\n    if (!videoNote) return false;\n\n    const { thumbnail: photoSize } = videoNote;\n    if (!photoSize) return false;\n\n    let { photo: file } = photoSize;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return true;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateVideoNoteThumbnailBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message || videoNote)\n    );\n\n    return true;\n}\n\nfunction loadVoiceNoteContent(store, voiceNote, message, useFileSize = true) {\n    if (!voiceNote) return;\n\n    let { voice: file } = voiceNote;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateVoiceNoteBlob(chatId, messageId, id),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_VOICENOTE_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || voiceNote);\n            }\n        }\n    );\n}\n\nfunction loadMessageContents(store, messages) {\n    const users = new Map();\n    let chatId = 0;\n    const replies = new Map();\n\n    for (let i = messages.length - 1; i >= 0; i--) {\n        const message = messages[i];\n        if (!message) {\n            continue;\n        }\n\n        const { chat_id, content, sender_user_id, reply_to_message_id } = message;\n\n        if (sender_user_id) {\n            users.set(sender_user_id, sender_user_id);\n        }\n\n        if (reply_to_message_id) {\n            chatId = chat_id;\n            replies.set(reply_to_message_id, reply_to_message_id);\n        }\n\n        if (content) {\n            switch (content['@type']) {\n                case 'messageAnimation': {\n                    const { animation } = content;\n\n                    loadAnimationContent(store, animation, message);\n                    loadAnimationThumbnailContent(store, animation, message);\n                    break;\n                }\n                case 'messageAudio': {\n                    const { audio } = content;\n\n                    loadAudioContent(store, audio, message);\n                    loadAudioThumbnailContent(store, audio, message);\n                    break;\n                }\n                case 'messageChatChangePhoto': {\n                    const { photo } = content;\n\n                    loadPhotoContent(store, photo, message);\n                    break;\n                }\n                case 'messageContact': {\n                    const { contact } = content;\n\n                    loadContactContent(store, contact, message);\n                    break;\n                }\n                case 'messageDocument': {\n                    const { document } = content;\n\n                    loadDocumentContent(store, document, message);\n                    loadDocumentThumbnailContent(store, document, message);\n                    break;\n                }\n                case 'messageGame': {\n                    const { game } = content;\n\n                    loadGameContent(store, game, message);\n                    loadGameThumbnailContent(store, game, message);\n                    break;\n                }\n                case 'messageLocation': {\n                    const { location } = content;\n\n                    loadLocationContent(store, location, message);\n                    break;\n                }\n                case 'messageText': {\n                    const { web_page } = content;\n                    if (!web_page) {\n                        break;\n                    }\n\n                    const { animation, audio, document, photo, sticker, video, video_note, voice_note } = web_page;\n                    let loadPhoto = true;\n\n                    if (animation) {\n                        loadAnimationContent(store, animation, message);\n                        loadPhoto = !loadAnimationThumbnailContent(store, animation, message);\n                    }\n\n                    if (audio) {\n                        loadAudioContent(store, audio, message);\n                        loadPhoto = !loadAudioThumbnailContent(store, audio, message);\n                    }\n\n                    if (document) {\n                        loadDocumentContent(store, document, message);\n                        loadPhoto = !loadDocumentThumbnailContent(store, document, message);\n                    }\n\n                    if (sticker) {\n                        loadStickerContent(store, sticker, message);\n                        loadPhoto = !loadStickerThumbnailContent(store, sticker, message);\n                    }\n\n                    if (video) {\n                        // loadVideoContent(store, video, message); // start loading only on video click event\n                        loadPhoto = !loadVideoThumbnailContent(store, video, message);\n                    }\n\n                    if (video_note) {\n                        loadVideoNoteContent(store, video_note, message);\n                        loadPhoto = !loadVideoNoteThumbnailContent(store, video_note, message);\n                    }\n\n                    if (voice_note) {\n                        loadVoiceNoteContent(store, voice_note, message);\n                    }\n\n                    if (loadPhoto) {\n                        loadBigPhotoContent(store, photo, message);\n                        loadPhotoContent(store, photo, message);\n                        loadPhotoThumbnailContent(store, photo, message);\n                    }\n                    break;\n                }\n                case 'messagePhoto': {\n                    const { photo } = content;\n\n                    loadBigPhotoContent(store, photo, message);\n                    loadPhotoContent(store, photo, message);\n                    loadPhotoThumbnailContent(store, photo, message);\n                    break;\n                }\n                case 'messageSticker': {\n                    const { sticker } = content;\n\n                    loadStickerContent(store, sticker, message);\n                    loadStickerThumbnailContent(store, sticker, message);\n                    break;\n                }\n                case 'messageVenue': {\n                    const { venue } = content;\n                    const { location } = venue;\n\n                    loadLocationContent(store, location, message);\n                    break;\n                }\n                case 'messageVideo': {\n                    const { video } = content;\n\n                    // loadVideoContent(store, video, message); // start loading only on video click event\n                    loadVideoThumbnailContent(store, video, message);\n                    break;\n                }\n                case 'messageVideoNote': {\n                    const { video_note } = content;\n\n                    loadVideoNoteContent(store, video_note, message);\n                    loadVideoNoteThumbnailContent(store, video_note, message);\n                    break;\n                }\n                case 'messageVoiceNote': {\n                    const { voice_note } = content;\n\n                    loadVoiceNoteContent(store, voice_note, message);\n                    break;\n                }\n                default: {\n                    break;\n                }\n            }\n        }\n    }\n\n    loadUsersContent(store, [...users.keys()]);\n    loadReplies(store, chatId, [...replies.keys()]);\n}\n\nexport function saveMedia(media, message) {\n    if (!media) return;\n\n    switch (media['@type']) {\n        case 'animation': {\n            saveAnimation(media, message);\n            break;\n        }\n        case 'document': {\n            saveDocument(media, message);\n            break;\n        }\n        case 'photo': {\n            savePhoto(media, message);\n            break;\n        }\n        case 'video': {\n            saveVideo(media, message);\n            break;\n        }\n    }\n}\n\nfunction saveAnimation(animation, message) {\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    if (!animation) return;\n\n    const { animation: file, file_name } = animation;\n    if (!file) return;\n\n    const { id: fileId } = file;\n\n    saveOrDownload(file, file_name || fileId, message || animation, () =>\n        FileStore.updateAnimationBlob(chatId, messageId, fileId)\n    );\n}\n\nfunction saveDocument(document, message) {\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    if (!document) return;\n\n    const { document: file, file_name } = document;\n    if (!file) return;\n\n    const { id: fileId } = file;\n\n    saveOrDownload(file, file_name || fileId, message || document, () =>\n        FileStore.updateDocumentBlob(chatId, messageId, fileId)\n    );\n}\n\nfunction saveVideo(video, message) {\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    if (!video) return;\n\n    const { video: file, file_name } = video;\n    if (!file) return;\n\n    const { id: fileId } = file;\n\n    saveOrDownload(file, file_name || fileId, message || video, () =>\n        FileStore.updateVideoBlob(chatId, messageId, fileId)\n    );\n}\n\nfunction savePhoto(photo, message) {\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    if (!photo) return;\n\n    const photoSize = getSize(photo.sizes, PHOTO_BIG_SIZE);\n    if (!photoSize) return;\n\n    const { photo: file } = photoSize;\n    if (!file) return;\n\n    const { id: fileId } = file;\n\n    saveOrDownload(file, fileId + '.jpg', message || photo, () => FileStore.updatePhotoBlob(chatId, messageId, fileId));\n}\n\nfunction saveOrDownload(file, fileName, obj, callback) {\n    if (!file) return;\n    if (!fileName) return;\n\n    if (file.arr) {\n        saveData(file.arr, fileName);\n        return;\n    }\n\n    let blob = FileStore.getBlob(file.id) || file.blob;\n    if (blob) {\n        saveBlob(blob, fileName);\n        return;\n    }\n\n    download(file, obj, () => {\n        if (callback) callback();\n\n        blob = FileStore.getBlob(file.id) || file.blob;\n        if (blob) {\n            saveBlob(blob, fileName);\n        }\n    });\n}\n\nfunction download(file, obj, callback) {\n    if (!file) return;\n    const { id, local } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) {\n        return;\n    }\n\n    if (local.is_downloading_completed) {\n        const store = FileStore.getStore();\n\n        FileStore.getLocalFile(store, file, null, callback, () => {\n            if (local.can_be_downloaded) {\n                FileStore.getRemoteFile(file.id, FILE_PRIORITY, obj);\n            }\n        });\n        return;\n    }\n\n    if (local.can_be_downloaded) {\n        FileStore.getRemoteFile(id, FILE_PRIORITY, obj);\n    }\n}\n\nfunction getViewerThumbnail(media) {\n    if (!media) return [0, 0, null];\n\n    switch (media['@type']) {\n        case 'animation': {\n            const { thumbnail } = media;\n            if (thumbnail) {\n                return [thumbnail.width, thumbnail.height, thumbnail.photo];\n            }\n            break;\n        }\n        case 'document': {\n            const { thumbnail } = media;\n            if (thumbnail) {\n                return [thumbnail.width, thumbnail.height, thumbnail.photo];\n            }\n            break;\n        }\n        case 'photo': {\n            return getViewerFile(media, PHOTO_SIZE);\n        }\n        case 'video': {\n            const { thumbnail } = media;\n            if (thumbnail) {\n                return [thumbnail.width, thumbnail.height, thumbnail.photo];\n            }\n            break;\n        }\n        default: {\n            return [0, 0, null];\n        }\n    }\n\n    return [0, 0, null];\n}\n\nfunction getMediaPreviewFile(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return [0, 0, null];\n\n    const { content } = message;\n    if (!content) return [0, 0, null];\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            const { animation } = content;\n            if (animation && animation.thumbnail) {\n                return [animation.thumbnail.width, animation.thumbnail.height, animation.thumbnail.photo];\n            }\n            break;\n        }\n        case 'messageChatChangePhoto': {\n            return getMediaFile(chatId, messageId, PHOTO_SIZE);\n        }\n        case 'messageDocument': {\n            const { document } = content;\n            if (document) {\n                return [50, 50, document.document];\n            }\n            break;\n        }\n        case 'messagePhoto': {\n            return getMediaFile(chatId, messageId, PHOTO_SIZE);\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { animation, document, video, photo } = web_page;\n\n                if (animation && animation.thumbnail) {\n                    return [animation.thumbnail.width, animation.thumbnail.height, animation.thumbnail.photo];\n                }\n\n                if (document) {\n                    return [50, 50, document.document];\n                }\n\n                if (video && video.thumbnail) {\n                    return [video.thumbnail.width, video.thumbnail.height, video.thumbnail.photo];\n                }\n\n                if (photo) {\n                    return getMediaFile(chatId, messageId, PHOTO_SIZE);\n                }\n            }\n            break;\n        }\n        case 'messageVideo': {\n            const { video } = content;\n            if (video.thumbnail) {\n                return [video.thumbnail.width, video.thumbnail.height, video.thumbnail.photo];\n            }\n            break;\n        }\n        default: {\n            return [0, 0, null];\n        }\n    }\n\n    return [0, 0, null];\n}\n\nfunction getViewerFile(media, size) {\n    if (!size) return [0, 0, null];\n\n    switch (media['@type']) {\n        case 'animation': {\n            return [media.width, media.height, media.animation];\n        }\n        case 'photo': {\n            const photoSize = getSize(media.sizes, size);\n            if (photoSize) {\n                return [photoSize.width, photoSize.height, photoSize.photo];\n            }\n            break;\n        }\n        case 'document': {\n            return [50, 50, document.document];\n        }\n        case 'video': {\n            return [media.width, media.height, media.video];\n        }\n        default: {\n        }\n    }\n\n    return [0, 0, null];\n}\n\nfunction getMediaFile(chatId, messageId, size) {\n    if (!size) return [0, 0, null];\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return [0, 0, null];\n\n    const { content } = message;\n    if (!content) return [0, 0, null];\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            const { animation } = content;\n            if (animation) {\n                return [animation.width, animation.height, animation.animation];\n            }\n            break;\n        }\n        case 'messageChatChangePhoto': {\n            const { photo } = content;\n            if (photo) {\n                const photoSize = getSize(photo.sizes, size);\n                if (photoSize) {\n                    return [photoSize.width, photoSize.height, photoSize.photo];\n                }\n            }\n            break;\n        }\n        case 'messageDocument': {\n            const { document } = content;\n            if (document) {\n                return [50, 50, document.document];\n            }\n            break;\n        }\n        case 'messagePhoto': {\n            const { photo } = content;\n            if (photo) {\n                const photoSize = getSize(photo.sizes, size);\n                if (photoSize) {\n                    return [photoSize.width, photoSize.height, photoSize.photo];\n                }\n            }\n            break;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { animation, document, photo, video } = web_page;\n                if (animation) {\n                    return [animation.width, animation.height, animation.animation];\n                }\n\n                if (document) {\n                    return [50, 50, document.document];\n                }\n\n                if (photo) {\n                    const photoSize = getSize(photo.sizes, size);\n                    if (photoSize) {\n                        return [photoSize.width, photoSize.height, photoSize.photo];\n                    }\n                    break;\n                }\n\n                if (video) {\n                    return [video.width, video.height, video.video];\n                }\n            }\n            break;\n        }\n        case 'messageVideo': {\n            const { video } = content;\n            if (video) {\n                return [video.width, video.height, video.video];\n            }\n            break;\n        }\n        default: {\n        }\n    }\n\n    return [0, 0, null];\n}\n\nfunction cancelLoadMediaViewerContent(messages) {\n    if (!messages) return;\n    if (!messages.length) return;\n\n    for (let i = 0; i < messages.length; i++) {\n        let message = messages[i];\n        const { content } = message;\n        if (content) {\n            switch (content['@type']) {\n                case 'messagePhoto': {\n                    const { photo } = content;\n                    if (!photo) break;\n\n                    // preview\n                    /*let [previewId, previewPid, previewIdbKey] = getPhotoPreviewFile(message);\n                    if (previewPid) {\n                        let preview = this.getPreviewPhotoSize(message.content.photo.sizes);\n                        if (!preview.blob){\n                            FileStore.getLocalFile(store, preview, null,\n                                () => MessageStore.updateMessagePhoto(message.id),\n                                () => { if (loadRemote)  FileStore.getRemoteFile(previewId, 2, message); },\n                                'load_contents_preview_',\n                                message.id);\n\n                        }\n                    }*/\n\n                    const photoSize = getSize(photo.sizes, PHOTO_BIG_SIZE);\n                    if (!photoSize) break;\n\n                    const { photo: file } = photoSize;\n                    const blob = file.blob || FileStore.getBlob(file.id);\n                    if (blob) return;\n\n                    FileStore.cancelGetRemoteFile(file.id);\n                    break;\n                }\n                case 'messageVideo': {\n                    const { video } = content;\n                    if (!video) break;\n\n                    if (video.thumbnail) {\n                        const { photo: file } = video.thumbnail;\n                        const blob = file.blob || FileStore.getBlob(file.id);\n                        if (blob) break;\n\n                        FileStore.cancelGetRemoteFile(file.id);\n                    }\n\n                    const { video: file } = video;\n                    if (!file) break;\n\n                    const blob = file.blob || FileStore.getBlob(file.id);\n                    if (blob) break;\n\n                    FileStore.cancelGetRemoteFile(file.id);\n                    break;\n                }\n                case 'messageText': {\n                    const { web_page } = message.content;\n                    if (web_page) {\n                        const { video } = web_page;\n\n                        if (video) {\n                            if (video.thumbnail) {\n                                const { photo: file } = video.thumbnail;\n                                const blob = file.blob || FileStore.getBlob(file.id);\n                                if (blob) break;\n\n                                FileStore.cancelGetRemoteFile(file.id);\n                            }\n\n                            const { video: file } = video;\n                            if (!file) break;\n\n                            const blob = file.blob || FileStore.getBlob(file.id);\n                            if (blob) break;\n\n                            FileStore.cancelGetRemoteFile(file.id);\n                        }\n                    }\n\n                    break;\n                }\n            }\n        }\n    }\n}\n\nfunction loadMediaViewerContent(messages, useSizeLimit = false) {\n    if (!messages) return;\n    if (!messages.length) return;\n\n    const store = FileStore.getStore();\n\n    for (let i = 0; i < messages.length; i++) {\n        let message = messages[i];\n        const { content } = message;\n        if (content) {\n            switch (content['@type']) {\n                case 'messageAnimation': {\n                    const { animation } = content;\n\n                    loadAnimationContent(store, animation, message, useSizeLimit);\n                    loadAnimationThumbnailContent(store, animation, message);\n                    break;\n                }\n                case 'messageChatChangePhoto': {\n                    const { photo } = content;\n\n                    loadBigPhotoContent(store, photo, message);\n                    break;\n                }\n                case 'messageDocument': {\n                    const { document } = content;\n\n                    loadDocumentContent(store, document, message, useSizeLimit);\n                    break;\n                }\n                case 'messagePhoto': {\n                    const { photo } = content;\n\n                    loadBigPhotoContent(store, photo, message);\n                    break;\n                }\n                case 'messageText': {\n                    const { web_page } = message.content;\n                    if (!web_page) {\n                        break;\n                    }\n\n                    const { animation, document, photo, video } = web_page;\n                    let loadPhoto = true;\n\n                    if (animation) {\n                        loadAnimationContent(store, animation, message, useSizeLimit);\n                        loadPhoto = !loadAnimationThumbnailContent(store, animation, message);\n                    }\n\n                    if (document) {\n                        loadDocumentContent(store, document, message, useSizeLimit);\n                        loadPhoto = false;\n                    }\n\n                    if (video) {\n                        loadVideoContent(store, video, message, useSizeLimit);\n                        loadPhoto = !loadVideoThumbnailContent(store, video, message);\n                    }\n\n                    if (loadPhoto) {\n                        loadBigPhotoContent(store, photo, message);\n                    }\n\n                    break;\n                }\n                case 'messageVideo': {\n                    const { video } = content;\n\n                    loadVideoThumbnailContent(store, video, message);\n                    loadVideoContent(store, video, message, useSizeLimit);\n                    break;\n                }\n            }\n        }\n    }\n}\n\nfunction cancelPreloadMediaViewerContent(index, history) {\n    if (!history.length) return;\n\n    const messages = [];\n    if (index > 0) {\n        messages.push(history[index - 1]);\n    }\n    if (index < history.length - 1) {\n        messages.push(history[index + 1]);\n    }\n\n    cancelLoadMediaViewerContent([history[index]]);\n    cancelLoadMediaViewerContent(messages);\n}\n\nfunction preloadMediaViewerContent(index, history) {\n    if (!history.length) return;\n\n    const messages = [];\n    if (index > 0) {\n        messages.push(history[index - 1]);\n    }\n    if (index < history.length - 1) {\n        messages.push(history[index + 1]);\n    }\n\n    loadMediaViewerContent([history[index]], false);\n    loadMediaViewerContent(messages, true);\n}\n\nfunction loadUserFileContent(store, file, userId) {\n    if (!file) return;\n\n    const { id } = file;\n    file = FileStore.get(id) || file;\n\n    const user = UserStore.get(userId);\n    if (!user) return;\n\n    const blob = file.blob || FileStore.getBlob(id);\n    if (blob) return;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateUserPhotoBlob(userId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, user)\n    );\n}\n\nfunction loadChatFileContent(store, file, chatId) {\n    if (!file) return;\n\n    const { id } = file;\n    file = FileStore.get(id) || file;\n\n    const chat = ChatStore.get(chatId);\n    if (!chat) return;\n\n    const blob = file.blob || FileStore.getBlob(id);\n    if (blob) return;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateChatPhotoBlob(chatId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, chat)\n    );\n}\n\nfunction loadProfileMediaViewerContent(chatId, photos) {\n    if (!photos) return;\n\n    const store = FileStore.getStore();\n\n    photos.forEach(photo => {\n        switch (photo['@type']) {\n            case 'chatPhoto': {\n                const { small, big } = photo;\n\n                loadChatFileContent(store, small, chatId);\n                loadChatFileContent(store, big, chatId);\n                break;\n            }\n            case 'profilePhoto': {\n                const userId = getChatUserId(chatId);\n\n                const { small, big } = photo;\n\n                loadUserFileContent(store, small, userId);\n                loadUserFileContent(store, big, userId);\n                break;\n            }\n            case 'userProfilePhoto': {\n                photo = getProfilePhoto(photo);\n                if (!photo) break;\n\n                const userId = getChatUserId(chatId);\n\n                const { small, big } = photo;\n\n                loadUserFileContent(store, small, userId);\n                loadUserFileContent(store, big, userId);\n                break;\n            }\n        }\n    });\n}\n\nfunction preloadProfileMediaViewerContent(chatId, index, history) {\n    if (!history.length) return;\n\n    const items = [];\n    if (index > 0) {\n        items.push(history[index - 1]);\n    }\n    if (index < history.length - 1) {\n        items.push(history[index + 1]);\n    }\n    if (index >= 0 && index < history.length) {\n        items.push(history[index]);\n    }\n\n    loadProfileMediaViewerContent(chatId, items);\n}\n\nfunction loadUserContent(store, userId) {\n    const user = UserStore.get(userId);\n    if (!user) return;\n\n    const { profile_photo } = user;\n    if (!profile_photo) return;\n\n    const { small: file } = profile_photo;\n\n    loadUserFileContent(store, file, userId);\n}\n\nfunction loadUsersContent(store, ids) {\n    if (!ids) return;\n\n    ids.forEach(id => loadUserContent(store, id));\n}\n\nfunction loadChatContent(store, chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return;\n\n    const { photo } = chat;\n    loadChatPhotoContent(store, photo, chat.id);\n}\n\nfunction loadChatPhotoContent(store, photo, chatId) {\n    if (!photo) return;\n\n    const { small: file } = photo;\n\n    loadChatFileContent(store, file, chatId);\n}\n\nfunction loadChatsContent(store, ids) {\n    if (!ids) return;\n\n    ids.forEach(id => loadChatContent(store, id));\n}\n\nfunction loadDraftContent(store, chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return;\n\n    const { draft_message } = chat;\n    if (!draft_message) return;\n\n    const { reply_to_message_id } = draft_message;\n    if (!reply_to_message_id) return;\n\n    loadReplies(store, chatId, [reply_to_message_id]);\n}\n\nfunction loadStickerSetContent(store, stickerSet) {\n    console.log('Lottie.loadStickerSetContent');\n    if (!stickerSet) return;\n\n    const { stickers } = stickerSet;\n    loadStickersContent(store, stickers);\n}\n\nfunction loadStickersContent(store, stickers) {\n    if (!stickers) return;\n\n    stickers.forEach(sticker => {\n        console.log('Lottie.loadStickerThumbnailContent', sticker.sticker.id);\n        loadStickerThumbnailContent(store, sticker, null);\n        if (sticker.is_animated) {\n            console.log('Lottie.loadStickerContent', sticker.sticker.id);\n            loadStickerContent(store, sticker, null);\n        }\n    });\n}\n\nfunction isGifMimeType(mimeType) {\n    return mimeType && mimeType.toLowerCase() === 'image/gif';\n}\n\nfunction getSrc(file) {\n    const blob = getBlob(file);\n\n    return FileStore.getBlobUrl(blob) || '';\n}\n\nfunction getBlob(file) {\n    return file ? FileStore.getBlob(file.id) || file.blob : null;\n}\n\nfunction getDownloadedSize(file) {\n    if (!file) return '0';\n    if (!file.local) return '0';\n    if (!file.local.is_downloading_active) return '0';\n\n    return getSizeString(file.local.downloaded_size);\n}\n\nfunction getUploadedSize(file) {\n    if (!file) return '0';\n    if (!file.remote) return '0';\n    if (!file.remote.is_uploading_active) return '0';\n\n    return getSizeString(file.remote.uploaded_size);\n}\n\nfunction getExtension(fileName) {\n    if (!fileName) {\n        return '';\n    }\n\n    const parts = fileName.split('.');\n    if (parts.length === 1 || (parts[0] === '' && parts.length === 2)) {\n        return '';\n    }\n    return parts.pop().toLowerCase();\n}\n\nfunction loadInstantViewContent(instantView) {\n    if (!instantView) return;\n\n    const { page_blocks } = instantView;\n    if (!page_blocks) return;\n\n    const store = FileStore.getStore();\n\n    page_blocks.forEach(pageBlock => loadPageBlockContent(store, pageBlock));\n}\n\nfunction loadPageBlockContent(store, b) {\n    if (!b) return;\n\n    switch (b['@type']) {\n        case 'pageBlockAnchor': {\n            break;\n        }\n        case 'pageBlockAnimation': {\n            const { animation, caption } = b;\n\n            loadAnimationThumbnailContent(store, animation, null);\n            loadAnimationContent(store, animation, null);\n            loadPageBlockContent(store, caption);\n            break;\n        }\n        case 'pageBlockAudio': {\n            const { audio, caption } = b;\n\n            loadAudioThumbnailContent(store, audio, null);\n            loadAudioContent(store, audio, null);\n            loadPageBlockContent(store, caption);\n            break;\n        }\n        case 'pageBlockAuthorDate': {\n            const { author } = b;\n\n            loadRichTextContent(store, author);\n            break;\n        }\n        case 'pageBlockBlockQuote': {\n            const { text, credit } = b;\n\n            loadRichTextContent(store, text);\n            loadRichTextContent(store, credit);\n            break;\n        }\n        // actually not a pageBlock child but load content in the same way\n        case 'pageBlockCaption': {\n            const { text, credit } = b;\n\n            loadRichTextContent(store, text);\n            loadRichTextContent(store, credit);\n            break;\n        }\n        case 'pageBlockChatLink': {\n            const { photo } = b;\n\n            loadChatPhotoContent(store, photo, 0);\n            break;\n        }\n        case 'pageBlockCollage': {\n            const { page_blocks, caption } = b;\n\n            loadPageBlockContent(store, caption);\n            page_blocks.forEach(x => loadPageBlockContent(store, x));\n            break;\n        }\n        case 'pageBlockCover': {\n            const { cover } = b;\n\n            loadPageBlockContent(store, cover);\n            break;\n        }\n        case 'pageBlockDetails': {\n            const { header, page_blocks } = b;\n\n            loadPageBlockContent(store, header);\n            page_blocks.forEach(x => loadPageBlockContent(store, x));\n            break;\n        }\n        case 'pageBlockDivider': {\n            break;\n        }\n        case 'pageBlockEmbedded': {\n            const { poster_photo, caption } = b;\n\n            loadPhotoContent(store, poster_photo, null);\n            loadPageBlockContent(store, caption);\n            break;\n        }\n        case 'pageBlockEmbeddedPost': {\n            const { author_photo, page_blocks, caption } = b;\n\n            loadPhotoContent(store, author_photo, null);\n            page_blocks.forEach(x => loadPageBlockContent(store, x));\n            loadPageBlockContent(store, caption);\n            break;\n        }\n        case 'pageBlockFooter': {\n            const { footer } = b;\n\n            loadRichTextContent(store, footer);\n            break;\n        }\n        case 'pageBlockHeader': {\n            const { header } = b;\n\n            loadRichTextContent(store, header);\n            break;\n        }\n        case 'pageBlockKicker': {\n            const { kicker } = b;\n\n            loadRichTextContent(store, kicker);\n            break;\n        }\n        case 'pageBlockList': {\n            const { items } = b;\n\n            items.forEach(x => loadPageBlockContent(store, x));\n            break;\n        }\n        // actually not a pageBlock child but load content in the same way\n        case 'pageBlockListItem': {\n            const { page_blocks } = b;\n\n            page_blocks.forEach(x => loadPageBlockContent(store, x));\n            break;\n        }\n        case 'pageBlockMap': {\n            const { caption } = b;\n\n            loadPageBlockMapContent(store, b, null);\n            loadPageBlockContent(store, caption);\n            break;\n        }\n        case 'pageBlockParagraph': {\n            const { text } = b;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'pageBlockPhoto': {\n            const { photo, caption } = b;\n\n            loadPhotoContent(store, photo, null, IV_PHOTO_SIZE);\n            loadPageBlockContent(store, caption);\n            break;\n        }\n        case 'pageBlockPreformatted': {\n            const { text } = b;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'pageBlockPullQuote': {\n            const { text, credit } = b;\n\n            loadRichTextContent(store, text);\n            loadRichTextContent(store, credit);\n            break;\n        }\n        case 'pageBlockRelatedArticles': {\n            const { header, articles } = b;\n\n            loadRichTextContent(store, header);\n            articles.forEach(x => loadPageBlockContent(store, x));\n            break;\n        }\n        // actually not a pageBlock child but load content in the same way\n        case 'pageBlockRelatedArticle': {\n            const { photo } = b;\n\n            loadPhotoContent(store, photo, null);\n            break;\n        }\n        case 'pageBlockSlideshow': {\n            const { page_blocks, caption } = b;\n\n            loadPageBlockContent(store, caption);\n            page_blocks.forEach(x => loadPageBlockContent(store, x));\n            break;\n        }\n        case 'pageBlockSubheader': {\n            const { subheader } = b;\n\n            loadRichTextContent(store, subheader);\n            break;\n        }\n        case 'pageBlockSubtitle': {\n            const { subtitle } = b;\n\n            loadRichTextContent(store, subtitle);\n            break;\n        }\n        case 'pageBlockTable': {\n            const { caption, cells } = b;\n\n            loadRichTextContent(store, caption);\n            cells.forEach(row => row.forEach(x => loadPageBlockContent(store, x)));\n            break;\n        }\n        // actually not a pageBlock child but load content in the same way\n        case 'pageBlockTableCell': {\n            const { text } = b;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'pageBlockTitle': {\n            const { title } = b;\n\n            loadRichTextContent(store, title);\n            break;\n        }\n        case 'pageBlockVideo': {\n            const { video, caption } = b;\n\n            loadVideoThumbnailContent(store, video, null);\n            loadVideoContent(store, video, null);\n            loadPageBlockContent(store, caption);\n            break;\n        }\n    }\n}\n\nfunction loadRichTextContent(store, t) {\n    if (!t) return;\n\n    switch (t['@type']) {\n        case 'richTextAnchor': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextBold': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextEmailAddress': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextFixed': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextIcon': {\n            const { document } = t;\n\n            loadDocumentThumbnailContent(store, document, null);\n            loadDocumentContent(store, document, null, false);\n            break;\n        }\n        case 'richTextItalic': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextMarked': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextPhoneNumber': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextPlain': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTexts': {\n            const { texts } = t;\n\n            texts.forEach(x => loadRichTextContent(store, x));\n            break;\n        }\n        case 'richTextStrikethrough': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextSubscript': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextSuperscript': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextUnderline': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextUrl': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n    }\n}\n\nfunction getAnimationData(file) {\n    return new Promise(resolve => {\n        if (!file) {\n            resolve(null);\n            return;\n        }\n\n        const blob = FileStore.getBlob(file.id);\n        if (!blob) {\n            resolve(null);\n            return;\n        }\n\n        const fileReader = new FileReader();\n        fileReader.onload = event => resolve(JSON.parse(event.target.result));\n        fileReader.onerror = () => resolve(null);\n        fileReader.onabort = () => resolve(null);\n        fileReader.readAsText(blob);\n    });\n}\n\nexport {\n    getFileSize,\n    getSizeString,\n    saveData,\n    saveBlob,\n    loadMessageContents,\n    loadMediaViewerContent,\n    preloadMediaViewerContent,\n    cancelLoadMediaViewerContent,\n    cancelPreloadMediaViewerContent,\n    loadProfileMediaViewerContent,\n    preloadProfileMediaViewerContent,\n    loadChatContent,\n    loadChatsContent,\n    loadDraftContent,\n    loadInstantViewContent,\n    loadStickerContent,\n    loadStickersContent,\n    loadStickerSetContent,\n    loadStickerThumbnailContent,\n    loadUserContent,\n    loadUsersContent,\n    saveOrDownload,\n    download,\n    getMediaFile,\n    getMediaPreviewFile,\n    isGifMimeType,\n    getSrc,\n    getBlob,\n    getDownloadedSize,\n    getUploadedSize,\n    getExtension,\n    getViewerFile,\n    getViewerThumbnail,\n    getAnimationData\n};\n"]},"metadata":{},"sourceType":"module"}