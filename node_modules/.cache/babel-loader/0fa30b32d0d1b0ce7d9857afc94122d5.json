{"ast":null,"code":"/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport { loadInstantViewContent } from '../Utils/File';\nimport { setInstantViewContent } from './Client';\nimport TdLibController from '../Controllers/TdLibController';\nlet timestamp = null;\nexport async function openInstantView(url) {\n  try {\n    const now = timestamp = new Date();\n    const result = await TdLibController.send({\n      '@type': 'getWebPageInstantView',\n      url,\n      force_full: true\n    });\n    if (timestamp !== now) return;\n    console.log('[IV] open', result);\n    loadInstantViewContent(result);\n    setInstantViewContent({\n      instantView: result\n    });\n  } catch {\n    const newWindow = window.open();\n    newWindow.opener = null;\n    newWindow.location = url;\n  }\n}","map":{"version":3,"sources":["/home/chilly/Projects/Capacitor/telegram-app/src/Actions/InstantView.js"],"names":["loadInstantViewContent","setInstantViewContent","TdLibController","timestamp","openInstantView","url","now","Date","result","send","force_full","console","log","instantView","newWindow","window","open","opener","location"],"mappings":"AAAA;;;;;;AAOA,SAASA,sBAAT,QAAuC,eAAvC;AACA,SAASC,qBAAT,QAAsC,UAAtC;AACA,OAAOC,eAAP,MAA4B,gCAA5B;AAEA,IAAIC,SAAS,GAAG,IAAhB;AAEA,OAAO,eAAeC,eAAf,CAA+BC,GAA/B,EAAoC;AACvC,MAAI;AACA,UAAMC,GAAG,GAAIH,SAAS,GAAG,IAAII,IAAJ,EAAzB;AACA,UAAMC,MAAM,GAAG,MAAMN,eAAe,CAACO,IAAhB,CAAqB;AACtC,eAAS,uBAD6B;AAEtCJ,MAAAA,GAFsC;AAGtCK,MAAAA,UAAU,EAAE;AAH0B,KAArB,CAArB;AAKA,QAAIP,SAAS,KAAKG,GAAlB,EAAuB;AAEvBK,IAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBJ,MAAzB;AACAR,IAAAA,sBAAsB,CAACQ,MAAD,CAAtB;AACAP,IAAAA,qBAAqB,CAAC;AAAEY,MAAAA,WAAW,EAAEL;AAAf,KAAD,CAArB;AACH,GAZD,CAYE,MAAM;AACJ,UAAMM,SAAS,GAAGC,MAAM,CAACC,IAAP,EAAlB;AACAF,IAAAA,SAAS,CAACG,MAAV,GAAmB,IAAnB;AACAH,IAAAA,SAAS,CAACI,QAAV,GAAqBb,GAArB;AACH;AACJ","sourcesContent":["/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { loadInstantViewContent } from '../Utils/File';\nimport { setInstantViewContent } from './Client';\nimport TdLibController from '../Controllers/TdLibController';\n\nlet timestamp = null;\n\nexport async function openInstantView(url) {\n    try {\n        const now = (timestamp = new Date());\n        const result = await TdLibController.send({\n            '@type': 'getWebPageInstantView',\n            url,\n            force_full: true\n        });\n        if (timestamp !== now) return;\n\n        console.log('[IV] open', result);\n        loadInstantViewContent(result);\n        setInstantViewContent({ instantView: result });\n    } catch {\n        const newWindow = window.open();\n        newWindow.opener = null;\n        newWindow.location = url;\n    }\n}\n"]},"metadata":{},"sourceType":"module"}