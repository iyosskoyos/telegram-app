{"ast":null,"code":"import _defineProperty from\"/home/me-admin/Downloads/my-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/home/me-admin/Downloads/my-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/me-admin/Downloads/my-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/me-admin/Downloads/my-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/me-admin/Downloads/my-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/me-admin/Downloads/my-app/node_modules/@babel/runtime/helpers/esm/inherits\";/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */import React,{Component}from'react';import classNames from'classnames';import{compose}from'recompose';import{withTranslation}from'react-i18next';import withStyles from'@material-ui/core/styles/withStyles';import CheckMarkIcon from'@material-ui/icons/Check';import Reply from'./Reply';import Forward from'./Forward';import Meta from'./Meta';import MessageStatus from'./MessageStatus';import MessageAuthor from'./MessageAuthor';import UserTile from'../Tile/UserTile';import ChatTile from'../Tile/ChatTile';import UnreadSeparator from'./UnreadSeparator';import WebPage from'./Media/WebPage';import{getEmojiMatches,getText,getMedia,getUnread,getWebPage,openMedia}from'../../Utils/Message';import{canSendMessages}from'../../Utils/Chat';import{openUser,openChat,selectMessage,openReply}from'../../Actions/Client';import MessageStore from'../../Stores/MessageStore';import TdLibController from'../../Controllers/TdLibController';import'./Message.css';var styles=function styles(theme){return{message:{backgroundColor:'transparent'},messageAuthorColor:{color:theme.palette.primary.main},messageSelected:{backgroundColor:theme.palette.primary.main+'22'},messageSelectTick:{background:theme.palette.primary.main,color:'white'},'@keyframes highlighted':{from:{backgroundColor:theme.palette.primary.main+'22'},to:{backgroundColor:'transparent'}},messageHighlighted:{animation:'highlighted 4s ease-out'}};};var Message=/*#__PURE__*/function(_Component){_inherits(Message,_Component);function Message(props){var _this;_classCallCheck(this,Message);_this=_possibleConstructorReturn(this,_getPrototypeOf(Message).call(this,props));_this.onClientUpdateClearSelection=function(update){if(!_this.state.selected)return;_this.setState({selected:false});};_this.onClientUpdateMessageHighlighted=function(update){var _this$props=_this.props,chatId=_this$props.chatId,messageId=_this$props.messageId;var _this$state=_this.state,selected=_this$state.selected,highlighted=_this$state.highlighted;if(selected)return;if(chatId===update.chatId&&messageId===update.messageId){if(highlighted){_this.setState({highlighted:false},function(){setTimeout(function(){_this.setState({highlighted:true});},0);});}else{_this.setState({highlighted:true});}}else if(highlighted){_this.setState({highlighted:false});}};_this.onClientUpdateMessageSelected=function(update){var _this$props2=_this.props,chatId=_this$props2.chatId,messageId=_this$props2.messageId;var selected=update.selected;if(chatId===update.chatId&&messageId===update.messageId){_this.setState({selected:selected,highlighted:false});}};_this.onUpdateMessageEdited=function(update){var chat_id=update.chat_id,message_id=update.message_id;var _this$props3=_this.props,chatId=_this$props3.chatId,messageId=_this$props3.messageId;if(chatId===chat_id&&messageId===message_id){_this.forceUpdate();}};_this.onUpdateMessageViews=function(update){var chat_id=update.chat_id,message_id=update.message_id;var _this$props4=_this.props,chatId=_this$props4.chatId,messageId=_this$props4.messageId;if(chatId===chat_id&&messageId===message_id){_this.forceUpdate();}};_this.onUpdateMessageContent=function(update){var chat_id=update.chat_id,message_id=update.message_id;var _this$props5=_this.props,chatId=_this$props5.chatId,messageId=_this$props5.messageId;var emojiMatches=_this.state.emojiMatches;if(chatId!==chat_id)return;if(messageId!==message_id)return;var newEmojiMatches=getEmojiMatches(chatId,messageId);if(newEmojiMatches!==emojiMatches){_this.setState({emojiMatches:getEmojiMatches(chatId,messageId)});}else{_this.forceUpdate();}};_this.handleSelectUser=function(userId){openUser(userId,true);};_this.handleSelectChat=function(chatId){openChat(chatId,null,true);};_this.handleSelection=function(){if(!_this.mouseDown)return;var selection=window.getSelection().toString();if(selection)return;var _this$props6=_this.props,chatId=_this$props6.chatId,messageId=_this$props6.messageId;var selected=!MessageStore.selectedItems.has(\"chatId=\".concat(chatId,\"_messageId=\").concat(messageId));selectMessage(chatId,messageId,selected);};_this.handleDateClick=function(e){e.preventDefault();e.stopPropagation();var _this$props7=_this.props,chatId=_this$props7.chatId,messageId=_this$props7.messageId;var message=MessageStore.get(chatId,messageId);var canBeReplied=canSendMessages(chatId);if(canBeReplied){TdLibController.clientUpdate({'@type':'clientUpdateReply',chatId:chatId,messageId:messageId});return;}var canBeForwarded=message&&message.can_be_forwarded;if(canBeForwarded){TdLibController.clientUpdate({'@type':'clientUpdateForward',info:{chatId:chatId,messageIds:[messageId]}});}};_this.openMedia=function(event){if(event){event.preventDefault();event.stopPropagation();}var _this$props8=_this.props,chatId=_this$props8.chatId,messageId=_this$props8.messageId;openMedia(chatId,messageId);};_this.handleAnimationEnd=function(){_this.setState({highlighted:false});};_this.handleMouseDown=function(){_this.mouseDown=true;};_this.handleMouseOver=function(){_this.mouseDown=false;};_this.handleMouseOut=function(){_this.mouseOut=false;};_this.handleReplyClick=function(){var _this$props9=_this.props,chatId=_this$props9.chatId,messageId=_this$props9.messageId;openReply(chatId,messageId);};var _this$props10=_this.props,_chatId=_this$props10.chatId,_messageId=_this$props10.messageId;if(process.env.NODE_ENV!=='production'){_this.state={message:MessageStore.get(_chatId,_messageId),emojiMatches:getEmojiMatches(_chatId,_messageId),selected:false,highlighted:false};}else{_this.state={emojiMatches:getEmojiMatches(_chatId,_messageId),selected:false,highlighted:false};}return _this;}_createClass(Message,[{key:\"shouldComponentUpdate\",value:function shouldComponentUpdate(nextProps,nextState){var _this$props11=this.props,theme=_this$props11.theme,chatId=_this$props11.chatId,messageId=_this$props11.messageId,sendingState=_this$props11.sendingState,showUnreadSeparator=_this$props11.showUnreadSeparator,showTitle=_this$props11.showTitle;var _this$state2=this.state,contextMenu=_this$state2.contextMenu,selected=_this$state2.selected,highlighted=_this$state2.highlighted,emojiMatches=_this$state2.emojiMatches;if(nextProps.theme!==theme){console.log('Message.shouldComponentUpdate true');return true;}if(nextProps.chatId!==chatId){console.log('Message.shouldComponentUpdate true');return true;}if(nextProps.messageId!==messageId){console.log('Message.shouldComponentUpdate true');return true;}if(nextProps.sendingState!==sendingState){console.log('Message.shouldComponentUpdate true');return true;}if(nextProps.showUnreadSeparator!==showUnreadSeparator){console.log('Message.shouldComponentUpdate true');return true;}if(nextProps.showTitle!==showTitle){console.log('Message.shouldComponentUpdate true');return true;}if(nextState.contextMenu!==contextMenu){console.log('Message.shouldComponentUpdate true');return true;}if(nextState.selected!==selected){console.log('Message.shouldComponentUpdate true');return true;}if(nextState.highlighted!==highlighted){console.log('Message.shouldComponentUpdate true');return true;}if(nextState.emojiMatches!==emojiMatches){console.log('Message.shouldComponentUpdate true');return true;}// console.log('Message.shouldComponentUpdate false');\nreturn false;}},{key:\"componentDidMount\",value:function componentDidMount(){MessageStore.on('clientUpdateMessageHighlighted',this.onClientUpdateMessageHighlighted);MessageStore.on('clientUpdateMessageSelected',this.onClientUpdateMessageSelected);MessageStore.on('clientUpdateClearSelection',this.onClientUpdateClearSelection);MessageStore.on('updateMessageContent',this.onUpdateMessageContent);MessageStore.on('updateMessageEdited',this.onUpdateMessageEdited);MessageStore.on('updateMessageViews',this.onUpdateMessageViews);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){MessageStore.removeListener('clientUpdateMessageHighlighted',this.onClientUpdateMessageHighlighted);MessageStore.removeListener('clientUpdateMessageSelected',this.onClientUpdateMessageSelected);MessageStore.removeListener('clientUpdateClearSelection',this.onClientUpdateClearSelection);MessageStore.removeListener('updateMessageContent',this.onUpdateMessageContent);MessageStore.removeListener('updateMessageEdited',this.onUpdateMessageEdited);MessageStore.removeListener('updateMessageViews',this.onUpdateMessageViews);}},{key:\"render\",value:function render(){var _classNames;var _this$props12=this.props,t=_this$props12.t,classes=_this$props12.classes,chatId=_this$props12.chatId,messageId=_this$props12.messageId,showUnreadSeparator=_this$props12.showUnreadSeparator,showTitle=_this$props12.showTitle;var _this$state3=this.state,emojiMatches=_this$state3.emojiMatches,selected=_this$state3.selected,highlighted=_this$state3.highlighted;var message=MessageStore.get(chatId,messageId);if(!message)return React.createElement(\"div\",null,\"[empty message]\");var sending_state=message.sending_state,views=message.views,date=message.date,edit_date=message.edit_date,reply_to_message_id=message.reply_to_message_id,forward_info=message.forward_info,sender_user_id=message.sender_user_id;var text=getText(message);var webPage=getWebPage(message);var media=getMedia(message,this.openMedia);this.unread=getUnread(message);var tile=null;if(showTitle){tile=sender_user_id?React.createElement(UserTile,{userId:sender_user_id,onSelect:this.handleSelectUser}):React.createElement(ChatTile,{chatId:chatId,onSelect:this.handleSelectChat});}var messageClassName=classNames('message',classes.message,(_classNames={'message-selected':selected},_defineProperty(_classNames,classes.messageSelected,selected),_defineProperty(_classNames,classes.messageHighlighted,highlighted&&!selected),_defineProperty(_classNames,'message-short',!showTitle),_classNames));var meta=React.createElement(Meta,{date:date,editDate:edit_date,views:views,onDateClick:this.handleDateClick});return React.createElement(\"div\",{className:messageClassName,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onMouseDown:this.handleMouseDown,onClick:this.handleSelection,onAnimationEnd:this.handleAnimationEnd},showUnreadSeparator&&React.createElement(UnreadSeparator,null),React.createElement(\"div\",{className:\"message-wrapper\"},React.createElement(\"div\",{className:\"message-left-padding\"},React.createElement(CheckMarkIcon,{className:classNames('message-select-tick',classes.messageSelectTick)}),this.unread&&React.createElement(MessageStatus,{chatId:chatId,messageId:messageId,sendingState:sending_state})),tile,React.createElement(\"div\",{className:\"message-content\"},React.createElement(\"div\",{className:\"message-title\"},showTitle&&!forward_info&&React.createElement(MessageAuthor,{chatId:chatId,openChat:true,userId:sender_user_id,openUser:true}),forward_info&&React.createElement(Forward,{forwardInfo:forward_info}),showTitle&&meta),Boolean(reply_to_message_id)&&React.createElement(Reply,{chatId:chatId,messageId:reply_to_message_id,onClick:this.handleReplyClick}),media,React.createElement(\"div\",{className:classNames('message-text',{'message-text-1emoji':emojiMatches===1,'message-text-2emoji':emojiMatches===2,'message-text-3emoji':emojiMatches===3})},text),webPage&&React.createElement(WebPage,{chatId:chatId,messageId:messageId,openMedia:this.openMedia})),!showTitle&&meta));}}]);return Message;}(Component);var enhance=compose(withStyles(styles,{withTheme:true}),withTranslation());export default enhance(Message);","map":{"version":3,"sources":["/home/me-admin/Downloads/my-app/src/Components/Message/Message.js"],"names":["React","Component","classNames","compose","withTranslation","withStyles","CheckMarkIcon","Reply","Forward","Meta","MessageStatus","MessageAuthor","UserTile","ChatTile","UnreadSeparator","WebPage","getEmojiMatches","getText","getMedia","getUnread","getWebPage","openMedia","canSendMessages","openUser","openChat","selectMessage","openReply","MessageStore","TdLibController","styles","theme","message","backgroundColor","messageAuthorColor","color","palette","primary","main","messageSelected","messageSelectTick","background","from","to","messageHighlighted","animation","Message","props","onClientUpdateClearSelection","update","state","selected","setState","onClientUpdateMessageHighlighted","chatId","messageId","highlighted","setTimeout","onClientUpdateMessageSelected","onUpdateMessageEdited","chat_id","message_id","forceUpdate","onUpdateMessageViews","onUpdateMessageContent","emojiMatches","newEmojiMatches","handleSelectUser","userId","handleSelectChat","handleSelection","mouseDown","selection","window","getSelection","toString","selectedItems","has","handleDateClick","e","preventDefault","stopPropagation","get","canBeReplied","clientUpdate","canBeForwarded","can_be_forwarded","info","messageIds","event","handleAnimationEnd","handleMouseDown","handleMouseOver","handleMouseOut","mouseOut","handleReplyClick","process","env","NODE_ENV","nextProps","nextState","sendingState","showUnreadSeparator","showTitle","contextMenu","console","log","on","removeListener","t","classes","sending_state","views","date","edit_date","reply_to_message_id","forward_info","sender_user_id","text","webPage","media","unread","tile","messageClassName","meta","Boolean","enhance","withTheme"],"mappings":"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","sourcesContent":["/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React, { Component } from 'react';\nimport classNames from 'classnames';\nimport { compose } from 'recompose';\nimport { withTranslation } from 'react-i18next';\nimport withStyles from '@material-ui/core/styles/withStyles';\nimport CheckMarkIcon from '@material-ui/icons/Check';\nimport Reply from './Reply';\nimport Forward from './Forward';\nimport Meta from './Meta';\nimport MessageStatus from './MessageStatus';\nimport MessageAuthor from './MessageAuthor';\nimport UserTile from '../Tile/UserTile';\nimport ChatTile from '../Tile/ChatTile';\nimport UnreadSeparator from './UnreadSeparator';\nimport WebPage from './Media/WebPage';\nimport { getEmojiMatches, getText, getMedia, getUnread, getWebPage, openMedia } from '../../Utils/Message';\nimport { canSendMessages } from '../../Utils/Chat';\nimport { openUser, openChat, selectMessage, openReply } from '../../Actions/Client';\nimport MessageStore from '../../Stores/MessageStore';\nimport TdLibController from '../../Controllers/TdLibController';\nimport './Message.css';\n\nconst styles = theme => ({\n    message: {\n        backgroundColor: 'transparent'\n    },\n    messageAuthorColor: {\n        color: theme.palette.primary.main\n    },\n    messageSelected: {\n        backgroundColor: theme.palette.primary.main + '22'\n    },\n    messageSelectTick: {\n        background: theme.palette.primary.main,\n        color: 'white'\n    },\n    '@keyframes highlighted': {\n        from: { backgroundColor: theme.palette.primary.main + '22' },\n        to: { backgroundColor: 'transparent' }\n    },\n    messageHighlighted: {\n        animation: 'highlighted 4s ease-out'\n    }\n});\n\nclass Message extends Component {\n    constructor(props) {\n        super(props);\n\n        const { chatId, messageId } = this.props;\n        if (process.env.NODE_ENV !== 'production') {\n            this.state = {\n                message: MessageStore.get(chatId, messageId),\n                emojiMatches: getEmojiMatches(chatId, messageId),\n                selected: false,\n                highlighted: false\n            };\n        } else {\n            this.state = {\n                emojiMatches: getEmojiMatches(chatId, messageId),\n                selected: false,\n                highlighted: false\n            };\n        }\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        const { theme, chatId, messageId, sendingState, showUnreadSeparator, showTitle } = this.props;\n        const { contextMenu, selected, highlighted, emojiMatches } = this.state;\n\n        if (nextProps.theme !== theme) {\n            console.log('Message.shouldComponentUpdate true');\n            return true;\n        }\n\n        if (nextProps.chatId !== chatId) {\n            console.log('Message.shouldComponentUpdate true');\n            return true;\n        }\n\n        if (nextProps.messageId !== messageId) {\n            console.log('Message.shouldComponentUpdate true');\n            return true;\n        }\n\n        if (nextProps.sendingState !== sendingState) {\n            console.log('Message.shouldComponentUpdate true');\n            return true;\n        }\n\n        if (nextProps.showUnreadSeparator !== showUnreadSeparator) {\n            console.log('Message.shouldComponentUpdate true');\n            return true;\n        }\n\n        if (nextProps.showTitle !== showTitle) {\n            console.log('Message.shouldComponentUpdate true');\n            return true;\n        }\n\n        if (nextState.contextMenu !== contextMenu) {\n            console.log('Message.shouldComponentUpdate true');\n            return true;\n        }\n\n        if (nextState.selected !== selected) {\n            console.log('Message.shouldComponentUpdate true');\n            return true;\n        }\n\n        if (nextState.highlighted !== highlighted) {\n            console.log('Message.shouldComponentUpdate true');\n            return true;\n        }\n\n        if (nextState.emojiMatches !== emojiMatches) {\n            console.log('Message.shouldComponentUpdate true');\n            return true;\n        }\n\n        // console.log('Message.shouldComponentUpdate false');\n        return false;\n    }\n\n    componentDidMount() {\n        MessageStore.on('clientUpdateMessageHighlighted', this.onClientUpdateMessageHighlighted);\n        MessageStore.on('clientUpdateMessageSelected', this.onClientUpdateMessageSelected);\n        MessageStore.on('clientUpdateClearSelection', this.onClientUpdateClearSelection);\n        MessageStore.on('updateMessageContent', this.onUpdateMessageContent);\n        MessageStore.on('updateMessageEdited', this.onUpdateMessageEdited);\n        MessageStore.on('updateMessageViews', this.onUpdateMessageViews);\n    }\n\n    componentWillUnmount() {\n        MessageStore.removeListener('clientUpdateMessageHighlighted', this.onClientUpdateMessageHighlighted);\n        MessageStore.removeListener('clientUpdateMessageSelected', this.onClientUpdateMessageSelected);\n        MessageStore.removeListener('clientUpdateClearSelection', this.onClientUpdateClearSelection);\n        MessageStore.removeListener('updateMessageContent', this.onUpdateMessageContent);\n        MessageStore.removeListener('updateMessageEdited', this.onUpdateMessageEdited);\n        MessageStore.removeListener('updateMessageViews', this.onUpdateMessageViews);\n    }\n\n    onClientUpdateClearSelection = update => {\n        if (!this.state.selected) return;\n\n        this.setState({ selected: false });\n    };\n\n    onClientUpdateMessageHighlighted = update => {\n        const { chatId, messageId } = this.props;\n        const { selected, highlighted } = this.state;\n\n        if (selected) return;\n\n        if (chatId === update.chatId && messageId === update.messageId) {\n            if (highlighted) {\n                this.setState({ highlighted: false }, () => {\n                    setTimeout(() => {\n                        this.setState({ highlighted: true });\n                    }, 0);\n                });\n            } else {\n                this.setState({ highlighted: true });\n            }\n        } else if (highlighted) {\n            this.setState({ highlighted: false });\n        }\n    };\n\n    onClientUpdateMessageSelected = update => {\n        const { chatId, messageId } = this.props;\n        const { selected } = update;\n\n        if (chatId === update.chatId && messageId === update.messageId) {\n            this.setState({ selected, highlighted: false });\n        }\n    };\n\n    onUpdateMessageEdited = update => {\n        const { chat_id, message_id } = update;\n        const { chatId, messageId } = this.props;\n\n        if (chatId === chat_id && messageId === message_id) {\n            this.forceUpdate();\n        }\n    };\n\n    onUpdateMessageViews = update => {\n        const { chat_id, message_id } = update;\n        const { chatId, messageId } = this.props;\n\n        if (chatId === chat_id && messageId === message_id) {\n            this.forceUpdate();\n        }\n    };\n\n    onUpdateMessageContent = update => {\n        const { chat_id, message_id } = update;\n        const { chatId, messageId } = this.props;\n        const { emojiMatches } = this.state;\n\n        if (chatId !== chat_id) return;\n        if (messageId !== message_id) return;\n\n        const newEmojiMatches = getEmojiMatches(chatId, messageId);\n        if (newEmojiMatches !== emojiMatches) {\n            this.setState({ emojiMatches: getEmojiMatches(chatId, messageId) });\n        } else {\n            this.forceUpdate();\n        }\n    };\n\n    handleSelectUser = userId => {\n        openUser(userId, true);\n    };\n\n    handleSelectChat = chatId => {\n        openChat(chatId, null, true);\n    };\n\n    handleSelection = () => {\n        if (!this.mouseDown) return;\n\n        const selection = window.getSelection().toString();\n        if (selection) return;\n\n        const { chatId, messageId } = this.props;\n\n        const selected = !MessageStore.selectedItems.has(`chatId=${chatId}_messageId=${messageId}`);\n        selectMessage(chatId, messageId, selected);\n    };\n\n    handleDateClick = e => {\n        e.preventDefault();\n        e.stopPropagation();\n\n        const { chatId, messageId } = this.props;\n\n        const message = MessageStore.get(chatId, messageId);\n\n        const canBeReplied = canSendMessages(chatId);\n        if (canBeReplied) {\n            TdLibController.clientUpdate({\n                '@type': 'clientUpdateReply',\n                chatId: chatId,\n                messageId: messageId\n            });\n            return;\n        }\n\n        const canBeForwarded = message && message.can_be_forwarded;\n        if (canBeForwarded) {\n            TdLibController.clientUpdate({\n                '@type': 'clientUpdateForward',\n                info: {\n                    chatId: chatId,\n                    messageIds: [messageId]\n                }\n            });\n        }\n    };\n\n    openMedia = event => {\n        if (event) {\n            event.preventDefault();\n            event.stopPropagation();\n        }\n\n        const { chatId, messageId } = this.props;\n\n        openMedia(chatId, messageId);\n    };\n\n    handleAnimationEnd = () => {\n        this.setState({ highlighted: false });\n    };\n\n    handleMouseDown = () => {\n        this.mouseDown = true;\n    };\n\n    handleMouseOver = () => {\n        this.mouseDown = false;\n    };\n\n    handleMouseOut = () => {\n        this.mouseOut = false;\n    };\n\n    handleReplyClick = () => {\n        const { chatId, messageId } = this.props;\n        openReply(chatId, messageId);\n    };\n\n    render() {\n        const { t, classes, chatId, messageId, showUnreadSeparator, showTitle } = this.props;\n        const { emojiMatches, selected, highlighted } = this.state;\n\n        const message = MessageStore.get(chatId, messageId);\n        if (!message) return <div>[empty message]</div>;\n\n        const { sending_state, views, date, edit_date, reply_to_message_id, forward_info, sender_user_id } = message;\n\n        const text = getText(message);\n        const webPage = getWebPage(message);\n        const media = getMedia(message, this.openMedia);\n        this.unread = getUnread(message);\n\n        let tile = null;\n        if (showTitle) {\n            tile = sender_user_id ? (\n                <UserTile userId={sender_user_id} onSelect={this.handleSelectUser} />\n            ) : (\n                <ChatTile chatId={chatId} onSelect={this.handleSelectChat} />\n            );\n        }\n\n        const messageClassName = classNames('message', classes.message, {\n            'message-selected': selected,\n            [classes.messageSelected]: selected,\n            [classes.messageHighlighted]: highlighted && !selected,\n            'message-short': !showTitle\n        });\n\n        const meta = <Meta date={date} editDate={edit_date} views={views} onDateClick={this.handleDateClick} />;\n\n        return (\n            <div\n                className={messageClassName}\n                onMouseOver={this.handleMouseOver}\n                onMouseOut={this.handleMouseOut}\n                onMouseDown={this.handleMouseDown}\n                onClick={this.handleSelection}\n                onAnimationEnd={this.handleAnimationEnd}>\n                {showUnreadSeparator && <UnreadSeparator />}\n                <div className='message-wrapper'>\n                    <div className='message-left-padding'>\n                        {/*<div className='message-left-padding-wrapper'>*/}\n                        {/**/}\n                        {/*</div>*/}\n                        <CheckMarkIcon className={classNames('message-select-tick', classes.messageSelectTick)} />\n                        {this.unread && (\n                            <MessageStatus chatId={chatId} messageId={messageId} sendingState={sending_state} />\n                        )}\n                    </div>\n                    {tile}\n                    <div className='message-content'>\n                        <div className='message-title'>\n                            {showTitle && !forward_info && (\n                                <MessageAuthor chatId={chatId} openChat userId={sender_user_id} openUser />\n                            )}\n                            {forward_info && <Forward forwardInfo={forward_info} />}\n                            {showTitle && meta}\n                        </div>\n                        {Boolean(reply_to_message_id) && (\n                            <Reply chatId={chatId} messageId={reply_to_message_id} onClick={this.handleReplyClick} />\n                        )}\n                        {media}\n                        <div\n                            className={classNames('message-text', {\n                                'message-text-1emoji': emojiMatches === 1,\n                                'message-text-2emoji': emojiMatches === 2,\n                                'message-text-3emoji': emojiMatches === 3\n                            })}>\n                            {text}\n                        </div>\n                        {webPage && <WebPage chatId={chatId} messageId={messageId} openMedia={this.openMedia} />}\n                    </div>\n                    {!showTitle && meta}\n                </div>\n            </div>\n        );\n    }\n}\n\nconst enhance = compose(\n    withStyles(styles, { withTheme: true }),\n    withTranslation()\n);\n\nexport default enhance(Message);\n"]},"metadata":{},"sourceType":"module"}