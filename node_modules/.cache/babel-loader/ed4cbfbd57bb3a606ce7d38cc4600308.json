{"ast":null,"code":"import _regeneratorRuntime from\"/home/me-admin/Downloads/my-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/me-admin/Downloads/my-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */import React from'react';import dateFormat from'dateformat';import emojiRegex from'emoji-regex';import Audio from'../Components/Message/Media/Audio';import Animation from'../Components/Message/Media/Animation';import Contact from'../Components/Message/Media/Contact';import Document from'../Components/Message/Media/Document';import Game from'../Components/Message/Media/Game';import Location from'../Components/Message/Media/Location';import MentionLink from'../Components/Additional/MentionLink';import Photo from'../Components/Message/Media/Photo';import Poll from'../Components/Message/Media/Poll';import SafeLink from'../Components/Additional/SafeLink';import Sticker,{StickerSourceEnum}from'../Components/Message/Media/Sticker';import Venue from'../Components/Message/Media/Venue';import Video from'../Components/Message/Media/Video';import VideoNote from'../Components/Message/Media/VideoNote';import VoiceNote from'../Components/Message/Media/VoiceNote';import{searchChat,setMediaViewerContent}from'../Actions/Client';import{getChatDisableMentionNotifications,getChatDisablePinnedMessageNotifications,getChatTitle,isChatMuted}from'./Chat';import{openUser}from'./../Actions/Client';import{getPhotoSize,getSize}from'./Common';import{download,saveOrDownload}from'./File';import{getAudioTitle}from'./Media';import{getServiceMessageContent}from'./ServiceMessage';import{getUserFullName}from'./User';import{LOCATION_HEIGHT,LOCATION_SCALE,LOCATION_WIDTH,LOCATION_ZOOM}from'../Constants';import AppStore from'../Stores/ApplicationStore';import ChatStore from'../Stores/ChatStore';import FileStore from'../Stores/FileStore';import MessageStore from'../Stores/MessageStore';import UserStore from'../Stores/UserStore';import TdLibController from'../Controllers/TdLibController';function getAuthor(message){if(!message)return null;var forward_info=message.forward_info;if(forward_info){switch(forward_info['@type']){case'messageForwardedFromUser':{if(forward_info.sender_user_id>0){var user=UserStore.get(forward_info.sender_user_id);if(user){return getUserFullName(user);}}break;}case'messageForwardedPost':{var chat=ChatStore.get(forward_info.chat_id);if(chat){return chat.title;}break;}}}return getTitle(message);}function getTitle(message){if(!message)return null;var sender_user_id=message.sender_user_id,chat_id=message.chat_id;if(sender_user_id){var user=UserStore.get(sender_user_id);if(user){return getUserFullName(user);}}if(chat_id){var chat=ChatStore.get(chat_id);if(chat){return chat.title;}}return null;}function substring(text,start,end){if(start<0)start=0;if(start>text.length-1)start=text.length-1;if(end<start)end=start;if(end>text.length)end=text.length;return text.substring(start,end);}function stopPropagation(event){event.stopPropagation();}function searchCurrentChatByHashtag(event,hashtag){event.stopPropagation();event.preventDefault();var chatId=AppStore.chatId;searchChat(chatId,hashtag);}function getFormattedText(text){if(text['@type']!=='formattedText')return null;if(!text.text)return null;if(!text.entities)return text.text;var result=[];var index=0;var _loop=function _loop(i){var beforeEntityText=substring(text.text,index,text.entities[i].offset);if(beforeEntityText){result.push(beforeEntityText);}var entityText=substring(text.text,text.entities[i].offset,text.entities[i].offset+text.entities[i].length);switch(text.entities[i].type['@type']){case'textEntityTypeUrl':{result.push(React.createElement(SafeLink,{key:text.entities[i].offset,url:entityText},entityText));break;}case'textEntityTypeTextUrl':{var url=entityText;var typeUrl=text.entities[i].type.url;if(typeUrl){url=typeUrl;}result.push(React.createElement(SafeLink,{key:text.entities[i].offset,url:url},entityText));break;}case'textEntityTypeBold':result.push(React.createElement(\"strong\",{key:text.entities[i].offset},entityText));break;case'textEntityTypeItalic':result.push(React.createElement(\"em\",{key:text.entities[i].offset},entityText));break;case'textEntityTypeCode':result.push(React.createElement(\"code\",{key:text.entities[i].offset},entityText));break;case'textEntityTypePre':result.push(React.createElement(\"pre\",{key:text.entities[i].offset},React.createElement(\"code\",null,entityText)));break;case'textEntityTypeMention':result.push(React.createElement(MentionLink,{key:text.entities[i].offset,username:entityText},entityText));break;case'textEntityTypeMentionName':result.push(React.createElement(MentionLink,{key:text.entities[i].offset,userId:text.entities[i].type.user_id},entityText));break;case'textEntityTypeHashtag':result.push(React.createElement(\"a\",{key:text.entities[i].offset,onClick:function onClick(event){return searchCurrentChatByHashtag(event,entityText);}},entityText));break;case'textEntityTypeEmailAddress':result.push(React.createElement(\"a\",{key:text.entities[i].offset,onClick:stopPropagation,href:\"mailto:\".concat(entityText),target:\"_blank\",rel:\"noopener noreferrer\"},entityText));break;case'textEntityTypeBotCommand':var command=entityText.length>0&&entityText[0]==='/'?substring(entityText,1):entityText;result.push(React.createElement(\"a\",{key:text.entities[i].offset,onClick:stopPropagation,href:\"tg://bot_command?command=\".concat(command,\"&bot=\")},entityText));break;default:result.push(entityText);break;}index+=beforeEntityText.length+entityText.length;};for(var i=0;i<text.entities.length;i++){_loop(i);}if(index<text.text.length){var afterEntityText=text.text.substring(index);if(afterEntityText){result.push(afterEntityText);}}return result;}function getText(message){if(!message)return null;var text=[];var content=message.content;if(content&&content['@type']==='messageText'&&content.text&&content.text['@type']==='formattedText'&&content.text.text){text=getFormattedText(content.text);}else{//text.push('[' + message.content['@type'] + ']');//JSON.stringify(x);\nif(content&&content.caption&&content.caption['@type']==='formattedText'&&content.caption.text){text.push('\\n');var formattedText=getFormattedText(content.caption);if(formattedText){text=text.concat(formattedText);}}}return text;}function getWebPage(message){if(!message)return null;if(!message.content)return null;return message.content.web_page;}function getDate(date){if(!date)return null;var d=new Date(date*1000);return dateFormat(d,'H:MM');//date.toDateString();\n}function getDateHint(date){if(!date)return null;var d=new Date(date*1000);return dateFormat(d,'H:MM:ss d.mm.yyyy');//date.toDateString();\n}function getMedia(message,openMedia){if(!message)return null;var chat_id=message.chat_id,id=message.id,content=message.content;if(!content)return null;switch(content['@type']){case'messageAnimation':return React.createElement(Animation,{chatId:chat_id,messageId:id,animation:content.animation,openMedia:openMedia});case'messageAudio':return React.createElement(Audio,{chatId:chat_id,messageId:id,audio:content.audio,openMedia:openMedia});case'messageContact':return React.createElement(Contact,{chatId:chat_id,messageId:id,contact:content.contact,openMedia:openMedia});case'messageDocument':return React.createElement(Document,{chatId:chat_id,messageId:id,document:content.document,openMedia:openMedia});case'messageGame':return React.createElement(Game,{chatId:chat_id,messageId:id,game:content.game,openMedia:openMedia});case'messageLocation':return React.createElement(Location,{chatId:chat_id,messageId:id,location:content.location,openMedia:openMedia});case'messagePhoto':return React.createElement(Photo,{chatId:chat_id,messageId:id,photo:content.photo,openMedia:openMedia});case'messagePoll':return React.createElement(Poll,{chatId:chat_id,messageId:id,poll:content.poll,openMedia:openMedia});case'messageSticker':return React.createElement(Sticker,{chatId:chat_id,messageId:id,sticker:content.sticker,source:StickerSourceEnum.MESSAGE,openMedia:openMedia});case'messageText':return null;case'messageVenue':return React.createElement(Venue,{chatId:chat_id,messageId:id,venue:content.venue,openMedia:openMedia});case'messageVideo':return React.createElement(Video,{chatId:chat_id,messageId:id,video:content.video,openMedia:openMedia});case'messageVideoNote':return React.createElement(VideoNote,{chatId:chat_id,messageId:id,videoNote:content.video_note,openMedia:openMedia});case'messageVoiceNote':return React.createElement(VoiceNote,{chatId:chat_id,messageId:id,voiceNote:content.voice_note,openMedia:openMedia});default:return'['+content['@type']+']';}}function isForwardOriginHidden(forwardInfo){if(!forwardInfo)return false;var origin=forwardInfo.origin;if(!origin)return false;switch(origin['@type']){case'messageForwardOriginUser':{return false;}case'messageForwardOriginHiddenUser':{return true;}case'messageForwardOriginChannel':{return false;}}return false;}function getForwardTitle(forwardInfo){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(key){return key;};if(!forwardInfo)return'';var origin=forwardInfo.origin;if(!origin)return'';switch(origin['@type']){case'messageForwardOriginUser':{var sender_user_id=origin.sender_user_id;var user=UserStore.get(sender_user_id);return getUserFullName(user);}case'messageForwardOriginHiddenUser':{var sender_name=origin.sender_name;return sender_name;}case'messageForwardOriginChannel':{var chat_id=origin.chat_id,author_signature=origin.author_signature;return getChatTitle(chat_id,false,t)+(author_signature?\" (\".concat(author_signature,\")\"):'');}}return'';}function getUnread(message){if(!message)return false;if(!message.chat_id)return false;if(!message.is_outgoing)return false;var chat=ChatStore.get(message.chat_id);if(!chat)return false;return chat.last_read_outbox_message_id<message.id;}function getSenderUserId(message){if(!message)return null;return message.sender_user_id;}function filterDuplicateMessages(result,history){if(result.messages.length===0)return;if(history.length===0)return;var map=history.reduce(function(accumulator,current){accumulator.set(current.id,current.id);return accumulator;},new Map());result.messages=result.messages.filter(function(x){return!map.has(x.id);});}function filterMessages(messages){return messages.filter(function(x){return x.content['@type']!=='messageChatUpgradeTo';});}function getContent(message){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(key){return key;};if(!message)return null;var content=message.content;if(!content)return null;var caption='';if(content.caption&&content.caption.text){caption=\", \".concat(content.caption.text);}if(message.ttl>0){return getServiceMessageContent(message);}switch(content['@type']){case'messageAnimation':{return t('AttachGif')+caption;}case'messageAudio':{return t('AttachMusic')+caption;}case'messageBasicGroupChatCreate':{return getServiceMessageContent(message);}case'messageCall':{return t('Call')+caption;}case'messageChatAddMembers':{return getServiceMessageContent(message);}case'messageChatChangePhoto':{return getServiceMessageContent(message);}case'messageChatChangeTitle':{return getServiceMessageContent(message);}case'messageChatDeleteMember':{return getServiceMessageContent(message);}case'messageChatDeletePhoto':{return getServiceMessageContent(message);}case'messageChatJoinByLink':{return getServiceMessageContent(message);}case'messageChatSetTtl':{return getServiceMessageContent(message);}case'messageChatUpgradeFrom':{return getServiceMessageContent(message);}case'messageChatUpgradeTo':{return getServiceMessageContent(message);}case'messageContact':{return t('AttachContact')+caption;}case'messageContactRegistered':{return getServiceMessageContent(message);}case'messageCustomServiceAction':{return getServiceMessageContent(message);}case'messageDocument':{var document=content.document;if(document&&document.file_name){return document.file_name+caption;}return t('AttachDocument')+caption;}case'messageExpiredPhoto':{return t('AttachPhoto')+caption;}case'messageExpiredVideo':{return t('AttachVideo')+caption;}case'messageGame':{return t('AttachGame')+caption;}case'messageGameScore':{return getServiceMessageContent(message);}case'messageInvoice':{return getServiceMessageContent(message);}case'messageLocation':{return t('AttachLocation')+caption;}case'messagePassportDataReceived':{return getServiceMessageContent(message);}case'messagePassportDataSent':{return getServiceMessageContent(message);}case'messagePaymentSuccessful':{return getServiceMessageContent(message);}case'messagePaymentSuccessfulBot':{return getServiceMessageContent(message);}case'messagePhoto':{return t('AttachPhoto')+caption;}case'messagePoll':{var poll=content.poll;return'📊 '+(poll.question||t('Poll'))+caption;}case'messagePinMessage':{return getServiceMessageContent(message);}case'messageScreenshotTaken':{return getServiceMessageContent(message);}case'messageSticker':{var sticker=content.sticker;var emoji='';if(sticker&&sticker.emoji){emoji=sticker.emoji;}return t('AttachSticker')+(emoji?\" \".concat(emoji):'')+caption;}case'messageSupergroupChatCreate':{return getServiceMessageContent(message);}case'messageText':{return content.text.text+caption;}case'messageUnsupported':{return getServiceMessageContent(message);}case'messageVenue':{return t('AttachLocation')+caption;}case'messageVideo':{return t('AttachVideo')+caption;}case'messageVideoNote':{return t('AttachRound')+caption;}case'messageVoiceNote':{return t('AttachAudio')+caption;}case'messageWebsiteConnected':{return getServiceMessageContent(message);}default:{return t('UnsupportedAttachment');}}}function isMediaContent(content){if(!content)return false;return content['@type']==='messagePhoto';}function getLocationId(location){var width=arguments.length>1&&arguments[1]!==undefined?arguments[1]:LOCATION_WIDTH;var height=arguments.length>2&&arguments[2]!==undefined?arguments[2]:LOCATION_HEIGHT;var zoom=arguments.length>3&&arguments[3]!==undefined?arguments[3]:LOCATION_ZOOM;var scale=arguments.length>4&&arguments[4]!==undefined?arguments[4]:LOCATION_SCALE;if(!location)return null;var longitude=location.longitude,latitude=location.latitude;return\"loc=\".concat(latitude,\",\").concat(longitude,\"&size=\").concat(width,\",\").concat(height,\"&scale=\").concat(scale,\"&zoom=\").concat(zoom);}function isVideoMessage(chatId,messageId){var message=MessageStore.get(chatId,messageId);if(!message)return false;var content=message.content;if(!content)return false;switch(content['@type']){case'messageVideo':{return true;}case'messageText':{var web_page=content.web_page;return Boolean(web_page.video);}default:{return false;}}}function isLottieMessage(chatId,messageId){var message=MessageStore.get(chatId,messageId);if(!message)return false;var content=message.content;if(!content)return false;switch(content['@type']){case'messageDocument':{var document=content.document;if(!document)return false;var file_name=document.file_name;return file_name&&file_name.toLowerCase().endsWith('.json');}case'messageText':{var web_page=content.web_page;if(!web_page)return false;var _document=web_page.document;if(!_document)return false;var _file_name=_document.file_name;return _file_name&&_file_name.toLowerCase().endsWith('.json');}default:{return false;}}}function isAnimationMessage(chatId,messageId){var message=MessageStore.get(chatId,messageId);if(!message)return false;var content=message.content;if(!content)return false;switch(content['@type']){case'messageAnimation':{return true;}case'messageText':{var web_page=content.web_page;return Boolean(web_page.animation);}default:{return false;}}}function isContentOpened(chatId,messageId){var message=MessageStore.get(chatId,messageId);if(!message)return true;var content=message.content;if(!content)return true;switch(content['@type']){case'messageVoiceNote':{return content.is_listened;}case'messageVideoNote':{return content.is_viewed;}default:{return true;}}}function getMediaTitle(message){if(!message)return null;var content=message.content;if(!content)return null;switch(content['@type']){case'messageAudio':{var audio=content.audio;if(audio){return getAudioTitle(audio);}break;}case'messageText':{var web_page=content.web_page;if(web_page){var _audio=web_page.audio;if(_audio){return getAudioTitle(_audio);}break;}}}return getAuthor(message);}function hasAudio(chatId,messageId){var message=MessageStore.get(chatId,messageId);if(!message)return false;var content=message.content;if(!content)return false;switch(content['@type']){case'messageAudio':{var audio=content.audio;if(audio){return true;}break;}case'messageText':{var web_page=content.web_page;if(web_page){var _audio2=web_page.audio;if(_audio2){return true;}}break;}}return false;}function hasVideoNote(chatId,messageId){var message=MessageStore.get(chatId,messageId);if(!message)return false;var content=message.content;if(!content)return false;switch(content['@type']){case'messageVideoNote':{var video_note=content.video_note;if(video_note){return true;}break;}case'messageText':{var web_page=content.web_page;if(web_page){var _video_note=web_page.video_note;if(_video_note){return true;}}break;}}return false;}function getSearchMessagesFilter(chatId,messageId){var message=MessageStore.get(chatId,messageId);if(!message)return null;var content=message.content;if(!content)return null;switch(content['@type']){case'messageAudio':{var audio=content.audio;if(audio){return{'@type':'searchMessagesFilterAudio'};}break;}case'messageVoiceNote':{var voice_note=content.voice_note;if(voice_note){return{'@type':'searchMessagesFilterVoiceNote'};}break;}case'messageVideoNote':{var video_note=content.video_note;if(video_note){return null;return{'@type':'searchMessagesFilterVideoNote'};}break;}case'messageText':{var web_page=content.web_page;if(web_page){var _audio3=web_page.audio,_voice_note=web_page.voice_note,_video_note2=web_page.video_note;if(_audio3){return null;return{'@type':'searchMessagesFilterAudio'};}if(_voice_note){return null;return{'@type':'searchMessagesFilterVoiceNote'};}if(_video_note2){return null;return{'@type':'searchMessagesFilterVideoNote'};}break;}}}return null;}function openAnimation(animation,message,fileCancel){if(!animation)return;if(!message)return;var chat_id=message.chat_id,id=message.id;var file=animation.animation;if(!file)return;file=FileStore.get(file.id)||file;if(fileCancel&&file.local.is_downloading_active){FileStore.cancelGetRemoteFile(file.id,message);return;}else if(fileCancel&&file.remote.is_uploading_active){FileStore.cancelUploadFile(file.id,message);return;}else{// download file at loadMediaViewerContent instead\n// download(file, message, FileStore.updateAnimationBlob(chat_id, id, file.id));\n}TdLibController.clientUpdate({'@type':'clientUpdateActiveAnimation',chatId:chat_id,messageId:id});TdLibController.send({'@type':'openMessageContent',chat_id:chat_id,message_id:id});setMediaViewerContent({chatId:chat_id,messageId:id});}function openAudio(audio,message,fileCancel){if(!audio)return;if(!message)return;var chat_id=message.chat_id,id=message.id;var file=audio.audio;if(!file)return;file=FileStore.get(file.id)||file;if(fileCancel&&file.local.is_downloading_active){FileStore.cancelGetRemoteFile(file.id,message);return;}else if(fileCancel&&file.remote.is_uploading_active){FileStore.cancelUploadFile(file.id,message);return;}else{download(file,message,function(){return FileStore.updateAudioBlob(chat_id,id,file.id);});}TdLibController.send({'@type':'openMessageContent',chat_id:chat_id,message_id:id});TdLibController.clientUpdate({'@type':'clientUpdateMediaActive',chatId:chat_id,messageId:id});}function openChatPhoto(photo,message,fileCancel){if(!photo)return;if(!message)return;var chat_id=message.chat_id,id=message.id;var photoSize=getPhotoSize(photo.sizes);if(!photoSize)return;var file=photoSize.photo;if(!file)return;file=FileStore.get(file.id)||file;if(fileCancel&&file.local.is_downloading_active){FileStore.cancelGetRemoteFile(file.id,message);return;}else if(fileCancel&&file.remote.is_uploading_active){FileStore.cancelUploadFile(file.id,message);return;}download(file,message,function(){return FileStore.updatePhotoBlob(chat_id,id,file.id);});TdLibController.send({'@type':'openMessageContent',chat_id:chat_id,message_id:id});setMediaViewerContent({chatId:chat_id,messageId:id});}function openContact(contact,message,fileCancel){if(!contact)return;if(!message)return;var chat_id=message.chat_id,id=message.id;TdLibController.send({'@type':'openMessageContent',chat_id:chat_id,message_id:id});openUser(contact.userId);}function openDocument(document,message,fileCancel){if(!document)return;if(!message)return;var chat_id=message.chat_id,id=message.id;var file=document.document;if(!file)return;file=FileStore.get(file.id)||file;if(fileCancel&&file.local.is_downloading_active){FileStore.cancelGetRemoteFile(file.id,message);return;}else if(fileCancel&&file.remote.is_uploading_active){FileStore.cancelUploadFile(file.id,message);return;}TdLibController.send({'@type':'openMessageContent',chat_id:chat_id,message_id:id});if(isLottieMessage(chat_id,id)){TdLibController.send({'@type':'openMessageContent',chat_id:chat_id,message_id:id});setMediaViewerContent({chatId:chat_id,messageId:id});}else{saveOrDownload(file,document.file_name,message);}}function openGame(game,message,fileCancel){if(!game)return;if(!message)return;var chat_id=message.chat_id,id=message.id;var animation=game.animation;if(animation){var file=animation.animation;if(!file)return;file=FileStore.get(file.id)||file;if(fileCancel&&file.local.is_downloading_active){FileStore.cancelGetRemoteFile(file.id,message);return;}else if(fileCancel&&file.remote.is_uploading_active){FileStore.cancelUploadFile(file.id,message);return;}download(file,message,function(){return FileStore.updateAnimationBlob(chat_id,id,file.id);});}TdLibController.send({'@type':'openMessageContent',chat_id:chat_id,message_id:id});TdLibController.clientUpdate({'@type':'clientUpdateActiveAnimation',chatId:chat_id,messageId:id});}function openPhoto(photo,message,fileCancel){if(!photo)return;if(!message)return;var chat_id=message.chat_id,id=message.id;var photoSize=getPhotoSize(photo.sizes);if(!photoSize)return;var file=photoSize.photo;if(!file)return;file=FileStore.get(file.id)||file;if(fileCancel&&file.local.is_downloading_active){FileStore.cancelGetRemoteFile(file.id,message);return;}else if(fileCancel&&file.remote.is_uploading_active){FileStore.cancelUploadFile(file.id,message);return;}download(file,message,function(){return FileStore.updatePhotoBlob(chat_id,id,file.id);});TdLibController.send({'@type':'openMessageContent',chat_id:chat_id,message_id:id});setMediaViewerContent({chatId:chat_id,messageId:id});}function openSticker(_x,_x2,_x3){return _openSticker.apply(this,arguments);}function _openSticker(){_openSticker=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(sticker,message,fileCancel){var chat_id,id,set_id,stickerSet;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(sticker){_context.next=2;break;}return _context.abrupt(\"return\");case 2:if(message){_context.next=4;break;}return _context.abrupt(\"return\");case 4:chat_id=message.chat_id,id=message.id;TdLibController.send({'@type':'openMessageContent',chat_id:chat_id,message_id:id});set_id=sticker.set_id;if(set_id){_context.next=9;break;}return _context.abrupt(\"return\");case 9:_context.next=11;return TdLibController.send({'@type':'getStickerSet',set_id:set_id});case 11:stickerSet=_context.sent;if(stickerSet){_context.next=14;break;}return _context.abrupt(\"return\");case 14:TdLibController.clientUpdate({'@type':'clientUpdateStickerSet',stickerSet:stickerSet});case 15:case\"end\":return _context.stop();}}},_callee);}));return _openSticker.apply(this,arguments);}function openVideo(video,message,fileCancel){if(!video)return;if(!message)return;var chat_id=message.chat_id,id=message.id;var file=video.video;if(!file)return;file=FileStore.get(file.id)||file;if(fileCancel&&file.local.is_downloading_active){FileStore.cancelGetRemoteFile(file.id,message);return;}else if(fileCancel&&file.remote.is_uploading_active){FileStore.cancelUploadFile(file.id,message);return;}TdLibController.send({'@type':'openMessageContent',chat_id:chat_id,message_id:id});setMediaViewerContent({chatId:chat_id,messageId:id});}function openVideoNote(videoNote,message,fileCancel){if(!videoNote)return;if(!message)return;var chat_id=message.chat_id,id=message.id;var file=videoNote.video;if(!file)return;file=FileStore.get(file.id)||file;if(fileCancel&&file.local.is_downloading_active){FileStore.cancelGetRemoteFile(file.id,message);return;}else if(fileCancel&&file.remote.is_uploading_active){FileStore.cancelUploadFile(file.id,message);return;}download(file,message,function(){return FileStore.updateVideoNoteBlob(chat_id,id,file.id);});TdLibController.send({'@type':'openMessageContent',chat_id:chat_id,message_id:id});TdLibController.clientUpdate({'@type':'clientUpdateMediaActive',chatId:chat_id,messageId:id});}function openVoiceNote(voiceNote,message,fileCancel){if(!voiceNote)return;if(!message)return;var chat_id=message.chat_id,id=message.id;var file=voiceNote.voice;if(!file)return;file=FileStore.get(file.id)||file;if(fileCancel&&file.local.is_downloading_active){FileStore.cancelGetRemoteFile(file.id,message);return;}else if(fileCancel&&file.remote.is_uploading_active){FileStore.cancelUploadFile(file.id,message);return;}else{download(file,message,function(){return FileStore.updateVoiceNoteBlob(chat_id,id,file.id);});}TdLibController.send({'@type':'openMessageContent',chat_id:chat_id,message_id:id});TdLibController.clientUpdate({'@type':'clientUpdateMediaActive',chatId:chat_id,messageId:id});}function openMedia(chatId,messageId){var fileCancel=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var message=MessageStore.get(chatId,messageId);if(!message)return;var content=message.content;if(!content)return null;switch(content['@type']){case'messageAnimation':{var animation=content.animation;if(animation){openAnimation(animation,message,fileCancel);}break;}case'messageAudio':{var audio=content.audio;if(audio){openAudio(audio,message,fileCancel);}break;}case'messageChatChangePhoto':{var photo=content.photo;if(photo){openChatPhoto(photo,message,fileCancel);}break;}case'messageContact':{var contact=content.contact;if(contact){openContact(contact,message,fileCancel);}break;}case'messageDocument':{var document=content.document;if(document){openDocument(document,message,fileCancel);}break;}case'messageGame':{var game=content.game;if(game){openGame(game,message,fileCancel);}break;}case'messagePhoto':{var _photo=content.photo;if(_photo){openPhoto(_photo,message,fileCancel);}break;}case'messageSticker':{var sticker=content.sticker;if(sticker){openSticker(sticker,message,fileCancel);}break;}case'messageText':{var web_page=content.web_page;if(web_page){var _animation=web_page.animation,_audio4=web_page.audio,_document2=web_page.document,_photo2=web_page.photo,_sticker=web_page.sticker,video=web_page.video,video_note=web_page.video_note,voice_note=web_page.voice_note;if(_animation){openAnimation(_animation,message,fileCancel);}if(_audio4){openAudio(_audio4,message,fileCancel);}if(_document2){openDocument(_document2,message,fileCancel);}if(_sticker){openSticker(_sticker,message,fileCancel);}if(video){openVideo(video,message,fileCancel);}if(video_note){openVideoNote(video_note,message,fileCancel);}if(voice_note){openVoiceNote(voice_note,message,fileCancel);}if(_photo2){openPhoto(_photo2,message,fileCancel);}}break;}case'messageVideo':{var _video=content.video;if(_video){openVideo(_video,message,fileCancel);}break;}case'messageVideoNote':{var _video_note3=content.video_note;if(_video_note3){openVideoNote(_video_note3,message,fileCancel);}break;}case'messageVoiceNote':{var _voice_note2=content.voice_note;if(_voice_note2){openVoiceNote(_voice_note2,message,fileCancel);}break;}}}function isDeletedMessage(message){return message&&message['@type']==='deletedMessage';}function getReplyPhotoSize(chatId,messageId){var message=MessageStore.get(chatId,messageId);if(!message)return;var content=message.content;if(!content)return null;switch(content['@type']){case'messageAnimation':{var animation=content.animation;if(!animation)return null;var thumbnail=animation.thumbnail;return thumbnail||null;}case'messageAudio':{var audio=content.audio;if(!audio)return null;var album_cover_thumbnail=audio.album_cover_thumbnail;return album_cover_thumbnail||null;}case'messageChatChangePhoto':{var photo=content.photo;if(!photo)return null;return getPhotoSize(photo.sizes);}case'messageDocument':{var document=content.document;if(!document)return null;var _thumbnail=document.thumbnail;return _thumbnail||null;}case'messageGame':{var game=content.game;if(!game)return null;var _animation2=game.animation,_photo3=game.photo;if(_animation2){var _thumbnail2=_animation2.thumbnail;if(_thumbnail2){return _thumbnail2;}}if(_photo3){return getPhotoSize(_photo3.sizes);}return null;}case'messagePhoto':{var _photo4=content.photo;if(!_photo4)return null;return getPhotoSize(_photo4.sizes);}case'messageSticker':{var sticker=content.sticker;if(!sticker)return null;var _thumbnail3=sticker.thumbnail;return _thumbnail3||null;}case'messageText':{var web_page=content.web_page;if(web_page){var _animation3=web_page.animation,_audio5=web_page.audio,_document3=web_page.document,_photo5=web_page.photo,_sticker2=web_page.sticker,video=web_page.video,video_note=web_page.video_note;if(_photo5){return getPhotoSize(_photo5.sizes);}if(_animation3){var _thumbnail4=_animation3.thumbnail;return _thumbnail4||null;}if(_audio5){var _album_cover_thumbnail=_audio5.album_cover_thumbnail;return _album_cover_thumbnail||null;}if(_document3){var _thumbnail5=_document3.thumbnail;return _thumbnail5||null;}if(_sticker2){var _thumbnail6=_sticker2.thumbnail;return _thumbnail6||null;}if(video){var _thumbnail7=video.thumbnail;return _thumbnail7||null;}if(video_note){var _thumbnail8=video_note.thumbnail;return _thumbnail8||null;}}break;}case'messageVideo':{var _video2=content.video;if(!_video2)return null;var _thumbnail9=_video2.thumbnail;return _thumbnail9||null;}case'messageVideoNote':{var _video_note4=content.video_note;if(!_video_note4)return null;var _thumbnail10=_video_note4.thumbnail;return _thumbnail10||null;}}return null;}function getEmojiMatches(chatId,messageId){var message=MessageStore.get(chatId,messageId);if(!message)return 0;var content=message.content;if(!content)return 0;if(content['@type']!=='messageText')return 0;var textContent=content.text;if(!textContent)return;if(textContent['@type']!=='formattedText')return 0;var text=textContent.text,entities=textContent.entities;if(!text)return 0;if(entities&&entities.length>0)return 0;var lastIndex=0;var emojiMatches=0;var m;var re=emojiRegex();do{m=re.exec(text);if(m){emojiMatches+=1;// none-emoji symbol between prev and current emojis or before first\nif(lastIndex!==m.index){emojiMatches=0;break;}// more than 3 emojis in a row\nif(emojiMatches>3){emojiMatches=0;break;}lastIndex=re.lastIndex;}// none-emoji symbol at the end\nif(!m&&lastIndex!==text.length){emojiMatches=0;break;}}while(m);return emojiMatches;}function messageComparatorDesc(left,right){return left.id-right.id;}export function hasMention(message){return message&&message.contains_unread_mention;}export function hasPinnedMessage(message){return message&&message.content['@type']==='messagePinMessage';}export function isMessageMuted(message){var chat_id=message.chat_id;if(hasMention(message)){return getChatDisableMentionNotifications(chat_id);}if(hasPinnedMessage(message)){return getChatDisablePinnedMessageNotifications(chat_id);}return isChatMuted(chat_id);}export{getAuthor,getTitle,getText,getFormattedText,getWebPage,getContent,getDate,getDateHint,getMedia,isForwardOriginHidden,getForwardTitle,getUnread,getSenderUserId,filterDuplicateMessages,filterMessages,isMediaContent,isDeletedMessage,isVideoMessage,isAnimationMessage,isLottieMessage,getLocationId,isContentOpened,getMediaTitle,hasAudio,hasVideoNote,getSearchMessagesFilter,openMedia,getReplyPhotoSize,getEmojiMatches,messageComparatorDesc,substring,stopPropagation};","map":{"version":3,"sources":["/home/me-admin/Downloads/my-app/src/Utils/Message.js"],"names":["React","dateFormat","emojiRegex","Audio","Animation","Contact","Document","Game","Location","MentionLink","Photo","Poll","SafeLink","Sticker","StickerSourceEnum","Venue","Video","VideoNote","VoiceNote","searchChat","setMediaViewerContent","getChatDisableMentionNotifications","getChatDisablePinnedMessageNotifications","getChatTitle","isChatMuted","openUser","getPhotoSize","getSize","download","saveOrDownload","getAudioTitle","getServiceMessageContent","getUserFullName","LOCATION_HEIGHT","LOCATION_SCALE","LOCATION_WIDTH","LOCATION_ZOOM","AppStore","ChatStore","FileStore","MessageStore","UserStore","TdLibController","getAuthor","message","forward_info","sender_user_id","user","get","chat","chat_id","title","getTitle","substring","text","start","end","length","stopPropagation","event","searchCurrentChatByHashtag","hashtag","preventDefault","chatId","getFormattedText","entities","result","index","i","beforeEntityText","offset","push","entityText","type","url","typeUrl","user_id","command","afterEntityText","getText","content","caption","formattedText","concat","getWebPage","web_page","getDate","date","d","Date","getDateHint","getMedia","openMedia","id","animation","audio","contact","document","game","location","photo","poll","sticker","MESSAGE","venue","video","video_note","voice_note","isForwardOriginHidden","forwardInfo","origin","getForwardTitle","t","key","sender_name","author_signature","getUnread","is_outgoing","last_read_outbox_message_id","getSenderUserId","filterDuplicateMessages","history","messages","map","reduce","accumulator","current","set","Map","filter","x","has","filterMessages","getContent","ttl","file_name","question","emoji","isMediaContent","getLocationId","width","height","zoom","scale","longitude","latitude","isVideoMessage","messageId","Boolean","isLottieMessage","toLowerCase","endsWith","isAnimationMessage","isContentOpened","is_listened","is_viewed","getMediaTitle","hasAudio","hasVideoNote","getSearchMessagesFilter","openAnimation","fileCancel","file","local","is_downloading_active","cancelGetRemoteFile","remote","is_uploading_active","cancelUploadFile","clientUpdate","send","message_id","openAudio","updateAudioBlob","openChatPhoto","photoSize","sizes","updatePhotoBlob","openContact","userId","openDocument","openGame","updateAnimationBlob","openPhoto","openSticker","set_id","stickerSet","openVideo","openVideoNote","videoNote","updateVideoNoteBlob","openVoiceNote","voiceNote","voice","updateVoiceNoteBlob","isDeletedMessage","getReplyPhotoSize","thumbnail","album_cover_thumbnail","getEmojiMatches","textContent","lastIndex","emojiMatches","m","re","exec","messageComparatorDesc","left","right","hasMention","contains_unread_mention","hasPinnedMessage","isMessageMuted"],"mappings":"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","sourcesContent":["/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport dateFormat from 'dateformat';\nimport emojiRegex from 'emoji-regex';\nimport Audio from '../Components/Message/Media/Audio';\nimport Animation from '../Components/Message/Media/Animation';\nimport Contact from '../Components/Message/Media/Contact';\nimport Document from '../Components/Message/Media/Document';\nimport Game from '../Components/Message/Media/Game';\nimport Location from '../Components/Message/Media/Location';\nimport MentionLink from '../Components/Additional/MentionLink';\nimport Photo from '../Components/Message/Media/Photo';\nimport Poll from '../Components/Message/Media/Poll';\nimport SafeLink from '../Components/Additional/SafeLink';\nimport Sticker, { StickerSourceEnum } from '../Components/Message/Media/Sticker';\nimport Venue from '../Components/Message/Media/Venue';\nimport Video from '../Components/Message/Media/Video';\nimport VideoNote from '../Components/Message/Media/VideoNote';\nimport VoiceNote from '../Components/Message/Media/VoiceNote';\nimport { searchChat, setMediaViewerContent } from '../Actions/Client';\nimport {\n    getChatDisableMentionNotifications,\n    getChatDisablePinnedMessageNotifications,\n    getChatTitle,\n    isChatMuted\n} from './Chat';\nimport { openUser } from './../Actions/Client';\nimport { getPhotoSize, getSize } from './Common';\nimport { download, saveOrDownload } from './File';\nimport { getAudioTitle } from './Media';\nimport { getServiceMessageContent } from './ServiceMessage';\nimport { getUserFullName } from './User';\nimport { LOCATION_HEIGHT, LOCATION_SCALE, LOCATION_WIDTH, LOCATION_ZOOM } from '../Constants';\nimport AppStore from '../Stores/ApplicationStore';\nimport ChatStore from '../Stores/ChatStore';\nimport FileStore from '../Stores/FileStore';\nimport MessageStore from '../Stores/MessageStore';\nimport UserStore from '../Stores/UserStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nfunction getAuthor(message) {\n    if (!message) return null;\n\n    const { forward_info } = message;\n\n    if (forward_info) {\n        switch (forward_info['@type']) {\n            case 'messageForwardedFromUser': {\n                if (forward_info.sender_user_id > 0) {\n                    const user = UserStore.get(forward_info.sender_user_id);\n                    if (user) {\n                        return getUserFullName(user);\n                    }\n                }\n                break;\n            }\n            case 'messageForwardedPost': {\n                const chat = ChatStore.get(forward_info.chat_id);\n                if (chat) {\n                    return chat.title;\n                }\n                break;\n            }\n        }\n    }\n\n    return getTitle(message);\n}\n\nfunction getTitle(message) {\n    if (!message) return null;\n\n    const { sender_user_id, chat_id } = message;\n\n    if (sender_user_id) {\n        const user = UserStore.get(sender_user_id);\n        if (user) {\n            return getUserFullName(user);\n        }\n    }\n\n    if (chat_id) {\n        const chat = ChatStore.get(chat_id);\n        if (chat) {\n            return chat.title;\n        }\n    }\n\n    return null;\n}\n\nfunction substring(text, start, end) {\n    if (start < 0) start = 0;\n    if (start > text.length - 1) start = text.length - 1;\n    if (end < start) end = start;\n    if (end > text.length) end = text.length;\n\n    return text.substring(start, end);\n}\n\nfunction stopPropagation(event) {\n    event.stopPropagation();\n}\n\nfunction searchCurrentChatByHashtag(event, hashtag) {\n    event.stopPropagation();\n    event.preventDefault();\n\n    const { chatId } = AppStore;\n\n    searchChat(chatId, hashtag);\n}\n\nfunction getFormattedText(text) {\n    if (text['@type'] !== 'formattedText') return null;\n    if (!text.text) return null;\n    if (!text.entities) return text.text;\n\n    let result = [];\n    let index = 0;\n    for (let i = 0; i < text.entities.length; i++) {\n        let beforeEntityText = substring(text.text, index, text.entities[i].offset);\n        if (beforeEntityText) {\n            result.push(beforeEntityText);\n        }\n\n        let entityText = substring(\n            text.text,\n            text.entities[i].offset,\n            text.entities[i].offset + text.entities[i].length\n        );\n        switch (text.entities[i].type['@type']) {\n            case 'textEntityTypeUrl': {\n                result.push(\n                    <SafeLink key={text.entities[i].offset} url={entityText}>\n                        {entityText}\n                    </SafeLink>\n                );\n                break;\n            }\n            case 'textEntityTypeTextUrl': {\n                let url = entityText;\n                const { url: typeUrl } = text.entities[i].type;\n                if (typeUrl) {\n                    url = typeUrl;\n                }\n\n                result.push(\n                    <SafeLink key={text.entities[i].offset} url={url}>\n                        {entityText}\n                    </SafeLink>\n                );\n                break;\n            }\n            case 'textEntityTypeBold':\n                result.push(<strong key={text.entities[i].offset}>{entityText}</strong>);\n                break;\n            case 'textEntityTypeItalic':\n                result.push(<em key={text.entities[i].offset}>{entityText}</em>);\n                break;\n            case 'textEntityTypeCode':\n                result.push(<code key={text.entities[i].offset}>{entityText}</code>);\n                break;\n            case 'textEntityTypePre':\n                result.push(\n                    <pre key={text.entities[i].offset}>\n                        <code>{entityText}</code>\n                    </pre>\n                );\n                break;\n            case 'textEntityTypeMention':\n                result.push(\n                    <MentionLink key={text.entities[i].offset} username={entityText}>\n                        {entityText}\n                    </MentionLink>\n                );\n                break;\n            case 'textEntityTypeMentionName':\n                result.push(\n                    <MentionLink key={text.entities[i].offset} userId={text.entities[i].type.user_id}>\n                        {entityText}\n                    </MentionLink>\n                );\n                break;\n            case 'textEntityTypeHashtag':\n                result.push(\n                    <a key={text.entities[i].offset} onClick={event => searchCurrentChatByHashtag(event, entityText)}>\n                        {entityText}\n                    </a>\n                );\n                break;\n            case 'textEntityTypeEmailAddress':\n                result.push(\n                    <a\n                        key={text.entities[i].offset}\n                        onClick={stopPropagation}\n                        href={`mailto:${entityText}`}\n                        target='_blank'\n                        rel='noopener noreferrer'>\n                        {entityText}\n                    </a>\n                );\n                break;\n            case 'textEntityTypeBotCommand':\n                let command = entityText.length > 0 && entityText[0] === '/' ? substring(entityText, 1) : entityText;\n                result.push(\n                    <a\n                        key={text.entities[i].offset}\n                        onClick={stopPropagation}\n                        href={`tg://bot_command?command=${command}&bot=`}>\n                        {entityText}\n                    </a>\n                );\n                break;\n            default:\n                result.push(entityText);\n                break;\n        }\n\n        index += beforeEntityText.length + entityText.length;\n    }\n\n    if (index < text.text.length) {\n        let afterEntityText = text.text.substring(index);\n        if (afterEntityText) {\n            result.push(afterEntityText);\n        }\n    }\n\n    return result;\n}\n\nfunction getText(message) {\n    if (!message) return null;\n\n    let text = [];\n\n    const { content } = message;\n\n    if (\n        content &&\n        content['@type'] === 'messageText' &&\n        content.text &&\n        content.text['@type'] === 'formattedText' &&\n        content.text.text\n    ) {\n        text = getFormattedText(content.text);\n    } else {\n        //text.push('[' + message.content['@type'] + ']');//JSON.stringify(x);\n        if (content && content.caption && content.caption['@type'] === 'formattedText' && content.caption.text) {\n            text.push('\\n');\n            let formattedText = getFormattedText(content.caption);\n            if (formattedText) {\n                text = text.concat(formattedText);\n            }\n        }\n    }\n\n    return text;\n}\n\nfunction getWebPage(message) {\n    if (!message) return null;\n    if (!message.content) return null;\n\n    return message.content.web_page;\n}\n\nfunction getDate(date) {\n    if (!date) return null;\n\n    const d = new Date(date * 1000);\n\n    return dateFormat(d, 'H:MM'); //date.toDateString();\n}\n\nfunction getDateHint(date) {\n    if (!date) return null;\n\n    const d = new Date(date * 1000);\n    return dateFormat(d, 'H:MM:ss d.mm.yyyy'); //date.toDateString();\n}\n\nfunction getMedia(message, openMedia) {\n    if (!message) return null;\n\n    const { chat_id, id, content } = message;\n    if (!content) return null;\n\n    switch (content['@type']) {\n        case 'messageAnimation':\n            return <Animation chatId={chat_id} messageId={id} animation={content.animation} openMedia={openMedia} />;\n        case 'messageAudio':\n            return <Audio chatId={chat_id} messageId={id} audio={content.audio} openMedia={openMedia} />;\n        case 'messageContact':\n            return <Contact chatId={chat_id} messageId={id} contact={content.contact} openMedia={openMedia} />;\n        case 'messageDocument':\n            return <Document chatId={chat_id} messageId={id} document={content.document} openMedia={openMedia} />;\n        case 'messageGame':\n            return <Game chatId={chat_id} messageId={id} game={content.game} openMedia={openMedia} />;\n        case 'messageLocation':\n            return <Location chatId={chat_id} messageId={id} location={content.location} openMedia={openMedia} />;\n        case 'messagePhoto':\n            return <Photo chatId={chat_id} messageId={id} photo={content.photo} openMedia={openMedia} />;\n        case 'messagePoll':\n            return <Poll chatId={chat_id} messageId={id} poll={content.poll} openMedia={openMedia} />;\n        case 'messageSticker':\n            return (\n                <Sticker\n                    chatId={chat_id}\n                    messageId={id}\n                    sticker={content.sticker}\n                    source={StickerSourceEnum.MESSAGE}\n                    openMedia={openMedia}\n                />\n            );\n        case 'messageText':\n            return null;\n        case 'messageVenue':\n            return <Venue chatId={chat_id} messageId={id} venue={content.venue} openMedia={openMedia} />;\n        case 'messageVideo':\n            return <Video chatId={chat_id} messageId={id} video={content.video} openMedia={openMedia} />;\n        case 'messageVideoNote':\n            return <VideoNote chatId={chat_id} messageId={id} videoNote={content.video_note} openMedia={openMedia} />;\n        case 'messageVoiceNote':\n            return <VoiceNote chatId={chat_id} messageId={id} voiceNote={content.voice_note} openMedia={openMedia} />;\n        default:\n            return '[' + content['@type'] + ']';\n    }\n}\n\nfunction isForwardOriginHidden(forwardInfo) {\n    if (!forwardInfo) return false;\n\n    const { origin } = forwardInfo;\n    if (!origin) return false;\n\n    switch (origin['@type']) {\n        case 'messageForwardOriginUser': {\n            return false;\n        }\n        case 'messageForwardOriginHiddenUser': {\n            return true;\n        }\n        case 'messageForwardOriginChannel': {\n            return false;\n        }\n    }\n\n    return false;\n}\n\nfunction getForwardTitle(forwardInfo, t = key => key) {\n    if (!forwardInfo) return '';\n\n    const { origin } = forwardInfo;\n    if (!origin) return '';\n\n    switch (origin['@type']) {\n        case 'messageForwardOriginUser': {\n            const { sender_user_id } = origin;\n\n            const user = UserStore.get(sender_user_id);\n            return getUserFullName(user);\n        }\n        case 'messageForwardOriginHiddenUser': {\n            const { sender_name } = origin;\n\n            return sender_name;\n        }\n        case 'messageForwardOriginChannel': {\n            const { chat_id, author_signature } = origin;\n\n            return getChatTitle(chat_id, false, t) + (author_signature ? ` (${author_signature})` : '');\n        }\n    }\n\n    return '';\n}\n\nfunction getUnread(message) {\n    if (!message) return false;\n    if (!message.chat_id) return false;\n    if (!message.is_outgoing) return false;\n\n    let chat = ChatStore.get(message.chat_id);\n    if (!chat) return false;\n\n    return chat.last_read_outbox_message_id < message.id;\n}\n\nfunction getSenderUserId(message) {\n    if (!message) return null;\n\n    return message.sender_user_id;\n}\n\nfunction filterDuplicateMessages(result, history) {\n    if (result.messages.length === 0) return;\n    if (history.length === 0) return;\n\n    const map = history.reduce(function(accumulator, current) {\n        accumulator.set(current.id, current.id);\n        return accumulator;\n    }, new Map());\n\n    result.messages = result.messages.filter(x => !map.has(x.id));\n}\n\nfunction filterMessages(messages) {\n    return messages.filter(x => x.content['@type'] !== 'messageChatUpgradeTo');\n}\n\nfunction getContent(message, t = key => key) {\n    if (!message) return null;\n\n    const { content } = message;\n    if (!content) return null;\n\n    let caption = '';\n    if (content.caption && content.caption.text) {\n        caption = `, ${content.caption.text}`;\n    }\n\n    if (message.ttl > 0) {\n        return getServiceMessageContent(message);\n    }\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            return t('AttachGif') + caption;\n        }\n        case 'messageAudio': {\n            return t('AttachMusic') + caption;\n        }\n        case 'messageBasicGroupChatCreate': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageCall': {\n            return t('Call') + caption;\n        }\n        case 'messageChatAddMembers': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatChangePhoto': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatChangeTitle': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatDeleteMember': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatDeletePhoto': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatJoinByLink': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatSetTtl': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatUpgradeFrom': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatUpgradeTo': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageContact': {\n            return t('AttachContact') + caption;\n        }\n        case 'messageContactRegistered': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageCustomServiceAction': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageDocument': {\n            const { document } = content;\n            if (document && document.file_name) {\n                return document.file_name + caption;\n            }\n\n            return t('AttachDocument') + caption;\n        }\n        case 'messageExpiredPhoto': {\n            return t('AttachPhoto') + caption;\n        }\n        case 'messageExpiredVideo': {\n            return t('AttachVideo') + caption;\n        }\n        case 'messageGame': {\n            return t('AttachGame') + caption;\n        }\n        case 'messageGameScore': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageInvoice': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageLocation': {\n            return t('AttachLocation') + caption;\n        }\n        case 'messagePassportDataReceived': {\n            return getServiceMessageContent(message);\n        }\n        case 'messagePassportDataSent': {\n            return getServiceMessageContent(message);\n        }\n        case 'messagePaymentSuccessful': {\n            return getServiceMessageContent(message);\n        }\n        case 'messagePaymentSuccessfulBot': {\n            return getServiceMessageContent(message);\n        }\n        case 'messagePhoto': {\n            return t('AttachPhoto') + caption;\n        }\n        case 'messagePoll': {\n            const { poll } = content;\n\n            return '📊 ' + (poll.question || t('Poll')) + caption;\n        }\n        case 'messagePinMessage': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageScreenshotTaken': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageSticker': {\n            const { sticker } = content;\n            let emoji = '';\n            if (sticker && sticker.emoji) {\n                emoji = sticker.emoji;\n            }\n\n            return t('AttachSticker') + (emoji ? ` ${emoji}` : '') + caption;\n        }\n        case 'messageSupergroupChatCreate': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageText': {\n            return content.text.text + caption;\n        }\n        case 'messageUnsupported': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageVenue': {\n            return t('AttachLocation') + caption;\n        }\n        case 'messageVideo': {\n            return t('AttachVideo') + caption;\n        }\n        case 'messageVideoNote': {\n            return t('AttachRound') + caption;\n        }\n        case 'messageVoiceNote': {\n            return t('AttachAudio') + caption;\n        }\n        case 'messageWebsiteConnected': {\n            return getServiceMessageContent(message);\n        }\n        default: {\n            return t('UnsupportedAttachment');\n        }\n    }\n}\n\nfunction isMediaContent(content) {\n    if (!content) return false;\n\n    return content['@type'] === 'messagePhoto';\n}\n\nfunction getLocationId(\n    location,\n    width = LOCATION_WIDTH,\n    height = LOCATION_HEIGHT,\n    zoom = LOCATION_ZOOM,\n    scale = LOCATION_SCALE\n) {\n    if (!location) return null;\n\n    const { longitude, latitude } = location;\n    return `loc=${latitude},${longitude}&size=${width},${height}&scale=${scale}&zoom=${zoom}`;\n}\n\nfunction isVideoMessage(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { content } = message;\n    if (!content) return false;\n\n    switch (content['@type']) {\n        case 'messageVideo': {\n            return true;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            return Boolean(web_page.video);\n        }\n        default: {\n            return false;\n        }\n    }\n}\n\nfunction isLottieMessage(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { content } = message;\n    if (!content) return false;\n\n    switch (content['@type']) {\n        case 'messageDocument': {\n            const { document } = content;\n            if (!document) return false;\n\n            const { file_name } = document;\n\n            return file_name && file_name.toLowerCase().endsWith('.json');\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (!web_page) return false;\n\n            const { document } = web_page;\n            if (!document) return false;\n\n            const { file_name } = document;\n\n            return file_name && file_name.toLowerCase().endsWith('.json');\n        }\n        default: {\n            return false;\n        }\n    }\n}\n\nfunction isAnimationMessage(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { content } = message;\n    if (!content) return false;\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            return true;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            return Boolean(web_page.animation);\n        }\n        default: {\n            return false;\n        }\n    }\n}\n\nfunction isContentOpened(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return true;\n\n    const { content } = message;\n    if (!content) return true;\n\n    switch (content['@type']) {\n        case 'messageVoiceNote': {\n            return content.is_listened;\n        }\n        case 'messageVideoNote': {\n            return content.is_viewed;\n        }\n        default: {\n            return true;\n        }\n    }\n}\n\nfunction getMediaTitle(message) {\n    if (!message) return null;\n\n    const { content } = message;\n    if (!content) return null;\n\n    switch (content['@type']) {\n        case 'messageAudio': {\n            const { audio } = content;\n            if (audio) {\n                return getAudioTitle(audio);\n            }\n            break;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { audio } = web_page;\n                if (audio) {\n                    return getAudioTitle(audio);\n                }\n                break;\n            }\n        }\n    }\n\n    return getAuthor(message);\n}\n\nfunction hasAudio(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { content } = message;\n    if (!content) return false;\n\n    switch (content['@type']) {\n        case 'messageAudio': {\n            const { audio } = content;\n            if (audio) {\n                return true;\n            }\n\n            break;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { audio } = web_page;\n                if (audio) {\n                    return true;\n                }\n            }\n\n            break;\n        }\n    }\n\n    return false;\n}\n\nfunction hasVideoNote(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { content } = message;\n    if (!content) return false;\n\n    switch (content['@type']) {\n        case 'messageVideoNote': {\n            const { video_note } = content;\n            if (video_note) {\n                return true;\n            }\n\n            break;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { video_note } = web_page;\n                if (video_note) {\n                    return true;\n                }\n            }\n\n            break;\n        }\n    }\n\n    return false;\n}\n\nfunction getSearchMessagesFilter(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return null;\n\n    const { content } = message;\n    if (!content) return null;\n\n    switch (content['@type']) {\n        case 'messageAudio': {\n            const { audio } = content;\n            if (audio) {\n                return {\n                    '@type': 'searchMessagesFilterAudio'\n                };\n            }\n            break;\n        }\n        case 'messageVoiceNote': {\n            const { voice_note } = content;\n            if (voice_note) {\n                return {\n                    '@type': 'searchMessagesFilterVoiceNote'\n                };\n            }\n            break;\n        }\n        case 'messageVideoNote': {\n            const { video_note } = content;\n            if (video_note) {\n                return null;\n\n                return {\n                    '@type': 'searchMessagesFilterVideoNote'\n                };\n            }\n            break;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { audio, voice_note, video_note } = web_page;\n                if (audio) {\n                    return null;\n\n                    return {\n                        '@type': 'searchMessagesFilterAudio'\n                    };\n                }\n\n                if (voice_note) {\n                    return null;\n\n                    return {\n                        '@type': 'searchMessagesFilterVoiceNote'\n                    };\n                }\n\n                if (video_note) {\n                    return null;\n\n                    return {\n                        '@type': 'searchMessagesFilterVideoNote'\n                    };\n                }\n                break;\n            }\n        }\n    }\n\n    return null;\n}\n\nfunction openAnimation(animation, message, fileCancel) {\n    if (!animation) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    let { animation: file } = animation;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    } else {\n        // download file at loadMediaViewerContent instead\n        // download(file, message, FileStore.updateAnimationBlob(chat_id, id, file.id));\n    }\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateActiveAnimation',\n        chatId: chat_id,\n        messageId: id\n    });\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    setMediaViewerContent({\n        chatId: chat_id,\n        messageId: id\n    });\n}\n\nfunction openAudio(audio, message, fileCancel) {\n    if (!audio) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    let { audio: file } = audio;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    } else {\n        download(file, message, () => FileStore.updateAudioBlob(chat_id, id, file.id));\n    }\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateMediaActive',\n        chatId: chat_id,\n        messageId: id\n    });\n}\n\nfunction openChatPhoto(photo, message, fileCancel) {\n    if (!photo) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    const photoSize = getPhotoSize(photo.sizes);\n    if (!photoSize) return;\n\n    let { photo: file } = photoSize;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    }\n\n    download(file, message, () => FileStore.updatePhotoBlob(chat_id, id, file.id));\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    setMediaViewerContent({\n        chatId: chat_id,\n        messageId: id\n    });\n}\n\nfunction openContact(contact, message, fileCancel) {\n    if (!contact) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    openUser(contact.userId);\n}\n\nfunction openDocument(document, message, fileCancel) {\n    if (!document) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    let { document: file } = document;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    }\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    if (isLottieMessage(chat_id, id)) {\n        TdLibController.send({\n            '@type': 'openMessageContent',\n            chat_id: chat_id,\n            message_id: id\n        });\n\n        setMediaViewerContent({\n            chatId: chat_id,\n            messageId: id\n        });\n    } else {\n        saveOrDownload(file, document.file_name, message);\n    }\n}\n\nfunction openGame(game, message, fileCancel) {\n    if (!game) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    const { animation } = game;\n    if (animation) {\n        let { animation: file } = animation;\n        if (!file) return;\n\n        file = FileStore.get(file.id) || file;\n        if (fileCancel && file.local.is_downloading_active) {\n            FileStore.cancelGetRemoteFile(file.id, message);\n            return;\n        } else if (fileCancel && file.remote.is_uploading_active) {\n            FileStore.cancelUploadFile(file.id, message);\n            return;\n        }\n\n        download(file, message, () => FileStore.updateAnimationBlob(chat_id, id, file.id));\n    }\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateActiveAnimation',\n        chatId: chat_id,\n        messageId: id\n    });\n}\n\nfunction openPhoto(photo, message, fileCancel) {\n    if (!photo) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    const photoSize = getPhotoSize(photo.sizes);\n    if (!photoSize) return;\n\n    let { photo: file } = photoSize;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    }\n\n    download(file, message, () => FileStore.updatePhotoBlob(chat_id, id, file.id));\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    setMediaViewerContent({\n        chatId: chat_id,\n        messageId: id\n    });\n}\n\nasync function openSticker(sticker, message, fileCancel) {\n    if (!sticker) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    const { set_id } = sticker;\n    if (!set_id) return;\n\n    const stickerSet = await TdLibController.send({\n        '@type': 'getStickerSet',\n        set_id\n    });\n\n    if (!stickerSet) return;\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateStickerSet',\n        stickerSet\n    });\n}\n\nfunction openVideo(video, message, fileCancel) {\n    if (!video) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    let { video: file } = video;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    }\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    setMediaViewerContent({\n        chatId: chat_id,\n        messageId: id\n    });\n}\n\nfunction openVideoNote(videoNote, message, fileCancel) {\n    if (!videoNote) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    let { video: file } = videoNote;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    }\n\n    download(file, message, () => FileStore.updateVideoNoteBlob(chat_id, id, file.id));\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateMediaActive',\n        chatId: chat_id,\n        messageId: id\n    });\n}\n\nfunction openVoiceNote(voiceNote, message, fileCancel) {\n    if (!voiceNote) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    let { voice: file } = voiceNote;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    } else {\n        download(file, message, () => FileStore.updateVoiceNoteBlob(chat_id, id, file.id));\n    }\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateMediaActive',\n        chatId: chat_id,\n        messageId: id\n    });\n}\n\nfunction openMedia(chatId, messageId, fileCancel = true) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return;\n\n    const { content } = message;\n    if (!content) return null;\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            const { animation } = content;\n            if (animation) {\n                openAnimation(animation, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageAudio': {\n            const { audio } = content;\n            if (audio) {\n                openAudio(audio, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageChatChangePhoto': {\n            const { photo } = content;\n            if (photo) {\n                openChatPhoto(photo, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageContact': {\n            const { contact } = content;\n            if (contact) {\n                openContact(contact, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageDocument': {\n            const { document } = content;\n            if (document) {\n                openDocument(document, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageGame': {\n            const { game } = content;\n            if (game) {\n                openGame(game, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messagePhoto': {\n            const { photo } = content;\n            if (photo) {\n                openPhoto(photo, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageSticker': {\n            const { sticker } = content;\n            if (sticker) {\n                openSticker(sticker, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { animation, audio, document, photo, sticker, video, video_note, voice_note } = web_page;\n\n                if (animation) {\n                    openAnimation(animation, message, fileCancel);\n                }\n\n                if (audio) {\n                    openAudio(audio, message, fileCancel);\n                }\n\n                if (document) {\n                    openDocument(document, message, fileCancel);\n                }\n\n                if (sticker) {\n                    openSticker(sticker, message, fileCancel);\n                }\n\n                if (video) {\n                    openVideo(video, message, fileCancel);\n                }\n\n                if (video_note) {\n                    openVideoNote(video_note, message, fileCancel);\n                }\n\n                if (voice_note) {\n                    openVoiceNote(voice_note, message, fileCancel);\n                }\n\n                if (photo) {\n                    openPhoto(photo, message, fileCancel);\n                }\n            }\n\n            break;\n        }\n        case 'messageVideo': {\n            const { video } = content;\n            if (video) {\n                openVideo(video, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageVideoNote': {\n            const { video_note } = content;\n            if (video_note) {\n                openVideoNote(video_note, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageVoiceNote': {\n            const { voice_note } = content;\n            if (voice_note) {\n                openVoiceNote(voice_note, message, fileCancel);\n            }\n\n            break;\n        }\n    }\n}\n\nfunction isDeletedMessage(message) {\n    return message && message['@type'] === 'deletedMessage';\n}\n\nfunction getReplyPhotoSize(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return;\n\n    const { content } = message;\n    if (!content) return null;\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            const { animation } = content;\n            if (!animation) return null;\n\n            const { thumbnail } = animation;\n            return thumbnail || null;\n        }\n        case 'messageAudio': {\n            const { audio } = content;\n            if (!audio) return null;\n\n            const { album_cover_thumbnail } = audio;\n            return album_cover_thumbnail || null;\n        }\n        case 'messageChatChangePhoto': {\n            const { photo } = content;\n            if (!photo) return null;\n\n            return getPhotoSize(photo.sizes);\n        }\n        case 'messageDocument': {\n            const { document } = content;\n            if (!document) return null;\n\n            const { thumbnail } = document;\n            return thumbnail || null;\n        }\n        case 'messageGame': {\n            const { game } = content;\n            if (!game) return null;\n\n            const { animation, photo } = game;\n            if (animation) {\n                const { thumbnail } = animation;\n                if (thumbnail) {\n                    return thumbnail;\n                }\n            }\n\n            if (photo) {\n                return getPhotoSize(photo.sizes);\n            }\n\n            return null;\n        }\n        case 'messagePhoto': {\n            const { photo } = content;\n            if (!photo) return null;\n\n            return getPhotoSize(photo.sizes);\n        }\n        case 'messageSticker': {\n            const { sticker } = content;\n            if (!sticker) return null;\n\n            const { thumbnail } = sticker;\n            return thumbnail || null;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { animation, audio, document, photo, sticker, video, video_note } = web_page;\n                if (photo) {\n                    return getPhotoSize(photo.sizes);\n                }\n                if (animation) {\n                    const { thumbnail } = animation;\n                    return thumbnail || null;\n                }\n                if (audio) {\n                    const { album_cover_thumbnail } = audio;\n                    return album_cover_thumbnail || null;\n                }\n                if (document) {\n                    const { thumbnail } = document;\n                    return thumbnail || null;\n                }\n                if (sticker) {\n                    const { thumbnail } = sticker;\n                    return thumbnail || null;\n                }\n                if (video) {\n                    const { thumbnail } = video;\n                    return thumbnail || null;\n                }\n                if (video_note) {\n                    const { thumbnail } = video_note;\n                    return thumbnail || null;\n                }\n            }\n\n            break;\n        }\n        case 'messageVideo': {\n            const { video } = content;\n            if (!video) return null;\n\n            const { thumbnail } = video;\n            return thumbnail || null;\n        }\n        case 'messageVideoNote': {\n            const { video_note } = content;\n            if (!video_note) return null;\n\n            const { thumbnail } = video_note;\n            return thumbnail || null;\n        }\n    }\n\n    return null;\n}\n\nfunction getEmojiMatches(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return 0;\n\n    const { content } = message;\n    if (!content) return 0;\n    if (content['@type'] !== 'messageText') return 0;\n\n    const { text: textContent } = content;\n    if (!textContent) return;\n    if (textContent['@type'] !== 'formattedText') return 0;\n\n    const { text, entities } = textContent;\n    if (!text) return 0;\n    if (entities && entities.length > 0) return 0;\n\n    let lastIndex = 0;\n    let emojiMatches = 0;\n    let m;\n    const re = emojiRegex();\n    do {\n        m = re.exec(text);\n\n        if (m) {\n            emojiMatches += 1;\n            // none-emoji symbol between prev and current emojis or before first\n            if (lastIndex !== m.index) {\n                emojiMatches = 0;\n                break;\n            }\n            // more than 3 emojis in a row\n            if (emojiMatches > 3) {\n                emojiMatches = 0;\n                break;\n            }\n            lastIndex = re.lastIndex;\n        }\n        // none-emoji symbol at the end\n        if (!m && lastIndex !== text.length) {\n            emojiMatches = 0;\n            break;\n        }\n    } while (m);\n\n    return emojiMatches;\n}\n\nfunction messageComparatorDesc(left, right) {\n    return left.id - right.id;\n}\n\nexport function hasMention(message) {\n    return message && message.contains_unread_mention;\n}\n\nexport function hasPinnedMessage(message) {\n    return message && message.content['@type'] === 'messagePinMessage';\n}\n\nexport function isMessageMuted(message) {\n    const { chat_id } = message;\n\n    if (hasMention(message)) {\n        return getChatDisableMentionNotifications(chat_id);\n    }\n    if (hasPinnedMessage(message)) {\n        return getChatDisablePinnedMessageNotifications(chat_id);\n    }\n\n    return isChatMuted(chat_id);\n}\n\nexport {\n    getAuthor,\n    getTitle,\n    getText,\n    getFormattedText,\n    getWebPage,\n    getContent,\n    getDate,\n    getDateHint,\n    getMedia,\n    isForwardOriginHidden,\n    getForwardTitle,\n    getUnread,\n    getSenderUserId,\n    filterDuplicateMessages,\n    filterMessages,\n    isMediaContent,\n    isDeletedMessage,\n    isVideoMessage,\n    isAnimationMessage,\n    isLottieMessage,\n    getLocationId,\n    isContentOpened,\n    getMediaTitle,\n    hasAudio,\n    hasVideoNote,\n    getSearchMessagesFilter,\n    openMedia,\n    getReplyPhotoSize,\n    getEmojiMatches,\n    messageComparatorDesc,\n    substring,\n    stopPropagation\n};\n"]},"metadata":{},"sourceType":"module"}