{"ast":null,"code":"import _classCallCheck from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _defineProperty from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */import React from'react';import*as ReactDOM from'react-dom';import classNames from'classnames';import withStyles from'@material-ui/core/styles/withStyles';import Animator from'../../Utils/Animatior';import Sticker from'./../Message/Media/Sticker';import{accentStyles,borderStyle}from'../Theme';import{ANIMATION_DURATION_200MS}from'../../Constants';import{StickerSourceEnum}from'../Message/Media/Sticker';import StickerStore from'../../Stores/StickerStore';import'./StickersPickerHeader.css';var styles=function styles(theme){return _objectSpread({},borderStyle(theme),{},accentStyles(theme));};var StickersPickerHeader=/*#__PURE__*/function(_React$Component){_inherits(StickersPickerHeader,_React$Component);function StickersPickerHeader(props){var _this;_classCallCheck(this,StickersPickerHeader);_this=_possibleConstructorReturn(this,_getPrototypeOf(StickersPickerHeader).call(this,props));_this.onClientUpdateStickerSetPosition=function(update){var position=update.position;_this.setState({position:position});};_this.scrollToPosition=function(){var position=_this.state.position;var _assertThisInitialize=_assertThisInitialized(_this),animator=_assertThisInitialize.animator,anchorRef=_assertThisInitialize.anchorRef,scrollRef=_assertThisInitialize.scrollRef;var scroll=scrollRef.current;var anchor=anchorRef.current;var anchorNode=ReactDOM.findDOMNode(anchor);var scrollFrom=scroll.scrollLeft;var scrollTo=position*44-147;var anchorFrom=Number(anchorNode.style.left.replace('px',''));var anchorTo=position*44;if(animator){animator.stop();}_this.animator=new Animator(ANIMATION_DURATION_200MS,[{from:scrollFrom,to:scrollTo,func:function func(left){return scroll.scrollLeft=left;}},{from:Math.abs(anchorTo-anchorFrom)>338?anchorTo-Math.sign(anchorTo-anchorFrom)*338:anchorFrom,to:anchorTo,func:function func(left){return anchorNode.style.left=left+'px';}}]);_this.animator.start();};_this.handleWheel=function(event){var _assertThisInitialize2=_assertThisInitialized(_this),scrollRef=_assertThisInitialize2.scrollRef;if(event.deltaX===0){var scroll=scrollRef.current;scroll.scrollLeft+=event.deltaY;}};_this.handleSelect=function(sticker){var _this$props=_this.props,stickers=_this$props.stickers,onSelect=_this$props.onSelect;onSelect(stickers.indexOf(sticker));};_this.state={position:0};_this.scrollRef=React.createRef();_this.anchorRef=React.createRef();return _this;}_createClass(StickersPickerHeader,[{key:\"componentDidMount\",value:function componentDidMount(){StickerStore.on('clientUpdateStickerSetPosition',this.onClientUpdateStickerSetPosition);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){StickerStore.removeListener('clientUpdateStickerSetPosition',this.onClientUpdateStickerSetPosition);}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState,snapshot){if(prevState.position!==this.state.position){this.scrollToPosition();}}},{key:\"render\",value:function render(){var _this2=this;var _this$props2=this.props,classes=_this$props2.classes,stickers=_this$props2.stickers;var items=stickers.map(function(x){return React.createElement(Sticker,{key:x.sticker.id,className:\"stickers-picker-header-sticker\",sticker:x,autoplay:false,blur:false,displaySize:32,preview:true,source:StickerSourceEnum.PICKER_HEADER,openMedia:function openMedia(){return _this2.handleSelect(x);}});});return React.createElement(\"div\",{className:classNames('stickers-picker-header',classes.borderColor)},React.createElement(\"div\",{ref:this.scrollRef,className:\"stickers-picker-header-scroll\",onWheel:this.handleWheel},React.createElement(\"div\",{className:\"stickers-picker-header-items\"},items),React.createElement(\"div\",{ref:this.anchorRef,className:classNames('stickers-picker-header-anchor',classes.accentBackgroundDark)})));}}]);return StickersPickerHeader;}(React.Component);export default withStyles(styles)(StickersPickerHeader);","map":{"version":3,"sources":["/Users/yosuahalim/Documents/Projects/telegram-app/src/Components/ColumnMiddle/StickersPickerHeader.js"],"names":["React","ReactDOM","classNames","withStyles","Animator","Sticker","accentStyles","borderStyle","ANIMATION_DURATION_200MS","StickerSourceEnum","StickerStore","styles","theme","StickersPickerHeader","props","onClientUpdateStickerSetPosition","update","position","setState","scrollToPosition","state","animator","anchorRef","scrollRef","scroll","current","anchor","anchorNode","findDOMNode","scrollFrom","scrollLeft","scrollTo","anchorFrom","Number","style","left","replace","anchorTo","stop","from","to","func","Math","abs","sign","start","handleWheel","event","deltaX","deltaY","handleSelect","sticker","stickers","onSelect","indexOf","createRef","on","removeListener","prevProps","prevState","snapshot","classes","items","map","x","id","PICKER_HEADER","borderColor","accentBackgroundDark","Component"],"mappings":"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","sourcesContent":["/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport withStyles from '@material-ui/core/styles/withStyles';\nimport Animator from '../../Utils/Animatior';\nimport Sticker from './../Message/Media/Sticker';\nimport { accentStyles, borderStyle } from '../Theme';\nimport { ANIMATION_DURATION_200MS } from '../../Constants';\nimport { StickerSourceEnum } from '../Message/Media/Sticker';\nimport StickerStore from '../../Stores/StickerStore';\nimport './StickersPickerHeader.css';\n\nconst styles = theme => ({\n    ...borderStyle(theme),\n    ...accentStyles(theme)\n});\n\nclass StickersPickerHeader extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = { position: 0 };\n\n        this.scrollRef = React.createRef();\n        this.anchorRef = React.createRef();\n    }\n\n    componentDidMount() {\n        StickerStore.on('clientUpdateStickerSetPosition', this.onClientUpdateStickerSetPosition);\n    }\n\n    componentWillUnmount() {\n        StickerStore.removeListener('clientUpdateStickerSetPosition', this.onClientUpdateStickerSetPosition);\n    }\n\n    onClientUpdateStickerSetPosition = update => {\n        const { position } = update;\n\n        this.setState({ position });\n    };\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if (prevState.position !== this.state.position) {\n            this.scrollToPosition();\n        }\n    }\n\n    scrollToPosition = () => {\n        const { position } = this.state;\n        const { animator, anchorRef, scrollRef } = this;\n\n        const scroll = scrollRef.current;\n        const anchor = anchorRef.current;\n        const anchorNode = ReactDOM.findDOMNode(anchor);\n\n        const scrollFrom = scroll.scrollLeft;\n        const scrollTo = position * 44 - 147;\n\n        const anchorFrom = Number(anchorNode.style.left.replace('px', ''));\n        const anchorTo = position * 44;\n\n        if (animator) {\n            animator.stop();\n        }\n        this.animator = new Animator(ANIMATION_DURATION_200MS, [\n            {\n                from: scrollFrom,\n                to: scrollTo,\n                func: left => (scroll.scrollLeft = left)\n            },\n            {\n                from:\n                    Math.abs(anchorTo - anchorFrom) > 338\n                        ? anchorTo - Math.sign(anchorTo - anchorFrom) * 338\n                        : anchorFrom,\n                to: anchorTo,\n                func: left => (anchorNode.style.left = left + 'px')\n            }\n        ]);\n        this.animator.start();\n    };\n\n    handleWheel = event => {\n        const { scrollRef } = this;\n\n        if (event.deltaX === 0) {\n            const scroll = scrollRef.current;\n\n            scroll.scrollLeft += event.deltaY;\n        }\n    };\n\n    handleSelect = sticker => {\n        const { stickers, onSelect } = this.props;\n\n        onSelect(stickers.indexOf(sticker));\n    };\n\n    render() {\n        const { classes, stickers } = this.props;\n\n        const items = stickers.map(x => (\n            <Sticker\n                key={x.sticker.id}\n                className='stickers-picker-header-sticker'\n                sticker={x}\n                autoplay={false}\n                blur={false}\n                displaySize={32}\n                preview\n                source={StickerSourceEnum.PICKER_HEADER}\n                openMedia={() => this.handleSelect(x)}\n            />\n        ));\n\n        return (\n            <div className={classNames('stickers-picker-header', classes.borderColor)}>\n                <div ref={this.scrollRef} className='stickers-picker-header-scroll' onWheel={this.handleWheel}>\n                    <div className='stickers-picker-header-items'>{items}</div>\n                    <div\n                        ref={this.anchorRef}\n                        className={classNames('stickers-picker-header-anchor', classes.accentBackgroundDark)}\n                    />\n                </div>\n            </div>\n        );\n    }\n}\n\nStickersPickerHeader.propTypes = {\n    stickers: PropTypes.array.isRequired,\n    onSelect: PropTypes.func.isRequired\n};\n\nexport default withStyles(styles)(StickersPickerHeader);\n"]},"metadata":{},"sourceType":"module"}