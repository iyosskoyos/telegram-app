{"ast":null,"code":"import _regeneratorRuntime from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */import{loadInstantViewContent}from'../Utils/File';import{setInstantViewContent}from'./Client';import TdLibController from'../Controllers/TdLibController';var timestamp=null;export function openInstantView(_x){return _openInstantView.apply(this,arguments);}function _openInstantView(){_openInstantView=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(url){var now,result,newWindow;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;now=timestamp=new Date();_context.next=4;return TdLibController.send({'@type':'getWebPageInstantView',url:url,force_full:true});case 4:result=_context.sent;if(!(timestamp!==now)){_context.next=7;break;}return _context.abrupt(\"return\");case 7:console.log('[IV] open',result);loadInstantViewContent(result);setInstantViewContent({instantView:result});_context.next=17;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);newWindow=window.open();newWindow.opener=null;newWindow.location=url;case 17:case\"end\":return _context.stop();}}},_callee,null,[[0,12]]);}));return _openInstantView.apply(this,arguments);}","map":{"version":3,"sources":["/Users/yosuahalim/Documents/Projects/telegram-app/src/Actions/InstantView.js"],"names":["loadInstantViewContent","setInstantViewContent","TdLibController","timestamp","openInstantView","url","now","Date","send","force_full","result","console","log","instantView","newWindow","window","open","opener","location"],"mappings":"qQAAA;;;;;GAOA,OAASA,sBAAT,KAAuC,eAAvC,CACA,OAASC,qBAAT,KAAsC,UAAtC,CACA,MAAOC,CAAAA,eAAP,KAA4B,gCAA5B,CAEA,GAAIC,CAAAA,SAAS,CAAG,IAAhB,CAEA,eAAsBC,CAAAA,eAAtB,oD,qGAAO,iBAA+BC,GAA/B,2JAEOC,GAFP,CAEcH,SAAS,CAAG,GAAII,CAAAA,IAAJ,EAF1B,uBAGsBL,CAAAA,eAAe,CAACM,IAAhB,CAAqB,CACtC,QAAS,uBAD6B,CAEtCH,GAAG,CAAHA,GAFsC,CAGtCI,UAAU,CAAE,IAH0B,CAArB,CAHtB,QAGOC,MAHP,oBAQKP,SAAS,GAAKG,GARnB,kEAUCK,OAAO,CAACC,GAAR,CAAY,WAAZ,CAAyBF,MAAzB,EACAV,sBAAsB,CAACU,MAAD,CAAtB,CACAT,qBAAqB,CAAC,CAAEY,WAAW,CAAEH,MAAf,CAAD,CAArB,CAZD,iFAcOI,SAdP,CAcmBC,MAAM,CAACC,IAAP,EAdnB,CAeCF,SAAS,CAACG,MAAV,CAAmB,IAAnB,CACAH,SAAS,CAACI,QAAV,CAAqBb,GAArB,CAhBD,qE","sourcesContent":["/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { loadInstantViewContent } from '../Utils/File';\nimport { setInstantViewContent } from './Client';\nimport TdLibController from '../Controllers/TdLibController';\n\nlet timestamp = null;\n\nexport async function openInstantView(url) {\n    try {\n        const now = (timestamp = new Date());\n        const result = await TdLibController.send({\n            '@type': 'getWebPageInstantView',\n            url,\n            force_full: true\n        });\n        if (timestamp !== now) return;\n\n        console.log('[IV] open', result);\n        loadInstantViewContent(result);\n        setInstantViewContent({ instantView: result });\n    } catch {\n        const newWindow = window.open();\n        newWindow.opener = null;\n        newWindow.location = url;\n    }\n}\n"]},"metadata":{},"sourceType":"module"}