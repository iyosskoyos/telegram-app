{"ast":null,"code":"import _slicedToArray from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _classCallCheck from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/inherits\";/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */import React from'react';import classNames from'classnames';import{compose}from'recompose';import{withIV}from'../InstantView/IVContext';import{withTranslation}from'react-i18next';import CloseIcon from'@material-ui/icons/Close';import NavigateNextIcon from'@material-ui/icons/NavigateNext';import NavigateBeforeIcon from'@material-ui/icons/NavigateBefore';import ReplyIcon from'@material-ui/icons/Reply';import InstantViewMediaViewerContent from'./InstantViewMediaViewerContent';import MediaViewerButton from'./MediaViewerButton';import MediaViewerFooterText from'./MediaViewerFooterText';import MediaViewerFooterButton from'./MediaViewerFooterButton';import MediaViewerDownloadButton from'./MediaViewerDownloadButton';import{getBlockCaption,getBlockMedia,getBlockUrl,getValidMediaBlocks}from'../../Utils/InstantView';import{getViewerFile,saveMedia}from'../../Utils/File';import{setInstantViewViewerContent}from'../../Actions/Client';import TdLibController from'../../Controllers/TdLibController';import'./InstantViewMediaViewer.css';var forwardIconStyle={padding:20,transform:'scaleX(-1)'};var InstantViewMediaViewer=/*#__PURE__*/function(_React$Component){_inherits(InstantViewMediaViewer,_React$Component);function InstantViewMediaViewer(){var _getPrototypeOf2;var _this;_classCallCheck(this,InstantViewMediaViewer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(InstantViewMediaViewer)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={index:-1,hasPreviousMedia:false,hasNextMedia:false,blocks:[]};_this.onKeyDown=function(event){if(event.keyCode===39){_this.handlePrevious();}else if(event.keyCode===37){_this.handleNext();}};_this.handlePrevious=function(event){if(event){event.stopPropagation();}var _this$state=_this.state,index=_this$state.index,blocks=_this$state.blocks;var nextIndex=index+1;if(!_this.hasPreviousMedia(index,blocks))return;_this.setState({index:nextIndex,hasPreviousMedia:_this.hasPreviousMedia(nextIndex,blocks),hasNextMedia:_this.hasNextMedia(nextIndex,blocks)});};_this.handleNext=function(event){if(event){event.stopPropagation();}var _this$state2=_this.state,index=_this$state2.index,blocks=_this$state2.blocks;var nextIndex=index-1;if(!_this.hasNextMedia(index,blocks))return;_this.setState({index:nextIndex,hasPreviousMedia:_this.hasPreviousMedia(nextIndex,blocks),hasNextMedia:_this.hasNextMedia(nextIndex,blocks)});};_this.handleClose=function(){setInstantViewViewerContent(null);};_this.handleForward=function(){var media=_this.props.media;TdLibController.clientUpdate({'@type':'clientUpdateForward',info:{media:media}});};_this.handleSave=function(){var media=_this.props.media;saveMedia(media,null);};return _this;}_createClass(InstantViewMediaViewer,[{key:\"componentDidMount\",value:function componentDidMount(){this.loadContent();document.addEventListener('keydown',this.onKeyDown,false);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){document.removeEventListener('keydown',this.onKeyDown,false);}},{key:\"loadContent\",value:function loadContent(){var _this$props=this.props,iv=_this$props.iv,media=_this$props.media;var blocks=getValidMediaBlocks(iv);var index=blocks.findIndex(function(x){return getBlockMedia(x)===media;});this.setState({blocks:blocks,index:index,hasPreviousMedia:this.hasPreviousMedia(index,blocks),hasNextMedia:this.hasNextMedia(index,blocks)});}},{key:\"hasPreviousMedia\",value:function hasPreviousMedia(index,blocks){if(index===-1)return false;var nextIndex=index+1;return nextIndex<blocks.length;}},{key:\"hasNextMedia\",value:function hasNextMedia(index,blocks){if(index===-1)return false;var nextIndex=index-1;return nextIndex>=0;}},{key:\"render\",value:function render(){var _this$props2=this.props,size=_this$props2.size,t=_this$props2.t;var _this$state3=this.state,index=_this$state3.index,blocks=_this$state3.blocks,hasNextMedia=_this$state3.hasNextMedia,hasPreviousMedia=_this$state3.hasPreviousMedia;if(!blocks)return null;if(index===-1)return null;var block=blocks[index];var media=getBlockMedia(block);var caption=getBlockCaption(block);var url=getBlockUrl(block);var _getViewerFile=getViewerFile(media,size),_getViewerFile2=_slicedToArray(_getViewerFile,3),width=_getViewerFile2[0],height=_getViewerFile2[1],file=_getViewerFile2[2];var title='';if(media['@type']==='photo'){title=t('AttachPhoto');}if(media['@type']==='video'){title=t('AttachVideo');}else if(media['@type']==='animation'){title=t('AttachGif');}var maxCount=blocks.length;return React.createElement(\"div\",{className:classNames('instant-view-media-viewer','media-viewer-default')},React.createElement(\"div\",{className:\"media-viewer-wrapper\"},React.createElement(\"div\",{className:\"media-viewer-left-column\"},React.createElement(\"div\",{className:\"media-viewer-button-placeholder\"}),React.createElement(MediaViewerButton,{disabled:!hasNextMedia,grow:true,onClick:this.handleNext},React.createElement(NavigateBeforeIcon,{fontSize:\"large\"}))),React.createElement(\"div\",{className:\"media-viewer-content-column\"},React.createElement(InstantViewMediaViewerContent,{media:media,size:size,caption:caption,url:url})),React.createElement(\"div\",{className:\"media-viewer-right-column\"},React.createElement(MediaViewerButton,{onClick:this.handleClose},React.createElement(CloseIcon,{fontSize:\"large\"})),React.createElement(MediaViewerButton,{disabled:!hasPreviousMedia,grow:true,onClick:this.handlePrevious},React.createElement(NavigateNextIcon,{fontSize:\"large\"})))),React.createElement(\"div\",{className:\"media-viewer-footer\"},React.createElement(MediaViewerFooterText,{title:title,subtitle:maxCount&&index>=0?\"\".concat(index+1,\" of \").concat(maxCount):null,style:{marginLeft:128}}),React.createElement(MediaViewerDownloadButton,{title:t('Save'),fileId:file.id,onClick:this.handleSave}),React.createElement(MediaViewerFooterButton,{title:t('Forward'),onClick:this.handleForward},React.createElement(ReplyIcon,{style:forwardIconStyle}))));}}]);return InstantViewMediaViewer;}(React.Component);var enhance=compose(withTranslation(),withIV);export default enhance(InstantViewMediaViewer);","map":{"version":3,"sources":["/Users/yosuahalim/Documents/Projects/telegram-app/src/Components/Viewer/InstantViewMediaViewer.js"],"names":["React","classNames","compose","withIV","withTranslation","CloseIcon","NavigateNextIcon","NavigateBeforeIcon","ReplyIcon","InstantViewMediaViewerContent","MediaViewerButton","MediaViewerFooterText","MediaViewerFooterButton","MediaViewerDownloadButton","getBlockCaption","getBlockMedia","getBlockUrl","getValidMediaBlocks","getViewerFile","saveMedia","setInstantViewViewerContent","TdLibController","forwardIconStyle","padding","transform","InstantViewMediaViewer","state","index","hasPreviousMedia","hasNextMedia","blocks","onKeyDown","event","keyCode","handlePrevious","handleNext","stopPropagation","nextIndex","setState","handleClose","handleForward","media","props","clientUpdate","info","handleSave","loadContent","document","addEventListener","removeEventListener","iv","findIndex","x","length","size","t","block","caption","url","width","height","file","title","maxCount","marginLeft","id","Component","enhance"],"mappings":"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","sourcesContent":["/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { compose } from 'recompose';\nimport { withIV } from '../InstantView/IVContext';\nimport { withTranslation } from 'react-i18next';\nimport CloseIcon from '@material-ui/icons/Close';\nimport NavigateNextIcon from '@material-ui/icons/NavigateNext';\nimport NavigateBeforeIcon from '@material-ui/icons/NavigateBefore';\nimport ReplyIcon from '@material-ui/icons/Reply';\nimport InstantViewMediaViewerContent from './InstantViewMediaViewerContent';\nimport MediaViewerButton from './MediaViewerButton';\nimport MediaViewerFooterText from './MediaViewerFooterText';\nimport MediaViewerFooterButton from './MediaViewerFooterButton';\nimport MediaViewerDownloadButton from './MediaViewerDownloadButton';\nimport { getBlockCaption, getBlockMedia, getBlockUrl, getValidMediaBlocks } from '../../Utils/InstantView';\nimport { getViewerFile, saveMedia } from '../../Utils/File';\nimport { setInstantViewViewerContent } from '../../Actions/Client';\nimport TdLibController from '../../Controllers/TdLibController';\nimport './InstantViewMediaViewer.css';\n\nconst forwardIconStyle = {\n    padding: 20,\n    transform: 'scaleX(-1)'\n};\n\nclass InstantViewMediaViewer extends React.Component {\n    state = {\n        index: -1,\n        hasPreviousMedia: false,\n        hasNextMedia: false,\n        blocks: []\n    };\n\n    componentDidMount() {\n        this.loadContent();\n\n        document.addEventListener('keydown', this.onKeyDown, false);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('keydown', this.onKeyDown, false);\n    }\n\n    onKeyDown = event => {\n        if (event.keyCode === 39) {\n            this.handlePrevious();\n        } else if (event.keyCode === 37) {\n            this.handleNext();\n        }\n    };\n\n    loadContent() {\n        const { iv, media } = this.props;\n\n        const blocks = getValidMediaBlocks(iv);\n        const index = blocks.findIndex(x => getBlockMedia(x) === media);\n\n        this.setState({\n            blocks,\n            index,\n            hasPreviousMedia: this.hasPreviousMedia(index, blocks),\n            hasNextMedia: this.hasNextMedia(index, blocks)\n        });\n    }\n\n    hasPreviousMedia(index, blocks) {\n        if (index === -1) return false;\n\n        const nextIndex = index + 1;\n        return nextIndex < blocks.length;\n    }\n\n    handlePrevious = event => {\n        if (event) {\n            event.stopPropagation();\n        }\n\n        const { index, blocks } = this.state;\n        const nextIndex = index + 1;\n\n        if (!this.hasPreviousMedia(index, blocks)) return;\n\n        this.setState({\n            index: nextIndex,\n            hasPreviousMedia: this.hasPreviousMedia(nextIndex, blocks),\n            hasNextMedia: this.hasNextMedia(nextIndex, blocks)\n        });\n    };\n\n    hasNextMedia(index, blocks) {\n        if (index === -1) return false;\n\n        const nextIndex = index - 1;\n        return nextIndex >= 0;\n    }\n\n    handleNext = event => {\n        if (event) {\n            event.stopPropagation();\n        }\n\n        const { index, blocks } = this.state;\n        const nextIndex = index - 1;\n\n        if (!this.hasNextMedia(index, blocks)) return;\n\n        this.setState({\n            index: nextIndex,\n            hasPreviousMedia: this.hasPreviousMedia(nextIndex, blocks),\n            hasNextMedia: this.hasNextMedia(nextIndex, blocks)\n        });\n    };\n\n    handleClose = () => {\n        setInstantViewViewerContent(null);\n    };\n\n    handleForward = () => {\n        const { media } = this.props;\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateForward',\n            info: { media }\n        });\n    };\n\n    handleSave = () => {\n        const { media } = this.props;\n\n        saveMedia(media, null);\n    };\n\n    render() {\n        const { size, t } = this.props;\n        const { index, blocks, hasNextMedia, hasPreviousMedia } = this.state;\n        if (!blocks) return null;\n        if (index === -1) return null;\n\n        const block = blocks[index];\n        const media = getBlockMedia(block);\n        const caption = getBlockCaption(block);\n        const url = getBlockUrl(block);\n\n        const [width, height, file] = getViewerFile(media, size);\n\n        let title = '';\n        if (media['@type'] === 'photo') {\n            title = t('AttachPhoto');\n        }\n        if (media['@type'] === 'video') {\n            title = t('AttachVideo');\n        } else if (media['@type'] === 'animation') {\n            title = t('AttachGif');\n        }\n        const maxCount = blocks.length;\n\n        return (\n            <div className={classNames('instant-view-media-viewer', 'media-viewer-default')}>\n                <div className='media-viewer-wrapper'>\n                    <div className='media-viewer-left-column'>\n                        <div className='media-viewer-button-placeholder' />\n                        <MediaViewerButton disabled={!hasNextMedia} grow onClick={this.handleNext}>\n                            <NavigateBeforeIcon fontSize='large' />\n                        </MediaViewerButton>\n                    </div>\n                    <div className='media-viewer-content-column'>\n                        <InstantViewMediaViewerContent media={media} size={size} caption={caption} url={url} />\n                    </div>\n                    <div className='media-viewer-right-column'>\n                        <MediaViewerButton onClick={this.handleClose}>\n                            <CloseIcon fontSize='large' />\n                        </MediaViewerButton>\n                        <MediaViewerButton disabled={!hasPreviousMedia} grow onClick={this.handlePrevious}>\n                            <NavigateNextIcon fontSize='large' />\n                        </MediaViewerButton>\n                    </div>\n                </div>\n\n                <div className='media-viewer-footer'>\n                    <MediaViewerFooterText\n                        title={title}\n                        subtitle={maxCount && index >= 0 ? `${index + 1} of ${maxCount}` : null}\n                        style={{ marginLeft: 128 }}\n                    />\n                    <MediaViewerDownloadButton title={t('Save')} fileId={file.id} onClick={this.handleSave} />\n                    <MediaViewerFooterButton title={t('Forward')} onClick={this.handleForward}>\n                        <ReplyIcon style={forwardIconStyle} />\n                    </MediaViewerFooterButton>\n                </div>\n            </div>\n        );\n    }\n}\n\nInstantViewMediaViewer.propTypes = {\n    media: PropTypes.object.isRequired,\n    size: PropTypes.number.isRequired,\n    caption: PropTypes.object.isRequired\n};\n\nconst enhance = compose(\n    withTranslation(),\n    withIV\n);\n\nexport default enhance(InstantViewMediaViewer);\n"]},"metadata":{},"sourceType":"module"}