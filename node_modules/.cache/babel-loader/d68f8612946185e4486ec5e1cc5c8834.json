{"ast":null,"code":"import _classCallCheck from\"/home/me-admin/Downloads/my-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/me-admin/Downloads/my-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/me-admin/Downloads/my-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/me-admin/Downloads/my-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/me-admin/Downloads/my-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _defineProperty from\"/home/me-admin/Downloads/my-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */import React,{Component}from'react';import classNames from'classnames';import withStyles from'@material-ui/core/styles/withStyles';import Search from'./Search/Search';import DialogsHeader from'./DialogsHeader';import DialogsList from'./DialogsList';import UpdatePanel from'./UpdatePanel';import{borderStyle}from'../Theme';import{openChat}from'../../Actions/Client';import ApplicationStore from'../../Stores/ApplicationStore';import'./Dialogs.css';var styles=function styles(theme){return _objectSpread({},borderStyle(theme));};var Dialogs=/*#__PURE__*/function(_Component){_inherits(Dialogs,_Component);function Dialogs(props){var _this;_classCallCheck(this,Dialogs);_this=_possibleConstructorReturn(this,_getPrototypeOf(Dialogs).call(this,props));_this.onClientUpdateThemeChange=function(update){_this.forceUpdate();};_this.onClientUpdateChatDetailsVisibility=function(update){_this.setState({isChatDetailsVisible:ApplicationStore.isChatDetailsVisible});};_this.onClientUpdateSearchChat=function(update){var chatId=update.chatId,query=update.query;var _this$state=_this.state,openSearch=_this$state.openSearch,searchChatId=_this$state.searchChatId,searchText=_this$state.searchText;if(openSearch&&chatId===searchChatId&&query===searchText){return;}var header=_this.dialogsHeaderRef.current;_this.setState({openSearch:true,searchChatId:chatId,searchText:null},function(){if(header){header.setInitQuery(query);}});};_this.handleHeaderClick=function(){_this.dialogsListRef.current.scrollToTop();};_this.handleSearch=function(visible){_this.setState({openSearch:visible,searchChatId:0,searchText:null});};_this.handleSelectMessage=function(chatId,messageId,openSearch){openChat(chatId,messageId);var searchChatId=openSearch?_this.state.searchChatId:0;var searchText=openSearch?_this.state.searchText:null;_this.setState({openSearch:openSearch,searchChatId:searchChatId,searchText:searchText});};_this.handleClose=function(){_this.setState({openSearch:false,searchChatId:0,searchText:null});};_this.handleSearchTextChange=function(text){_this.setState({searchText:text,query:null});};_this.dialogsListRef=React.createRef();_this.dialogsHeaderRef=React.createRef();_this.state={isChatDetailsVisible:ApplicationStore.isChatDetailsVisible,openSearch:false,searchChatId:0,searchText:null,query:null};return _this;}_createClass(Dialogs,[{key:\"shouldComponentUpdate\",value:function shouldComponentUpdate(nextProps,nextState){if(nextState.isChatDetailsVisible!==this.state.isChatDetailsVisible){return true;}if(nextState.openSearch!==this.state.openSearch){return true;}if(nextState.searchChatId!==this.state.searchChatId){return true;}if(nextState.searchText!==this.state.searchText){return true;}return false;}},{key:\"componentDidMount\",value:function componentDidMount(){ApplicationStore.on('clientUpdateChatDetailsVisibility',this.onClientUpdateChatDetailsVisibility);ApplicationStore.on('clientUpdateSearchChat',this.onClientUpdateSearchChat);ApplicationStore.on('clientUpdateThemeChange',this.onClientUpdateThemeChange);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){ApplicationStore.removeListener('clientUpdateChatDetailsVisibility',this.onClientUpdateChatDetailsVisibility);ApplicationStore.removeListener('clientUpdateSearchChat',this.onClientUpdateSearchChat);ApplicationStore.removeListener('clientUpdateThemeChange',this.onClientUpdateThemeChange);}},{key:\"render\",value:function render(){var classes=this.props.classes;var _this$state2=this.state,isChatDetailsVisible=_this$state2.isChatDetailsVisible,openSearch=_this$state2.openSearch,searchChatId=_this$state2.searchChatId,searchText=_this$state2.searchText;return React.createElement(\"div\",{className:classNames(classes.borderColor,'dialogs',{'dialogs-third-column':isChatDetailsVisible})},React.createElement(DialogsHeader,{ref:this.dialogsHeaderRef,openSearch:openSearch,onClick:this.handleHeaderClick,onSearch:this.handleSearch,onSearchTextChange:this.handleSearchTextChange}),React.createElement(\"div\",{className:\"dialogs-content\"},React.createElement(DialogsList,{ref:this.dialogsListRef}),openSearch&&React.createElement(Search,{chatId:searchChatId,text:searchText,onSelectMessage:this.handleSelectMessage,onClose:this.handleClose})),React.createElement(UpdatePanel,null));}}]);return Dialogs;}(Component);export default withStyles(styles)(Dialogs);","map":{"version":3,"sources":["/home/me-admin/Downloads/my-app/src/Components/ColumnLeft/Dialogs.js"],"names":["React","Component","classNames","withStyles","Search","DialogsHeader","DialogsList","UpdatePanel","borderStyle","openChat","ApplicationStore","styles","theme","Dialogs","props","onClientUpdateThemeChange","update","forceUpdate","onClientUpdateChatDetailsVisibility","setState","isChatDetailsVisible","onClientUpdateSearchChat","chatId","query","state","openSearch","searchChatId","searchText","header","dialogsHeaderRef","current","setInitQuery","handleHeaderClick","dialogsListRef","scrollToTop","handleSearch","visible","handleSelectMessage","messageId","handleClose","handleSearchTextChange","text","createRef","nextProps","nextState","on","removeListener","classes","borderColor"],"mappings":"w8CAAA;;;;;GAOA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CAEA,MAAOC,CAAAA,UAAP,KAAuB,YAAvB,CACA,MAAOC,CAAAA,UAAP,KAAuB,qCAAvB,CACA,MAAOC,CAAAA,MAAP,KAAmB,iBAAnB,CACA,MAAOC,CAAAA,aAAP,KAA0B,iBAA1B,CACA,MAAOC,CAAAA,WAAP,KAAwB,eAAxB,CACA,MAAOC,CAAAA,WAAP,KAAwB,eAAxB,CACA,OAASC,WAAT,KAA4B,UAA5B,CACA,OAASC,QAAT,KAAyB,sBAAzB,CACA,MAAOC,CAAAA,gBAAP,KAA6B,+BAA7B,CACA,MAAO,eAAP,CAEA,GAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,CAAAC,KAAK,0BACbJ,WAAW,CAACI,KAAD,CADE,GAApB,C,GAIMC,CAAAA,O,iEACF,iBAAYC,KAAZ,CAAmB,yCACf,yEAAMA,KAAN,GADe,MA+CnBC,yBA/CmB,CA+CS,SAAAC,MAAM,CAAI,CAClC,MAAKC,WAAL,GACH,CAjDkB,OAmDnBC,mCAnDmB,CAmDmB,SAAAF,MAAM,CAAI,CAC5C,MAAKG,QAAL,CAAc,CACVC,oBAAoB,CAAEV,gBAAgB,CAACU,oBAD7B,CAAd,EAGH,CAvDkB,OAyDnBC,wBAzDmB,CAyDQ,SAAAL,MAAM,CAAI,IACzBM,CAAAA,MADyB,CACPN,MADO,CACzBM,MADyB,CACjBC,KADiB,CACPP,MADO,CACjBO,KADiB,iBAEgB,MAAKC,KAFrB,CAEzBC,UAFyB,aAEzBA,UAFyB,CAEbC,YAFa,aAEbA,YAFa,CAECC,UAFD,aAECA,UAFD,CAIjC,GAAIF,UAAU,EAAIH,MAAM,GAAKI,YAAzB,EAAyCH,KAAK,GAAKI,UAAvD,CAAmE,CAC/D,OACH,CAED,GAAMC,CAAAA,MAAM,CAAG,MAAKC,gBAAL,CAAsBC,OAArC,CACA,MAAKX,QAAL,CACI,CACIM,UAAU,CAAE,IADhB,CAEIC,YAAY,CAAEJ,MAFlB,CAGIK,UAAU,CAAE,IAHhB,CADJ,CAMI,UAAM,CACF,GAAIC,MAAJ,CAAY,CACRA,MAAM,CAACG,YAAP,CAAoBR,KAApB,EACH,CACJ,CAVL,EAYH,CA9EkB,OAgFnBS,iBAhFmB,CAgFC,UAAM,CACtB,MAAKC,cAAL,CAAoBH,OAApB,CAA4BI,WAA5B,GACH,CAlFkB,OAoFnBC,YApFmB,CAoFJ,SAAAC,OAAO,CAAI,CACtB,MAAKjB,QAAL,CAAc,CACVM,UAAU,CAAEW,OADF,CAEVV,YAAY,CAAE,CAFJ,CAGVC,UAAU,CAAE,IAHF,CAAd,EAKH,CA1FkB,OA4FnBU,mBA5FmB,CA4FG,SAACf,MAAD,CAASgB,SAAT,CAAoBb,UAApB,CAAmC,CACrDhB,QAAQ,CAACa,MAAD,CAASgB,SAAT,CAAR,CAEA,GAAMZ,CAAAA,YAAY,CAAGD,UAAU,CAAG,MAAKD,KAAL,CAAWE,YAAd,CAA6B,CAA5D,CACA,GAAMC,CAAAA,UAAU,CAAGF,UAAU,CAAG,MAAKD,KAAL,CAAWG,UAAd,CAA2B,IAAxD,CAEA,MAAKR,QAAL,CAAc,CACVM,UAAU,CAAEA,UADF,CAEVC,YAAY,CAAEA,YAFJ,CAGVC,UAAU,CAAEA,UAHF,CAAd,EAKH,CAvGkB,OAyGnBY,WAzGmB,CAyGL,UAAM,CAChB,MAAKpB,QAAL,CAAc,CACVM,UAAU,CAAE,KADF,CAEVC,YAAY,CAAE,CAFJ,CAGVC,UAAU,CAAE,IAHF,CAAd,EAKH,CA/GkB,OAiHnBa,sBAjHmB,CAiHM,SAAAC,IAAI,CAAI,CAC7B,MAAKtB,QAAL,CAAc,CACVQ,UAAU,CAAEc,IADF,CAEVlB,KAAK,CAAE,IAFG,CAAd,EAIH,CAtHkB,CAGf,MAAKU,cAAL,CAAsBjC,KAAK,CAAC0C,SAAN,EAAtB,CACA,MAAKb,gBAAL,CAAwB7B,KAAK,CAAC0C,SAAN,EAAxB,CAEA,MAAKlB,KAAL,CAAa,CACTJ,oBAAoB,CAAEV,gBAAgB,CAACU,oBAD9B,CAETK,UAAU,CAAE,KAFH,CAGTC,YAAY,CAAE,CAHL,CAITC,UAAU,CAAE,IAJH,CAKTJ,KAAK,CAAE,IALE,CAAb,CANe,aAalB,C,wFAEqBoB,S,CAAWC,S,CAAW,CACxC,GAAIA,SAAS,CAACxB,oBAAV,GAAmC,KAAKI,KAAL,CAAWJ,oBAAlD,CAAwE,CACpE,MAAO,KAAP,CACH,CAED,GAAIwB,SAAS,CAACnB,UAAV,GAAyB,KAAKD,KAAL,CAAWC,UAAxC,CAAoD,CAChD,MAAO,KAAP,CACH,CAED,GAAImB,SAAS,CAAClB,YAAV,GAA2B,KAAKF,KAAL,CAAWE,YAA1C,CAAwD,CACpD,MAAO,KAAP,CACH,CAED,GAAIkB,SAAS,CAACjB,UAAV,GAAyB,KAAKH,KAAL,CAAWG,UAAxC,CAAoD,CAChD,MAAO,KAAP,CACH,CAED,MAAO,MAAP,CACH,C,6DAEmB,CAChBjB,gBAAgB,CAACmC,EAAjB,CAAoB,mCAApB,CAAyD,KAAK3B,mCAA9D,EACAR,gBAAgB,CAACmC,EAAjB,CAAoB,wBAApB,CAA8C,KAAKxB,wBAAnD,EACAX,gBAAgB,CAACmC,EAAjB,CAAoB,yBAApB,CAA+C,KAAK9B,yBAApD,EACH,C,mEAEsB,CACnBL,gBAAgB,CAACoC,cAAjB,CAAgC,mCAAhC,CAAqE,KAAK5B,mCAA1E,EACAR,gBAAgB,CAACoC,cAAjB,CAAgC,wBAAhC,CAA0D,KAAKzB,wBAA/D,EACAX,gBAAgB,CAACoC,cAAjB,CAAgC,yBAAhC,CAA2D,KAAK/B,yBAAhE,EACH,C,uCA2EQ,IACGgC,CAAAA,OADH,CACe,KAAKjC,KADpB,CACGiC,OADH,kBAEkE,KAAKvB,KAFvE,CAEGJ,oBAFH,cAEGA,oBAFH,CAEyBK,UAFzB,cAEyBA,UAFzB,CAEqCC,YAFrC,cAEqCA,YAFrC,CAEmDC,UAFnD,cAEmDA,UAFnD,CAIL,MACI,4BACI,SAAS,CAAEzB,UAAU,CAAC6C,OAAO,CAACC,WAAT,CAAsB,SAAtB,CAAiC,CAClD,uBAAwB5B,oBAD0B,CAAjC,CADzB,EAII,oBAAC,aAAD,EACI,GAAG,CAAE,KAAKS,gBADd,CAEI,UAAU,CAAEJ,UAFhB,CAGI,OAAO,CAAE,KAAKO,iBAHlB,CAII,QAAQ,CAAE,KAAKG,YAJnB,CAKI,kBAAkB,CAAE,KAAKK,sBAL7B,EAJJ,CAWI,2BAAK,SAAS,CAAC,iBAAf,EACI,oBAAC,WAAD,EAAa,GAAG,CAAE,KAAKP,cAAvB,EADJ,CAEKR,UAAU,EACP,oBAAC,MAAD,EACI,MAAM,CAAEC,YADZ,CAEI,IAAI,CAAEC,UAFV,CAGI,eAAe,CAAE,KAAKU,mBAH1B,CAII,OAAO,CAAE,KAAKE,WAJlB,EAHR,CAXJ,CAsBI,oBAAC,WAAD,MAtBJ,CADJ,CA0BH,C,qBAvJiBtC,S,EA0JtB,cAAeE,CAAAA,UAAU,CAACQ,MAAD,CAAV,CAAmBE,OAAnB,CAAf","sourcesContent":["/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport withStyles from '@material-ui/core/styles/withStyles';\nimport Search from './Search/Search';\nimport DialogsHeader from './DialogsHeader';\nimport DialogsList from './DialogsList';\nimport UpdatePanel from './UpdatePanel';\nimport { borderStyle } from '../Theme';\nimport { openChat } from '../../Actions/Client';\nimport ApplicationStore from '../../Stores/ApplicationStore';\nimport './Dialogs.css';\n\nconst styles = theme => ({\n    ...borderStyle(theme)\n});\n\nclass Dialogs extends Component {\n    constructor(props) {\n        super(props);\n\n        this.dialogsListRef = React.createRef();\n        this.dialogsHeaderRef = React.createRef();\n\n        this.state = {\n            isChatDetailsVisible: ApplicationStore.isChatDetailsVisible,\n            openSearch: false,\n            searchChatId: 0,\n            searchText: null,\n            query: null\n        };\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        if (nextState.isChatDetailsVisible !== this.state.isChatDetailsVisible) {\n            return true;\n        }\n\n        if (nextState.openSearch !== this.state.openSearch) {\n            return true;\n        }\n\n        if (nextState.searchChatId !== this.state.searchChatId) {\n            return true;\n        }\n\n        if (nextState.searchText !== this.state.searchText) {\n            return true;\n        }\n\n        return false;\n    }\n\n    componentDidMount() {\n        ApplicationStore.on('clientUpdateChatDetailsVisibility', this.onClientUpdateChatDetailsVisibility);\n        ApplicationStore.on('clientUpdateSearchChat', this.onClientUpdateSearchChat);\n        ApplicationStore.on('clientUpdateThemeChange', this.onClientUpdateThemeChange);\n    }\n\n    componentWillUnmount() {\n        ApplicationStore.removeListener('clientUpdateChatDetailsVisibility', this.onClientUpdateChatDetailsVisibility);\n        ApplicationStore.removeListener('clientUpdateSearchChat', this.onClientUpdateSearchChat);\n        ApplicationStore.removeListener('clientUpdateThemeChange', this.onClientUpdateThemeChange);\n    }\n\n    onClientUpdateThemeChange = update => {\n        this.forceUpdate();\n    };\n\n    onClientUpdateChatDetailsVisibility = update => {\n        this.setState({\n            isChatDetailsVisible: ApplicationStore.isChatDetailsVisible\n        });\n    };\n\n    onClientUpdateSearchChat = update => {\n        const { chatId, query } = update;\n        const { openSearch, searchChatId, searchText } = this.state;\n\n        if (openSearch && chatId === searchChatId && query === searchText) {\n            return;\n        }\n\n        const header = this.dialogsHeaderRef.current;\n        this.setState(\n            {\n                openSearch: true,\n                searchChatId: chatId,\n                searchText: null\n            },\n            () => {\n                if (header) {\n                    header.setInitQuery(query);\n                }\n            }\n        );\n    };\n\n    handleHeaderClick = () => {\n        this.dialogsListRef.current.scrollToTop();\n    };\n\n    handleSearch = visible => {\n        this.setState({\n            openSearch: visible,\n            searchChatId: 0,\n            searchText: null\n        });\n    };\n\n    handleSelectMessage = (chatId, messageId, openSearch) => {\n        openChat(chatId, messageId);\n\n        const searchChatId = openSearch ? this.state.searchChatId : 0;\n        const searchText = openSearch ? this.state.searchText : null;\n\n        this.setState({\n            openSearch: openSearch,\n            searchChatId: searchChatId,\n            searchText: searchText\n        });\n    };\n\n    handleClose = () => {\n        this.setState({\n            openSearch: false,\n            searchChatId: 0,\n            searchText: null\n        });\n    };\n\n    handleSearchTextChange = text => {\n        this.setState({\n            searchText: text,\n            query: null\n        });\n    };\n\n    render() {\n        const { classes } = this.props;\n        const { isChatDetailsVisible, openSearch, searchChatId, searchText } = this.state;\n\n        return (\n            <div\n                className={classNames(classes.borderColor, 'dialogs', {\n                    'dialogs-third-column': isChatDetailsVisible\n                })}>\n                <DialogsHeader\n                    ref={this.dialogsHeaderRef}\n                    openSearch={openSearch}\n                    onClick={this.handleHeaderClick}\n                    onSearch={this.handleSearch}\n                    onSearchTextChange={this.handleSearchTextChange}\n                />\n                <div className='dialogs-content'>\n                    <DialogsList ref={this.dialogsListRef} />\n                    {openSearch && (\n                        <Search\n                            chatId={searchChatId}\n                            text={searchText}\n                            onSelectMessage={this.handleSelectMessage}\n                            onClose={this.handleClose}\n                        />\n                    )}\n                </div>\n                <UpdatePanel />\n            </div>\n        );\n    }\n}\n\nexport default withStyles(styles)(Dialogs);\n"]},"metadata":{},"sourceType":"module"}