{"ast":null,"code":"import _classCallCheck from\"/home/me-admin/Downloads/my-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/me-admin/Downloads/my-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/me-admin/Downloads/my-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/me-admin/Downloads/my-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/me-admin/Downloads/my-app/node_modules/@babel/runtime/helpers/esm/inherits\";/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */import React from'react';import classNames from'classnames';import withStyles from'@material-ui/core/styles/withStyles';import{getDownloadedSize,getUploadedSize,getFileSize}from'../../../Utils/File';import FileStore from'../../../Stores/FileStore';import'./DocumentAction.css';var styles=function styles(theme){return{documentAction:{color:theme.palette.text.secondary}};};var DocumentAction=/*#__PURE__*/function(_React$Component){_inherits(DocumentAction,_React$Component);function DocumentAction(props){var _this;_classCallCheck(this,DocumentAction);_this=_possibleConstructorReturn(this,_getPrototypeOf(DocumentAction).call(this,props));_this.onUpdateFile=function(update){var currentFile=_this.state.file;var nextFile=update.file;if(currentFile&&currentFile.id===nextFile.id){_this.setState({file:nextFile,prevFile:currentFile});}};var file=_this.props.file;_this.state={prevPropsFile:file,prevFile:null,file:FileStore.get(file.id)||file};return _this;}_createClass(DocumentAction,[{key:\"componentDidMount\",value:function componentDidMount(){FileStore.on('updateFile',this.onUpdateFile);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){FileStore.removeListener('updateFile',this.onUpdateFile);}},{key:\"shouldComponentUpdate\",value:function shouldComponentUpdate(nextProps,nextState){var theme=this.props.theme;var _this$state=this.state,file=_this$state.file,prevFile=_this$state.prevFile;if(nextProps.theme!==theme){return true;}if(nextState.file!==file){return true;}if(nextState.prevFile!==prevFile){return true;}return false;}},{key:\"render\",value:function render(){var classes=this.props.classes;var file=this.state.file;if(!file)return null;var isDownloadingActive=file.local&&file.local.is_downloading_active;var isUploadingActive=file.remote&&file.remote.is_uploading_active;var size=getFileSize(file);var progressSize=null;if(isDownloadingActive){progressSize=getDownloadedSize(file);}else if(isUploadingActive){progressSize=getUploadedSize(file);}var sizeString=progressSize?\"\".concat(progressSize,\"/\").concat(size):\"\".concat(size);return React.createElement(\"div\",{className:classNames('document-action',classes.documentAction)},React.createElement(\"span\",null,sizeString));}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){var file=props.file;var prevPropsFile=state.prevPropsFile;if(file&&prevPropsFile&&file.id!==prevPropsFile.id){return{prevPropsFile:file,prevFile:null,file:FileStore.get(file.id)||file};}return null;}}]);return DocumentAction;}(React.Component);export default withStyles(styles,{withTheme:true})(DocumentAction);","map":{"version":3,"sources":["/home/me-admin/Downloads/my-app/src/Components/Message/Media/DocumentAction.js"],"names":["React","classNames","withStyles","getDownloadedSize","getUploadedSize","getFileSize","FileStore","styles","theme","documentAction","color","palette","text","secondary","DocumentAction","props","onUpdateFile","update","currentFile","state","file","nextFile","id","setState","prevFile","prevPropsFile","get","on","removeListener","nextProps","nextState","classes","isDownloadingActive","local","is_downloading_active","isUploadingActive","remote","is_uploading_active","size","progressSize","sizeString","Component","withTheme"],"mappings":"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","sourcesContent":["/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport withStyles from '@material-ui/core/styles/withStyles';\nimport { getDownloadedSize, getUploadedSize, getFileSize } from '../../../Utils/File';\nimport FileStore from '../../../Stores/FileStore';\nimport './DocumentAction.css';\n\nconst styles = theme => ({\n    documentAction: {\n        color: theme.palette.text.secondary\n    }\n});\n\nclass DocumentAction extends React.Component {\n    constructor(props) {\n        super(props);\n\n        const { file } = this.props;\n        this.state = {\n            prevPropsFile: file,\n            prevFile: null,\n            file: FileStore.get(file.id) || file\n        };\n    }\n\n    componentDidMount() {\n        FileStore.on('updateFile', this.onUpdateFile);\n    }\n\n    componentWillUnmount() {\n        FileStore.removeListener('updateFile', this.onUpdateFile);\n    }\n\n    onUpdateFile = update => {\n        const currentFile = this.state.file;\n        const nextFile = update.file;\n\n        if (currentFile && currentFile.id === nextFile.id) {\n            this.setState({ file: nextFile, prevFile: currentFile });\n        }\n    };\n\n    static getDerivedStateFromProps(props, state) {\n        const { file } = props;\n        const { prevPropsFile } = state;\n\n        if (file && prevPropsFile && file.id !== prevPropsFile.id) {\n            return {\n                prevPropsFile: file,\n                prevFile: null,\n                file: FileStore.get(file.id) || file\n            };\n        }\n\n        return null;\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        const { theme } = this.props;\n        const { file, prevFile } = this.state;\n\n        if (nextProps.theme !== theme) {\n            return true;\n        }\n\n        if (nextState.file !== file) {\n            return true;\n        }\n\n        if (nextState.prevFile !== prevFile) {\n            return true;\n        }\n\n        return false;\n    }\n\n    render() {\n        const { classes } = this.props;\n        const { file } = this.state;\n        if (!file) return null;\n\n        const isDownloadingActive = file.local && file.local.is_downloading_active;\n        const isUploadingActive = file.remote && file.remote.is_uploading_active;\n\n        const size = getFileSize(file);\n        let progressSize = null;\n        if (isDownloadingActive) {\n            progressSize = getDownloadedSize(file);\n        } else if (isUploadingActive) {\n            progressSize = getUploadedSize(file);\n        }\n\n        const sizeString = progressSize ? `${progressSize}/${size}` : `${size}`;\n\n        return (\n            <div className={classNames('document-action', classes.documentAction)}>\n                <span>{sizeString}</span>\n            </div>\n        );\n    }\n}\n\nDocumentAction.propTypes = {\n    file: PropTypes.object.isRequired\n};\n\nexport default withStyles(styles, { withTheme: true })(DocumentAction);\n"]},"metadata":{},"sourceType":"module"}