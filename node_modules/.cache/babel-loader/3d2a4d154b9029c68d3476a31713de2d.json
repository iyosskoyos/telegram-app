{"ast":null,"code":"import _classCallCheck from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _defineProperty from\"/Users/yosuahalim/Documents/Projects/telegram-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */import React from'react';import classNames from'classnames';import{compose}from'recompose';import{withTranslation}from'react-i18next';import Button from'@material-ui/core/Button';import Dialog from'@material-ui/core/Dialog';import DialogActions from'@material-ui/core/DialogActions';import DialogContent from'@material-ui/core/DialogContent';import DialogContentText from'@material-ui/core/DialogContentText';import DialogTitle from'@material-ui/core/DialogTitle';import FormControlLabel from'@material-ui/core/FormControlLabel';import Checkbox from'@material-ui/core/Checkbox/';import withStyles from'@material-ui/core/styles/withStyles';import{borderStyle}from'../Theme';import{canSendMessages,getChatShortTitle,isPrivateChat}from'../../Utils/Chat';import{forwardMessages}from'../../Actions/Client';import MessageStore from'../../Stores/MessageStore';import ApplicationStore from'../../Stores/ApplicationStore';import TdLibController from'../../Controllers/TdLibController';import'./HeaderCommand.css';var styles=function styles(theme){return _objectSpread({buttonLeft:{margin:'14px 0 14px 14px',minWidth:'100px'},buttonRight:{margin:'14px 14px 14px 0',minWidth:'100px'}},borderStyle(theme));};var HeaderCommand=/*#__PURE__*/function(_React$Component){_inherits(HeaderCommand,_React$Component);function HeaderCommand(props){var _this;_classCallCheck(this,HeaderCommand);_this=_possibleConstructorReturn(this,_getPrototypeOf(HeaderCommand).call(this,props));_this.handleCancel=function(){TdLibController.clientUpdate({'@type':'clientUpdateClearSelection'});};_this.handleDelete=function(){var canBeDeletedForAllUsers=true;var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=MessageStore.selectedItems.values()[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var _ref2=_step.value;var chatId=_ref2.chatId;var messageId=_ref2.messageId;var message=MessageStore.get(chatId,messageId);if(!message){canBeDeletedForAllUsers=false;break;}if(!message.can_be_deleted_for_all_users){canBeDeletedForAllUsers=false;break;}}}catch(err){_didIteratorError=true;_iteratorError=err;}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return();}}finally{if(_didIteratorError){throw _iteratorError;}}}_this.setState({openDeleteDialog:true,canBeDeletedForAllUsers:canBeDeletedForAllUsers,revoke:canBeDeletedForAllUsers});};_this.handleDeleteContinue=function(){var revoke=_this.state.revoke;var id;var messageIds=[];var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=MessageStore.selectedItems.values()[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var _ref4=_step2.value;var chatId=_ref4.chatId;var messageId=_ref4.messageId;id=chatId;messageIds.push(messageId);}}catch(err){_didIteratorError2=true;_iteratorError2=err;}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return!=null){_iterator2.return();}}finally{if(_didIteratorError2){throw _iteratorError2;}}}_this.handleCancel();TdLibController.send({'@type':'deleteMessages',chat_id:id,message_ids:messageIds,revoke:revoke});};_this.handleRevokeChange=function(){_this.setState({revoke:!_this.state.revoke});};_this.handleCloseDelete=function(){_this.setState({openDeleteDialog:false});};_this.handleForward=function(){var id;var messageIds=[];var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=MessageStore.selectedItems.values()[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var _ref6=_step3.value;var chatId=_ref6.chatId;var messageId=_ref6.messageId;id=chatId;messageIds.push(messageId);}}catch(err){_didIteratorError3=true;_iteratorError3=err;}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return!=null){_iterator3.return();}}finally{if(_didIteratorError3){throw _iteratorError3;}}}_this.handleCancel();forwardMessages(id,messageIds);};_this.handleReply=function(){if(MessageStore.selectedItems.size!==1)return;var _MessageStore$selecte=MessageStore.selectedItems.values().next().value,chatId=_MessageStore$selecte.chatId,messageId=_MessageStore$selecte.messageId;_this.handleCancel();TdLibController.clientUpdate({'@type':'clientUpdateReply',chatId:chatId,messageId:messageId});};_this.state={openDeleteDialog:false};return _this;}_createClass(HeaderCommand,[{key:\"render\",value:function render(){var _this$props=this.props,classes=_this$props.classes,t=_this$props.t,count=_this$props.count;var _this$state=this.state,openDeleteDialog=_this$state.openDeleteDialog,canBeDeletedForAllUsers=_this$state.canBeDeletedForAllUsers,revoke=_this$state.revoke;var chatId=ApplicationStore.getChatId();var canBeDeleted=true;var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=MessageStore.selectedItems.values()[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var _ref9=_step4.value;var _chatId=_ref9.chatId;var messageId=_ref9.messageId;var message=MessageStore.get(_chatId,messageId);if(!message){canBeDeleted=false;break;}if(!message.can_be_deleted_only_for_self&&!message.can_be_deleted_for_all_users){canBeDeleted=false;break;}}}catch(err){_didIteratorError4=true;_iteratorError4=err;}finally{try{if(!_iteratorNormalCompletion4&&_iterator4.return!=null){_iterator4.return();}}finally{if(_didIteratorError4){throw _iteratorError4;}}}var canBeForwarded=true;var _iteratorNormalCompletion5=true;var _didIteratorError5=false;var _iteratorError5=undefined;try{for(var _iterator5=MessageStore.selectedItems.values()[Symbol.iterator](),_step5;!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=true){var _ref10=_step5.value;var _chatId2=_ref10.chatId;var _messageId=_ref10.messageId;var _message=MessageStore.get(_chatId2,_messageId);if(!_message){canBeForwarded=false;break;}if(!_message.can_be_forwarded){canBeForwarded=false;break;}}}catch(err){_didIteratorError5=true;_iteratorError5=err;}finally{try{if(!_iteratorNormalCompletion5&&_iterator5.return!=null){_iterator5.return();}}finally{if(_didIteratorError5){throw _iteratorError5;}}}var canBeReplied=count===1&&canSendMessages(chatId);return React.createElement(React.Fragment,null,React.createElement(\"div\",{className:classNames(classes.borderColor,'header-command')},canBeForwarded&&React.createElement(Button,{color:\"primary\",className:classes.buttonLeft,onClick:this.handleForward},count<=1?t('Forward'):\"\".concat(t('Forward'),\" \").concat(count)),canBeDeleted&&React.createElement(Button,{color:\"primary\",className:classes.buttonLeft,onClick:this.handleDelete},count<=1?t('Delete'):\"\".concat(t('Delete'),\" \").concat(count)),canBeReplied&&React.createElement(Button,{color:\"primary\",className:classes.buttonLeft,onClick:this.handleReply},t('Reply')),React.createElement(\"div\",{className:\"header-command-space\"}),React.createElement(Button,{color:\"primary\",className:classes.buttonRight,onClick:this.handleCancel},t('Cancel'))),React.createElement(Dialog,{transitionDuration:0,open:openDeleteDialog,onClose:this.handleCloseDelete,\"aria-labelledby\":\"delete-dialog-title\"},React.createElement(DialogTitle,{id:\"delete-dialog-title\"},\"Confirm\"),React.createElement(DialogContent,null,React.createElement(DialogContentText,null,count===1?'Are you sure you want to delete 1 message?':\"Are you sure you want to delete \".concat(count,\" messages?\")),canBeDeletedForAllUsers&&React.createElement(FormControlLabel,{control:React.createElement(Checkbox,{checked:revoke,onChange:this.handleRevokeChange,color:\"primary\"}),label:isPrivateChat(chatId)?\"Delete for \".concat(getChatShortTitle(chatId)):'Delete for all'})),React.createElement(DialogActions,null,React.createElement(Button,{onClick:this.handleCloseDelete,color:\"primary\"},\"Cancel\"),React.createElement(Button,{onClick:this.handleDeleteContinue,color:\"primary\"},\"Ok\"))));}}]);return HeaderCommand;}(React.Component);var enhance=compose(withStyles(styles,{withTheme:true}),withTranslation());export default enhance(HeaderCommand);","map":{"version":3,"sources":["/Users/yosuahalim/Documents/Projects/telegram-app/src/Components/ColumnMiddle/HeaderCommand.js"],"names":["React","classNames","compose","withTranslation","Button","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","FormControlLabel","Checkbox","withStyles","borderStyle","canSendMessages","getChatShortTitle","isPrivateChat","forwardMessages","MessageStore","ApplicationStore","TdLibController","styles","theme","buttonLeft","margin","minWidth","buttonRight","HeaderCommand","props","handleCancel","clientUpdate","handleDelete","canBeDeletedForAllUsers","selectedItems","values","chatId","messageId","message","get","can_be_deleted_for_all_users","setState","openDeleteDialog","revoke","handleDeleteContinue","state","id","messageIds","push","send","chat_id","message_ids","handleRevokeChange","handleCloseDelete","handleForward","handleReply","size","next","value","classes","t","count","getChatId","canBeDeleted","can_be_deleted_only_for_self","canBeForwarded","can_be_forwarded","canBeReplied","borderColor","Component","enhance","withTheme"],"mappings":"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","sourcesContent":["/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { compose } from 'recompose';\nimport { withTranslation } from 'react-i18next';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Checkbox from '@material-ui/core/Checkbox/';\nimport withStyles from '@material-ui/core/styles/withStyles';\nimport { borderStyle } from '../Theme';\nimport { canSendMessages, getChatShortTitle, isPrivateChat } from '../../Utils/Chat';\nimport { forwardMessages } from '../../Actions/Client';\nimport MessageStore from '../../Stores/MessageStore';\nimport ApplicationStore from '../../Stores/ApplicationStore';\nimport TdLibController from '../../Controllers/TdLibController';\nimport './HeaderCommand.css';\n\nconst styles = theme => ({\n    buttonLeft: {\n        margin: '14px 0 14px 14px',\n        minWidth: '100px'\n    },\n    buttonRight: {\n        margin: '14px 14px 14px 0',\n        minWidth: '100px'\n    },\n    ...borderStyle(theme)\n});\n\nclass HeaderCommand extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            openDeleteDialog: false\n        };\n    }\n\n    handleCancel = () => {\n        TdLibController.clientUpdate({ '@type': 'clientUpdateClearSelection' });\n    };\n\n    handleDelete = () => {\n        let canBeDeletedForAllUsers = true;\n        for (let { chatId, messageId } of MessageStore.selectedItems.values()) {\n            const message = MessageStore.get(chatId, messageId);\n            if (!message) {\n                canBeDeletedForAllUsers = false;\n                break;\n            }\n            if (!message.can_be_deleted_for_all_users) {\n                canBeDeletedForAllUsers = false;\n                break;\n            }\n        }\n\n        this.setState({\n            openDeleteDialog: true,\n            canBeDeletedForAllUsers: canBeDeletedForAllUsers,\n            revoke: canBeDeletedForAllUsers\n        });\n    };\n\n    handleDeleteContinue = () => {\n        const { revoke } = this.state;\n\n        let id;\n        const messageIds = [];\n        for (let { chatId, messageId } of MessageStore.selectedItems.values()) {\n            id = chatId;\n            messageIds.push(messageId);\n        }\n\n        this.handleCancel();\n\n        TdLibController.send({\n            '@type': 'deleteMessages',\n            chat_id: id,\n            message_ids: messageIds,\n            revoke: revoke\n        });\n    };\n\n    handleRevokeChange = () => {\n        this.setState({ revoke: !this.state.revoke });\n    };\n\n    handleCloseDelete = () => {\n        this.setState({ openDeleteDialog: false });\n    };\n\n    handleForward = () => {\n        let id;\n        const messageIds = [];\n        for (let { chatId, messageId } of MessageStore.selectedItems.values()) {\n            id = chatId;\n            messageIds.push(messageId);\n        }\n\n        this.handleCancel();\n\n        forwardMessages(id, messageIds);\n    };\n\n    handleReply = () => {\n        if (MessageStore.selectedItems.size !== 1) return;\n\n        const { chatId, messageId } = MessageStore.selectedItems.values().next().value;\n\n        this.handleCancel();\n\n        TdLibController.clientUpdate({ '@type': 'clientUpdateReply', chatId: chatId, messageId: messageId });\n    };\n\n    render() {\n        const { classes, t, count } = this.props;\n        const { openDeleteDialog, canBeDeletedForAllUsers, revoke } = this.state;\n\n        const chatId = ApplicationStore.getChatId();\n\n        let canBeDeleted = true;\n        for (let { chatId, messageId } of MessageStore.selectedItems.values()) {\n            const message = MessageStore.get(chatId, messageId);\n            if (!message) {\n                canBeDeleted = false;\n                break;\n            }\n            if (!message.can_be_deleted_only_for_self && !message.can_be_deleted_for_all_users) {\n                canBeDeleted = false;\n                break;\n            }\n        }\n\n        let canBeForwarded = true;\n        for (let { chatId, messageId } of MessageStore.selectedItems.values()) {\n            const message = MessageStore.get(chatId, messageId);\n            if (!message) {\n                canBeForwarded = false;\n                break;\n            }\n            if (!message.can_be_forwarded) {\n                canBeForwarded = false;\n                break;\n            }\n        }\n\n        const canBeReplied = count === 1 && canSendMessages(chatId);\n\n        return (\n            <>\n                <div className={classNames(classes.borderColor, 'header-command')}>\n                    {canBeForwarded && (\n                        <Button color='primary' className={classes.buttonLeft} onClick={this.handleForward}>\n                            {count <= 1 ? t('Forward') : `${t('Forward')} ${count}`}\n                        </Button>\n                    )}\n                    {canBeDeleted && (\n                        <Button color='primary' className={classes.buttonLeft} onClick={this.handleDelete}>\n                            {count <= 1 ? t('Delete') : `${t('Delete')} ${count}`}\n                        </Button>\n                    )}\n                    {canBeReplied && (\n                        <Button color='primary' className={classes.buttonLeft} onClick={this.handleReply}>\n                            {t('Reply')}\n                        </Button>\n                    )}\n                    <div className='header-command-space' />\n                    <Button color='primary' className={classes.buttonRight} onClick={this.handleCancel}>\n                        {t('Cancel')}\n                    </Button>\n                </div>\n                <Dialog\n                    transitionDuration={0}\n                    open={openDeleteDialog}\n                    onClose={this.handleCloseDelete}\n                    aria-labelledby='delete-dialog-title'>\n                    <DialogTitle id='delete-dialog-title'>Confirm</DialogTitle>\n                    <DialogContent>\n                        <DialogContentText>\n                            {count === 1\n                                ? 'Are you sure you want to delete 1 message?'\n                                : `Are you sure you want to delete ${count} messages?`}\n                        </DialogContentText>\n                        {canBeDeletedForAllUsers && (\n                            <FormControlLabel\n                                control={\n                                    <Checkbox checked={revoke} onChange={this.handleRevokeChange} color='primary' />\n                                }\n                                label={\n                                    isPrivateChat(chatId) ? `Delete for ${getChatShortTitle(chatId)}` : 'Delete for all'\n                                }\n                            />\n                        )}\n                    </DialogContent>\n                    <DialogActions>\n                        <Button onClick={this.handleCloseDelete} color='primary'>\n                            Cancel\n                        </Button>\n                        <Button onClick={this.handleDeleteContinue} color='primary'>\n                            Ok\n                        </Button>\n                    </DialogActions>\n                </Dialog>\n            </>\n        );\n    }\n}\n\nHeaderCommand.propTypes = {\n    count: PropTypes.number\n};\n\nconst enhance = compose(\n    withStyles(styles, { withTheme: true }),\n    withTranslation()\n);\n\nexport default enhance(HeaderCommand);\n"]},"metadata":{},"sourceType":"module"}